import{_ as e}from"./plugin-vue_export-helper.21dcd24c.js";import{o,c,a as n,b as t,e as p,d as s,r as l}from"./app.cd28f204.js";const i={},u=p('<h2 id="\u7B2C1\u7AE0-elasticsearch\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u7B2C1\u7AE0-elasticsearch\u6982\u8FF0" aria-hidden="true">#</a> \u7B2C1\u7AE0 Elasticsearch\u6982\u8FF0</h2><h3 id="_01-\u5F00\u7BC7" tabindex="-1"><a class="header-anchor" href="#_01-\u5F00\u7BC7" aria-hidden="true">#</a> 01-\u5F00\u7BC7</h3><p>\u7ED3\u6784\u5316\u6570\u636E</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/a421a414ea8fb8e25c466add5b00d31f.png" alt=""></p><p>\u975E\u7ED3\u6784\u5316\u6570\u636E</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/109d3c62c1f36b4f352170488b516709.png" alt=""></p><p>\u534A\u7ED3\u6784\u5316\u6570\u636E</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/48742ba6bbdc47e0dae2754027f30a31.png" alt=""></p><h3 id="_02-\u6280\u672F\u9009\u578B" tabindex="-1"><a class="header-anchor" href="#_02-\u6280\u672F\u9009\u578B" aria-hidden="true">#</a> 02-\u6280\u672F\u9009\u578B</h3><h4 id="elasticsearch-\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Elasticsearch \u662F\u4EC0\u4E48</h4><p>The Elastic Stack, \u5305\u62EC Elasticsearch\u3001 Kibana\u3001 Beats \u548C Logstash\uFF08\u4E5F\u79F0\u4E3A ELK Stack\uFF09\u3002\u80FD\u591F\u5B89\u5168\u53EF\u9760\u5730\u83B7\u53D6\u4EFB\u4F55\u6765\u6E90\u3001\u4EFB\u4F55\u683C\u5F0F\u7684\u6570\u636E\uFF0C\u7136\u540E\u5B9E\u65F6\u5730\u5BF9\u6570\u636E\u8FDB\u884C\u641C\u7D22\u3001\u5206\u6790\u548C\u53EF\u89C6\u5316\u3002</p><p>Elaticsearch\uFF0C\u7B80\u79F0\u4E3A ES\uFF0C ES \u662F\u4E00\u4E2A<strong>\u5F00\u6E90\u7684\u9AD8\u6269\u5C55\u7684\u5206\u5E03\u5F0F\u5168\u6587\u641C\u7D22\u5F15\u64CE</strong>\uFF0C \u662F\u6574\u4E2A ElasticStack \u6280\u672F\u6808\u7684\u6838\u5FC3\u3002</p><p>\u5B83\u53EF\u4EE5\u8FD1\u4E4E\u5B9E\u65F6\u7684\u5B58\u50A8\u3001\u68C0\u7D22\u6570\u636E\uFF1B\u672C\u8EAB\u6269\u5C55\u6027\u5F88\u597D\uFF0C\u53EF\u4EE5\u6269\u5C55\u5230\u4E0A\u767E\u53F0\u670D\u52A1\u5668\uFF0C\u5904\u7406 PB \u7EA7\u522B\u7684\u6570\u636E\u3002</p><blockquote><p>elastic<br> \u82F1 [\u026A\u02C8l\xE6st\u026Ak] \u7F8E [\u026A\u02C8l\xE6st\u026Ak]<br> n. \u6A61\u76AE\u5708(\u6216\u5E26);\u677E\u7D27\u5E26<br> adj. \u6A61\u76AE\u5708(\u6216\u5E26)\u7684;\u6709\u5F39\u6027\u7684;\u6709\u5F39\u529B\u7684;\u7075\u6D3B\u7684;\u53EF\u6539\u53D8\u7684;\u53EF\u4F38\u7F29\u7684</p></blockquote><h4 id="\u5168\u6587\u641C\u7D22\u5F15\u64CE" tabindex="-1"><a class="header-anchor" href="#\u5168\u6587\u641C\u7D22\u5F15\u64CE" aria-hidden="true">#</a> \u5168\u6587\u641C\u7D22\u5F15\u64CE</h4><p>Google\uFF0C\u767E\u5EA6\u7C7B\u7684\u7F51\u7AD9\u641C\u7D22\uFF0C\u5B83\u4EEC\u90FD\u662F\u6839\u636E\u7F51\u9875\u4E2D\u7684\u5173\u952E\u5B57\u751F\u6210\u7D22\u5F15\uFF0C\u6211\u4EEC\u5728\u641C\u7D22\u7684\u65F6\u5019\u8F93\u5165\u5173\u952E\u5B57\uFF0C\u5B83\u4EEC\u4F1A\u5C06\u8BE5\u5173\u952E\u5B57\u5373\u7D22\u5F15\u5339\u914D\u5230\u7684\u6240\u6709\u7F51\u9875\u8FD4\u56DE\uFF1B\u8FD8\u6709\u5E38\u89C1\u7684\u9879\u76EE\u4E2D\u5E94\u7528\u65E5\u5FD7\u7684\u641C\u7D22\u7B49\u7B49\u3002\u5BF9\u4E8E\u8FD9\u4E9B\u975E\u7ED3\u6784\u5316\u7684\u6570\u636E\u6587\u672C\uFF0C\u5173\u7CFB\u578B\u6570\u636E\u5E93\u641C\u7D22\u4E0D\u662F\u80FD\u5F88\u597D\u7684\u652F\u6301\u3002</p><p>\u4E00\u822C\u4F20\u7EDF\u6570\u636E\u5E93\uFF0C\u5168\u6587\u68C0\u7D22\u90FD\u5B9E\u73B0\u7684\u5F88\u9E21\u808B\uFF0C\u56E0\u4E3A\u4E00\u822C\u4E5F\u6CA1\u4EBA\u7528\u6570\u636E\u5E93\u5B58\u6587\u672C\u5B57\u6BB5\u3002\u8FDB\u884C\u5168\u6587\u68C0\u7D22\u9700\u8981\u626B\u63CF\u6574\u4E2A\u8868\uFF0C\u5982\u679C\u6570\u636E\u91CF\u5927\u7684\u8BDD\u5373\u4F7F\u5BF9 SQL \u7684\u8BED\u6CD5\u4F18\u5316\uFF0C\u4E5F\u6536\u6548\u751A\u5FAE\u3002\u5EFA\u7ACB\u4E86\u7D22\u5F15\uFF0C\u4F46\u662F\u7EF4\u62A4\u8D77\u6765\u4E5F\u5F88\u9EBB\u70E6\uFF0C\u5BF9\u4E8E insert \u548C update \u64CD\u4F5C\u90FD\u4F1A\u91CD\u65B0\u6784\u5EFA\u7D22\u5F15\u3002</p><p>\u57FA\u4E8E\u4EE5\u4E0A\u539F\u56E0\u53EF\u4EE5\u5206\u6790\u5F97\u51FA\uFF0C\u5728\u4E00\u4E9B\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u4F7F\u7528\u5E38\u89C4\u7684\u641C\u7D22\u65B9\u5F0F\uFF0C\u6027\u80FD\u662F\u975E\u5E38\u5DEE\u7684\uFF1A</p><ul><li>\u641C\u7D22\u7684\u6570\u636E\u5BF9\u8C61\u662F\u5927\u91CF\u7684\u975E\u7ED3\u6784\u5316\u7684\u6587\u672C\u6570\u636E\u3002</li><li>\u6587\u4EF6\u8BB0\u5F55\u91CF\u8FBE\u5230\u6570\u5341\u4E07\u6216\u6570\u767E\u4E07\u4E2A\u751A\u81F3\u66F4\u591A\u3002</li><li>\u652F\u6301\u5927\u91CF\u57FA\u4E8E\u4EA4\u4E92\u5F0F\u6587\u672C\u7684\u67E5\u8BE2\u3002</li><li>\u9700\u6C42\u975E\u5E38\u7075\u6D3B\u7684\u5168\u6587\u641C\u7D22\u67E5\u8BE2\u3002</li><li>\u5BF9\u9AD8\u5EA6\u76F8\u5173\u7684\u641C\u7D22\u7ED3\u679C\u7684\u6709\u7279\u6B8A\u9700\u6C42\uFF0C\u4F46\u662F\u6CA1\u6709\u53EF\u7528\u7684\u5173\u7CFB\u6570\u636E\u5E93\u53EF\u4EE5\u6EE1\u8DB3\u3002</li><li>\u5BF9\u4E0D\u540C\u8BB0\u5F55\u7C7B\u578B\u3001\u975E\u6587\u672C\u6570\u636E\u64CD\u4F5C\u6216\u5B89\u5168\u4E8B\u52A1\u5904\u7406\u7684\u9700\u6C42\u76F8\u5BF9\u8F83\u5C11\u7684\u60C5\u51B5\u3002\u4E3A\u4E86\u89E3\u51B3\u7ED3\u6784\u5316\u6570\u636E\u641C\u7D22\u548C\u975E\u7ED3\u6784\u5316\u6570\u636E\u641C\u7D22\u6027\u80FD\u95EE\u9898\uFF0C\u6211\u4EEC\u5C31\u9700\u8981\u4E13\u4E1A\uFF0C\u5065\u58EE\uFF0C\u5F3A\u5927\u7684\u5168\u6587\u641C\u7D22\u5F15\u64CE \u3002</li></ul><p><strong>\u8FD9\u91CC\u8BF4\u5230\u7684\u5168\u6587\u641C\u7D22\u5F15\u64CE\u6307\u7684\u662F\u76EE\u524D\u5E7F\u6CDB\u5E94\u7528\u7684\u4E3B\u6D41\u641C\u7D22\u5F15\u64CE</strong>\u3002\u5B83\u7684\u5DE5\u4F5C\u539F\u7406\u662F\u8BA1\u7B97\u673A\u7D22\u5F15\u7A0B\u5E8F\u901A\u8FC7\u626B\u63CF\u6587\u7AE0\u4E2D\u7684\u6BCF\u4E00\u4E2A\u8BCD\uFF0C\u5BF9\u6BCF\u4E00\u4E2A\u8BCD\u5EFA\u7ACB\u4E00\u4E2A\u7D22\u5F15\uFF0C\u6307\u660E\u8BE5\u8BCD\u5728\u6587\u7AE0\u4E2D\u51FA\u73B0\u7684\u6B21\u6570\u548C\u4F4D\u7F6E\uFF0C\u5F53\u7528\u6237\u67E5\u8BE2\u65F6\uFF0C\u68C0\u7D22\u7A0B\u5E8F\u5C31\u6839\u636E\u4E8B\u5148\u5EFA\u7ACB\u7684\u7D22\u5F15\u8FDB\u884C\u67E5\u627E\uFF0C\u5E76\u5C06\u67E5\u627E\u7684\u7ED3\u679C\u53CD\u9988\u7ED9\u7528\u6237\u7684\u68C0\u7D22\u65B9\u5F0F\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u7C7B\u4F3C\u4E8E\u901A\u8FC7\u5B57\u5178\u4E2D\u7684\u68C0\u7D22\u5B57\u8868\u67E5\u5B57\u7684\u8FC7\u7A0B\u3002</p><h4 id="elasticsearch-\u5E94\u7528\u6848\u4F8B" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u5E94\u7528\u6848\u4F8B" aria-hidden="true">#</a> Elasticsearch \u5E94\u7528\u6848\u4F8B</h4><ul><li>GitHub: 2013 \u5E74\u521D\uFF0C\u629B\u5F03\u4E86 Solr\uFF0C\u91C7\u53D6 Elasticsearch \u6765\u505A PB \u7EA7\u7684\u641C\u7D22\u3002 \u201CGitHub \u4F7F\u7528Elasticsearch \u641C\u7D22 20TB \u7684\u6570\u636E\uFF0C\u5305\u62EC 13 \u4EBF\u6587\u4EF6\u548C 1300 \u4EBF\u884C\u4EE3\u7801\u201D\u3002</li><li>\u7EF4\u57FA\u767E\u79D1\uFF1A\u542F\u52A8\u4EE5 Elasticsearch \u4E3A\u57FA\u7840\u7684\u6838\u5FC3\u641C\u7D22\u67B6\u6784</li><li>\u767E\u5EA6\uFF1A\u76EE\u524D\u5E7F\u6CDB\u4F7F\u7528 Elasticsearch \u4F5C\u4E3A\u6587\u672C\u6570\u636E\u5206\u6790\uFF0C\u91C7\u96C6\u767E\u5EA6\u6240\u6709\u670D\u52A1\u5668\u4E0A\u7684\u5404\u7C7B\u6307\u6807\u6570\u636E\u53CA\u7528\u6237\u81EA\u5B9A\u4E49\u6570\u636E\uFF0C\u901A\u8FC7\u5BF9\u5404\u79CD\u6570\u636E\u8FDB\u884C\u591A\u7EF4\u5206\u6790\u5C55\u793A\uFF0C\u8F85\u52A9\u5B9A\u4F4D\u5206\u6790\u5B9E\u4F8B\u5F02\u5E38\u6216\u4E1A\u52A1\u5C42\u9762\u5F02\u5E38\u3002\u76EE\u524D\u8986\u76D6\u767E\u5EA6\u5185\u90E8 20 \u591A\u4E2A\u4E1A\u52A1\u7EBF\uFF08\u5305\u62EC\u4E91\u5206\u6790\u3001\u7F51\u76DF\u3001\u9884\u6D4B\u3001\u6587\u5E93\u3001\u76F4\u8FBE\u53F7\u3001\u94B1\u5305\u3001 \u98CE\u63A7\u7B49\uFF09\uFF0C\u5355\u96C6\u7FA4\u6700\u5927 100 \u53F0\u673A\u5668\uFF0C 200 \u4E2A ES \u8282\u70B9\uFF0C\u6BCF\u5929\u5BFC\u5165 30TB+\u6570\u636E\u3002</li><li>\u65B0\u6D6A\uFF1A\u4F7F\u7528 Elasticsearch \u5206\u6790\u5904\u7406 32 \u4EBF\u6761\u5B9E\u65F6\u65E5\u5FD7\u3002</li><li>\u963F\u91CC\uFF1A\u4F7F\u7528 Elasticsearch \u6784\u5EFA\u65E5\u5FD7\u91C7\u96C6\u548C\u5206\u6790\u4F53\u7CFB\u3002</li><li>Stack Overflow\uFF1A\u89E3\u51B3 Bug \u95EE\u9898\u7684\u7F51\u7AD9\uFF0C\u5168\u82F1\u6587\uFF0C\u7F16\u7A0B\u4EBA\u5458\u4EA4\u6D41\u7684\u7F51\u7AD9\u3002</li></ul><h2 id="\u7B2C2\u7AE0-elasticsearch\u5165\u95E8" tabindex="-1"><a class="header-anchor" href="#\u7B2C2\u7AE0-elasticsearch\u5165\u95E8" aria-hidden="true">#</a> \u7B2C2\u7AE0 Elasticsearch\u5165\u95E8</h2><h3 id="_04-\u5165\u95E8-\u73AF\u5883\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_04-\u5165\u95E8-\u73AF\u5883\u51C6\u5907" aria-hidden="true">#</a> 04-\u5165\u95E8-\u73AF\u5883\u51C6\u5907</h3>',24),r={href:"https://www.elastic.co/cn/",target:"_blank",rel:"noopener noreferrer"},k=s("\u5B98\u65B9\u7F51\u5740"),d={href:"https://www.elastic.co/guide/index.html",target:"_blank",rel:"noopener noreferrer"},v=s("\u5B98\u65B9\u6587\u6863"),m={href:"https://mirrors.huaweicloud.com/elasticsearch/7.6.1/",target:"_blank",rel:"noopener noreferrer"},b=s("Elasticsearch 7.6.1\u4E0B\u8F7D\u9875\u9762"),q=p(`<p>Windows \u7248\u7684 Elasticsearch \u538B\u7F29\u5305\uFF0C\u89E3\u538B\u5373\u5B89\u88C5\u5B8C\u6BD5\uFF0C\u89E3\u538B\u540E\u7684 Elasticsearch \u7684\u76EE\u5F55\u7ED3\u6784\u5982\u4E0B \uFF1A</p><table><thead><tr><th>\u76EE\u5F55</th><th>\u542B\u4E49</th></tr></thead><tbody><tr><td>bin</td><td>\u53EF\u6267\u884C\u811A\u672C\u76EE\u5F55</td></tr><tr><td>config</td><td>\u914D\u7F6E\u76EE\u5F55</td></tr><tr><td>jdk</td><td>\u5185\u7F6E JDK \u76EE\u5F55</td></tr><tr><td>lib</td><td>\u7C7B\u5E93</td></tr><tr><td>logs</td><td>\u65E5\u5FD7\u76EE\u5F55</td></tr><tr><td>modules</td><td>\u6A21\u5757\u76EE\u5F55</td></tr><tr><td>plugins</td><td>\u63D2\u4EF6\u76EE\u5F55</td></tr></tbody></table><p>\u89E3\u538B\u540E\uFF0C\u8FDB\u5165 bin \u6587\u4EF6\u76EE\u5F55\uFF0C\u70B9\u51FB elasticsearch.bat \u6587\u4EF6\u542F\u52A8 ES \u670D\u52A1 \u3002</p><p>\u6CE8\u610F\uFF1A 9300 \u7AEF\u53E3\u4E3A Elasticsearch \u96C6\u7FA4\u95F4\u7EC4\u4EF6\u7684\u901A\u4FE1\u7AEF\u53E3\uFF0C 9200 \u7AEF\u53E3\u4E3A\u6D4F\u89C8\u5668\u8BBF\u95EE\u7684 http\u534F\u8BAE RESTful \u7AEF\u53E3\u3002</p><p>\u6253\u5F00\u6D4F\u89C8\u5668\uFF0C\u8F93\u5165\u5730\u5740\uFF1A http://localhost:9200\uFF0C\u6D4B\u8BD5\u8FD4\u56DE\u7ED3\u679C\uFF0C\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PC-20240112NFDK&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cluster_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;elasticsearch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cluster_uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;YgVpbVpeQTC7gYS6RXY2Sw&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7.8.0&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;build_flavor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;build_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zip&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;build_hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;757314695644ea9a1dc2fecd26d1a43856725e65&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;build_date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2020-06-14T19:35:50.234439Z&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;build_snapshot&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">&quot;lucene_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.5.1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;minimum_wire_compatibility_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;6.8.0&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;minimum_index_compatibility_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tagline&quot;</span><span class="token operator">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_05-\u5165\u95E8-restful-json" tabindex="-1"><a class="header-anchor" href="#_05-\u5165\u95E8-restful-json" aria-hidden="true">#</a> 05-\u5165\u95E8-RESTful &amp; JSON</h3><p>REST \u6307\u7684\u662F\u4E00\u7EC4\u67B6\u6784\u7EA6\u675F\u6761\u4EF6\u548C\u539F\u5219\u3002\u6EE1\u8DB3\u8FD9\u4E9B\u7EA6\u675F\u6761\u4EF6\u548C\u539F\u5219\u7684\u5E94\u7528\u7A0B\u5E8F\u6216\u8BBE\u8BA1\u5C31\u662F RESTful\u3002 Web \u5E94\u7528\u7A0B\u5E8F\u6700\u91CD\u8981\u7684 REST \u539F\u5219\u662F\uFF0C\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u4EA4\u4E92\u5728\u8BF7\u6C42\u4E4B\u95F4\u662F\u65E0\u72B6\u6001\u7684\u3002\u4ECE\u5BA2\u6237\u7AEF\u5230\u670D\u52A1\u5668\u7684\u6BCF\u4E2A\u8BF7\u6C42\u90FD\u5FC5\u987B\u5305\u542B\u7406\u89E3\u8BF7\u6C42\u6240\u5FC5\u9700\u7684\u4FE1\u606F\u3002\u5982\u679C\u670D\u52A1\u5668\u5728\u8BF7\u6C42\u4E4B\u95F4\u7684\u4EFB\u4F55\u65F6\u95F4\u70B9\u91CD\u542F\uFF0C\u5BA2\u6237\u7AEF\u4E0D\u4F1A\u5F97\u5230\u901A\u77E5\u3002\u6B64\u5916\uFF0C\u65E0\u72B6\u6001\u8BF7\u6C42\u53EF\u4EE5\u7531\u4EFB\u4F55\u53EF\u7528\u670D\u52A1\u5668\u56DE\u7B54\uFF0C\u8FD9\u5341\u5206\u9002\u5408\u4E91\u8BA1\u7B97\u4E4B\u7C7B\u7684\u73AF\u5883\u3002\u5BA2\u6237\u7AEF\u53EF\u4EE5\u7F13\u5B58\u6570\u636E\u4EE5\u6539\u8FDB\u6027\u80FD\u3002</p><p>\u5728\u670D\u52A1\u5668\u7AEF\uFF0C\u5E94\u7528\u7A0B\u5E8F\u72B6\u6001\u548C\u529F\u80FD\u53EF\u4EE5\u5206\u4E3A\u5404\u79CD\u8D44\u6E90\u3002\u8D44\u6E90\u662F\u4E00\u4E2A\u6709\u8DA3\u7684\u6982\u5FF5\u5B9E\u4F53\uFF0C\u5B83\u5411\u5BA2\u6237\u7AEF\u516C\u5F00\u3002\u8D44\u6E90\u7684\u4F8B\u5B50\u6709\uFF1A\u5E94\u7528\u7A0B\u5E8F\u5BF9\u8C61\u3001\u6570\u636E\u5E93\u8BB0\u5F55\u3001\u7B97\u6CD5\u7B49\u7B49\u3002\u6BCF\u4E2A\u8D44\u6E90\u90FD\u4F7F\u7528 URI(Universal Resource Identifier) \u5F97\u5230\u4E00\u4E2A\u552F\u4E00\u7684\u5730\u5740\u3002\u6240\u6709\u8D44\u6E90\u90FD\u5171\u4EAB\u7EDF\u4E00\u7684\u63A5\u53E3\uFF0C\u4EE5\u4FBF\u5728\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u5668\u4E4B\u95F4\u4F20\u8F93\u72B6\u6001\u3002\u4F7F\u7528\u7684\u662F\u6807\u51C6\u7684 HTTP \u65B9\u6CD5\uFF0C\u6BD4\u5982 GET\u3001 PUT\u3001 POST \u548CDELETE\u3002</p><p>\u5728 REST \u6837\u5F0F\u7684 Web \u670D\u52A1\u4E2D\uFF0C\u6BCF\u4E2A\u8D44\u6E90\u90FD\u6709\u4E00\u4E2A\u5730\u5740\u3002\u8D44\u6E90\u672C\u8EAB\u90FD\u662F\u65B9\u6CD5\u8C03\u7528\u7684\u76EE<br> \u6807\uFF0C\u65B9\u6CD5\u5217\u8868\u5BF9\u6240\u6709\u8D44\u6E90\u90FD\u662F\u4E00\u6837\u7684\u3002\u8FD9\u4E9B\u65B9\u6CD5\u90FD\u662F\u6807\u51C6\u65B9\u6CD5\uFF0C\u5305\u62EC HTTP GET\u3001 POST\u3001PUT\u3001 DELETE\uFF0C\u8FD8\u53EF\u80FD\u5305\u62EC HEAD \u548C OPTIONS\u3002\u7B80\u5355\u7684\u7406\u89E3\u5C31\u662F\uFF0C<strong>\u5982\u679C\u60F3\u8981\u8BBF\u95EE\u4E92\u8054\u7F51\u4E0A\u7684\u8D44\u6E90\uFF0C\u5C31\u5FC5\u987B\u5411\u8D44\u6E90\u6240\u5728\u7684\u670D\u52A1\u5668\u53D1\u51FA\u8BF7\u6C42\uFF0C\u8BF7\u6C42\u4F53\u4E2D\u5FC5\u987B\u5305\u542B\u8D44\u6E90\u7684\u7F51\u7EDC\u8DEF\u5F84\uFF0C \u4EE5\u53CA\u5BF9\u8D44\u6E90\u8FDB\u884C\u7684\u64CD\u4F5C(\u589E\u5220\u6539\u67E5)</strong>\u3002</p><p>REST \u6837\u5F0F\u7684 Web \u670D\u52A1\u82E5\u6709\u8FD4\u56DE\u7ED3\u679C\uFF0C\u5927\u591A\u6570\u4EE5JSON\u5B57\u7B26\u4E32\u5F62\u5F0F\u8FD4\u56DE\u3002</p><h3 id="_06-\u5165\u95E8-postman\u5BA2\u6237\u7AEF\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#_06-\u5165\u95E8-postman\u5BA2\u6237\u7AEF\u5DE5\u5177" aria-hidden="true">#</a> 06-\u5165\u95E8-Postman\u5BA2\u6237\u7AEF\u5DE5\u5177</h3><p>\u5982\u679C\u76F4\u63A5\u901A\u8FC7\u6D4F\u89C8\u5668\u5411 Elasticsearch \u670D\u52A1\u5668\u53D1\u8BF7\u6C42\uFF0C\u90A3\u4E48\u9700\u8981\u5728\u53D1\u9001\u7684\u8BF7\u6C42\u4E2D\u5305\u542B<br> HTTP \u6807\u51C6\u7684\u65B9\u6CD5\uFF0C\u800C HTTP \u7684\u5927\u90E8\u5206\u7279\u6027\u4E14\u4EC5\u652F\u6301 GET \u548C POST \u65B9\u6CD5\u3002\u6240\u4EE5\u4E3A\u4E86\u80FD\u65B9\u4FBF\u5730\u8FDB\u884C\u5BA2\u6237\u7AEF\u7684\u8BBF\u95EE\uFF0C\u53EF\u4EE5\u4F7F\u7528 Postman \u8F6F\u4EF6Postman \u662F\u4E00\u6B3E\u5F3A\u5927\u7684\u7F51\u9875\u8C03\u8BD5\u5DE5\u5177\uFF0C\u63D0\u4F9B\u529F\u80FD\u5F3A\u5927\u7684 Web API \u548C HTTP \u8BF7\u6C42\u8C03\u8BD5\u3002</p><p>\u8F6F\u4EF6\u529F\u80FD\u5F3A\u5927\uFF0C\u754C\u9762\u7B80\u6D01\u660E\u6670\u3001\u64CD\u4F5C\u65B9\u4FBF\u5FEB\u6377\uFF0C\u8BBE\u8BA1\u5F97\u5F88\u4EBA\u6027\u5316\u3002 Postman \u4E2D\u6587\u7248\u80FD\u591F\u53D1\u9001\u4EFB\u4F55\u7C7B\u578B\u7684 HTTP \u8BF7\u6C42 (GET, HEAD, POST, PUT\u2026)\uFF0C\u4E0D\u4EC5\u80FD\u591F\u8868\u5355\u63D0\u4EA4\uFF0C\u4E14\u53EF\u4EE5\u9644\u5E26\u4EFB\u610F\u7C7B\u578B\u8BF7\u6C42\u4F53\u3002</p>`,14),g={href:"https://www.postman.com/downloads/",target:"_blank",rel:"noopener noreferrer"},h=s("Postman\u4E0B\u8F7D\u9875\u9762"),y=p(`<h3 id="_07-\u5165\u95E8-\u5012\u6392\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#_07-\u5165\u95E8-\u5012\u6392\u7D22\u5F15" aria-hidden="true">#</a> 07-\u5165\u95E8-\u5012\u6392\u7D22\u5F15</h3><p>\u6B63\u6392\u7D22\u5F15\uFF08\u4F20\u7EDF\uFF09</p><table><thead><tr><th>id</th><th>content</th></tr></thead><tbody><tr><td>1001</td><td>my name is zhang san</td></tr><tr><td>1002</td><td>my name is li si</td></tr></tbody></table><p>\u5012\u6392\u7D22\u5F15</p><table><thead><tr><th>keyword</th><th>id</th></tr></thead><tbody><tr><td>name</td><td>1001, 1002</td></tr><tr><td>zhang</td><td>1001</td></tr></tbody></table><p>Elasticsearch \u662F<strong>\u9762\u5411\u6587\u6863\u578B\u6570\u636E\u5E93</strong>\uFF0C\u4E00\u6761\u6570\u636E\u5728\u8FD9\u91CC\u5C31\u662F\u4E00\u4E2A\u6587\u6863\u3002 \u4E3A\u4E86\u65B9\u4FBF\u5927\u5BB6\u7406\u89E3\uFF0C\u6211\u4EEC\u5C06 Elasticsearch \u91CC\u5B58\u50A8\u6587\u6863\u6570\u636E\u548C\u5173\u7CFB\u578B\u6570\u636E\u5E93 MySQL \u5B58\u50A8\u6570\u636E\u7684\u6982\u5FF5\u8FDB\u884C\u4E00\u4E2A\u7C7B\u6BD4</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/146a779da01f53e7f7a8d53132d3c7cf.png" alt=""></p><p>ES \u91CC\u7684 Index \u53EF\u4EE5\u770B\u505A\u4E00\u4E2A\u5E93\uFF0C\u800C Types \u76F8\u5F53\u4E8E\u8868\uFF0C Documents \u5219\u76F8\u5F53\u4E8E\u8868\u7684\u884C\u3002\u8FD9\u91CC Types \u7684\u6982\u5FF5\u5DF2\u7ECF\u88AB\u9010\u6E10\u5F31\u5316\uFF0C Elasticsearch 6.X \u4E2D\uFF0C\u4E00\u4E2A index \u4E0B\u5DF2\u7ECF\u53EA\u80FD\u5305\u542B\u4E00\u4E2Atype\uFF0C Elasticsearch 7.X \u4E2D, Type \u7684\u6982\u5FF5\u5DF2\u7ECF\u88AB\u5220\u9664\u4E86\u3002</p><h3 id="_08-\u5165\u95E8-http-\u7D22\u5F15-\u521B\u5EFA" tabindex="-1"><a class="header-anchor" href="#_08-\u5165\u95E8-http-\u7D22\u5F15-\u521B\u5EFA" aria-hidden="true">#</a> 08-\u5165\u95E8-HTTP-\u7D22\u5F15-\u521B\u5EFA</h3><p>\u5BF9\u6BD4\u5173\u7CFB\u578B\u6570\u636E\u5E93\uFF0C\u521B\u5EFA\u7D22\u5F15\u5C31\u7B49\u540C\u4E8E\u521B\u5EFA\u6570\u636E\u5E93\u3002</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 PUT \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping</p><p>\u8BF7\u6C42\u540E\uFF0C\u670D\u52A1\u5668\u8FD4\u56DE\u54CD\u5E94\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//\u54CD\u5E94\u7ED3\u679C</span>
    <span class="token property">&quot;shards_acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//\u5206\u7247\u7ED3\u679C</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token comment">//\u7D22\u5F15\u540D\u79F0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u65E5\u5FD7\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token number">2021</span>-04-08T13:57:06,954<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.m.MetadataCreateIndexService<span class="token punctuation">]</span> <span class="token punctuation">[</span>DESKTOP-LNJQ0VF<span class="token punctuation">]</span> <span class="token punctuation">[</span>shopping<span class="token punctuation">]</span> creating index, cause <span class="token punctuation">[</span>api<span class="token punctuation">]</span>, templates <span class="token punctuation">[</span><span class="token punctuation">]</span>, shards <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>/<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>, mappings <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u91CD\u590D\u53D1 PUT \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping \u6DFB\u52A0\u7D22\u5F15\uFF0C\u4F1A\u8FD4\u56DE\u9519\u8BEF\u4FE1\u606F :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;root_cause&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;resource_already_exists_exception&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index [shopping/J0WlEhh4R7aDrfIc3AkwWQ] already exists&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;index_uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J0WlEhh4R7aDrfIc3AkwWQ&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;resource_already_exists_exception&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index [shopping/J0WlEhh4R7aDrfIc3AkwWQ] already exists&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;index_uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J0WlEhh4R7aDrfIc3AkwWQ&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">400</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_09-\u5165\u95E8-http-\u7D22\u5F15-\u67E5\u8BE2-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_09-\u5165\u95E8-http-\u7D22\u5F15-\u67E5\u8BE2-\u5220\u9664" aria-hidden="true">#</a> 09-\u5165\u95E8-HTTP-\u7D22\u5F15-\u67E5\u8BE2 &amp; \u5220\u9664</h3><h4 id="\u67E5\u770B\u6240\u6709\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u6240\u6709\u7D22\u5F15" aria-hidden="true">#</a> \u67E5\u770B\u6240\u6709\u7D22\u5F15</h4><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/_cat/indices?v</p><p>\u8FD9\u91CC\u8BF7\u6C42\u8DEF\u5F84\u4E2D\u7684_cat \u8868\u793A\u67E5\u770B\u7684\u610F\u601D\uFF0C indices \u8868\u793A\u7D22\u5F15\uFF0C\u6240\u4EE5\u6574\u4F53\u542B\u4E49\u5C31\u662F\u67E5\u770B\u5F53\u524D ES\u670D\u52A1\u5668\u4E2D\u7684\u6240\u6709\u7D22\u5F15\uFF0C\u5C31\u597D\u50CF MySQL \u4E2D\u7684 show tables \u7684\u611F\u89C9\uFF0C\u670D\u52A1\u5668\u54CD\u5E94\u7ED3\u679C\u5982\u4E0B :</p><div class="language-tex ext-tex line-numbers-mode"><pre class="language-tex"><code>health status index    uuid                   pri rep docs.count docs.deleted store.size pri.store.size
yellow open   shopping J0WlEhh4R7aDrfIc3AkwWQ   1   1          0            0       208b           208b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>\u8868\u5934</th><th>\u542B\u4E49</th></tr></thead><tbody><tr><td>health</td><td>\u5F53\u524D\u670D\u52A1\u5668\u5065\u5EB7\u72B6\u6001\uFF1A green(\u96C6\u7FA4\u5B8C\u6574) yellow(\u5355\u70B9\u6B63\u5E38\u3001\u96C6\u7FA4\u4E0D\u5B8C\u6574) red(\u5355\u70B9\u4E0D\u6B63\u5E38)</td></tr><tr><td>status</td><td>\u7D22\u5F15\u6253\u5F00\u3001\u5173\u95ED\u72B6\u6001</td></tr><tr><td>index</td><td>\u7D22\u5F15\u540D</td></tr><tr><td>uuid</td><td>\u7D22\u5F15\u7EDF\u4E00\u7F16\u53F7</td></tr><tr><td>pri</td><td>\u4E3B\u5206\u7247\u6570\u91CF</td></tr><tr><td>rep</td><td>\u526F\u672C\u6570\u91CF</td></tr><tr><td>docs.count</td><td>\u53EF\u7528\u6587\u6863\u6570\u91CF</td></tr><tr><td>docs.deleted</td><td>\u6587\u6863\u5220\u9664\u72B6\u6001\uFF08\u903B\u8F91\u5220\u9664\uFF09</td></tr><tr><td>store.size</td><td>\u4E3B\u5206\u7247\u548C\u526F\u5206\u7247\u6574\u4F53\u5360\u7A7A\u95F4\u5927\u5C0F</td></tr><tr><td>pri.store.size</td><td>\u4E3B\u5206\u7247\u5360\u7A7A\u95F4\u5927\u5C0F</td></tr></tbody></table><h4 id="\u67E5\u770B\u5355\u4E2A\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u5355\u4E2A\u7D22\u5F15" aria-hidden="true">#</a> \u67E5\u770B\u5355\u4E2A\u7D22\u5F15</h4><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping</p><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;shopping&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//\u7D22\u5F15\u540D</span>
        <span class="token property">&quot;aliases&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//\u522B\u540D</span>
        <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//\u6620\u5C04</span>
        <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//\u8BBE\u7F6E</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15</span>
                <span class="token property">&quot;creation_date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1617861426847&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15 - \u521B\u5EFA\u65F6\u95F4</span>
                <span class="token property">&quot;number_of_shards&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15 - \u4E3B\u5206\u7247\u6570\u91CF</span>
                <span class="token property">&quot;number_of_replicas&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15 - \u4E3B\u5206\u7247\u6570\u91CF</span>
                <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;J0WlEhh4R7aDrfIc3AkwWQ&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15 - \u4E3B\u5206\u7247\u6570\u91CF</span>
                <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15 - \u4E3B\u5206\u7247\u6570\u91CF</span>
                    <span class="token property">&quot;created&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7080099&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;provided_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token comment">//\u8BBE\u7F6E - \u7D22\u5F15 - \u4E3B\u5206\u7247\u6570\u91CF</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5220\u9664\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u5220\u9664\u7D22\u5F15" aria-hidden="true">#</a> \u5220\u9664\u7D22\u5F15</h4><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 DELETE \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping</p><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u518D\u6B21\u67E5\u770B\u6240\u6709\u7D22\u5F15\uFF0CGET http://127.0.0.1:9200/_cat/indices?v\uFF0C\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-tex ext-tex line-numbers-mode"><pre class="language-tex"><code>health status index uuid pri rep docs.count docs.deleted store.size pri.store.size
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6210\u529F\u5220\u9664\u3002</p><h3 id="_10-\u5165\u95E8-http-\u6587\u6863-\u521B\u5EFA-put-post" tabindex="-1"><a class="header-anchor" href="#_10-\u5165\u95E8-http-\u6587\u6863-\u521B\u5EFA-put-post" aria-hidden="true">#</a> 10-\u5165\u95E8-HTTP-\u6587\u6863-\u521B\u5EFA\uFF08Put &amp; Post\uFF09</h3><p>\u5047\u8BBE\u7D22\u5F15\u5DF2\u7ECF\u521B\u5EFA\u597D\u4E86\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u6765\u521B\u5EFA\u6587\u6863\uFF0C\u5E76\u6DFB\u52A0\u6570\u636E\u3002\u8FD9\u91CC\u7684\u6587\u6863\u53EF\u4EE5\u7C7B\u6BD4\u4E3A\u5173\u7CFB\u578B\u6570\u636E\u5E93\u4E2D\u7684\u8868\u6570\u636E\uFF0C\u6DFB\u52A0\u7684\u6570\u636E\u683C\u5F0F\u4E3A JSON \u683C\u5F0F</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 POST \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc\uFF0C\u8BF7\u6C42\u4F53JSON\u5185\u5BB9\u4E3A\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">3999.00</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://qiniu.xinghe.fit/Elasticsearch/20d54cba223bd9d70ea356d3e40a8161.png" alt=""></p><p>\u6CE8\u610F\uFF0C\u6B64\u5904\u53D1\u9001\u8BF7\u6C42\u7684\u65B9\u5F0F\u5FC5\u987B\u4E3A POST\uFF0C\u4E0D\u80FD\u662F PUT\uFF0C\u5426\u5219\u4F1A\u53D1\u751F\u9519\u8BEF \u3002</p><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u7D22\u5F15</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u7C7B\u578B-\u6587\u6863</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u552F\u4E00\u6807\u8BC6\uFF0C\u53EF\u4EE5\u7C7B\u6BD4\u4E3A MySQL \u4E2D\u7684\u4E3B\u952E\uFF0C\u968F\u673A\u751F\u6210</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//\u7248\u672C</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u7ED3\u679C\uFF0C\u8FD9\u91CC\u7684 create \u8868\u793A\u521B\u5EFA\u6210\u529F</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">//\u5206\u7247 - \u603B\u6570</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//\u5206\u7247 - \u603B\u6570</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token comment">//\u5206\u7247 - \u603B\u6570</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684\u6570\u636E\u521B\u5EFA\u540E\uFF0C\u7531\u4E8E\u6CA1\u6709\u6307\u5B9A\u6570\u636E\u552F\u4E00\u6027\u6807\u8BC6\uFF08ID\uFF09\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C ES \u670D\u52A1\u5668\u4F1A\u968F\u673A\u751F\u6210\u4E00\u4E2A\u3002</p><p>\u5982\u679C\u60F3\u8981\u81EA\u5B9A\u4E49\u552F\u4E00\u6027\u6807\u8BC6\uFF0C\u9700\u8981\u5728\u521B\u5EFA\u65F6\u6307\u5B9A\uFF1A http://127.0.0.1:9200/shopping/_doc/1\uFF0C\u8BF7\u6C42\u4F53JSON\u5185\u5BB9\u4E3A\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">3999.00</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token comment">//&lt;------------------\u81EA\u5B9A\u4E49\u552F\u4E00\u6027\u6807\u8BC6</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6B64\u5904\u9700\u8981\u6CE8\u610F\uFF1A\u5982\u679C\u589E\u52A0\u6570\u636E\u65F6\u660E\u786E\u6570\u636E\u4E3B\u952E\uFF0C\u90A3\u4E48\u8BF7\u6C42\u65B9\u5F0F\u4E5F\u53EF\u4EE5\u4E3A PUT\u3002</strong></p><h3 id="_11-\u5165\u95E8-http-\u67E5\u8BE2-\u4E3B\u952E\u67E5\u8BE2-\u5168\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_11-\u5165\u95E8-http-\u67E5\u8BE2-\u4E3B\u952E\u67E5\u8BE2-\u5168\u67E5\u8BE2" aria-hidden="true">#</a> 11-\u5165\u95E8-HTTP-\u67E5\u8BE2-\u4E3B\u952E\u67E5\u8BE2 &amp; \u5168\u67E5\u8BE2</h3><p>\u67E5\u770B\u6587\u6863\u65F6\uFF0C\u9700\u8981\u6307\u660E\u6587\u6863\u7684\u552F\u4E00\u6027\u6807\u8BC6\uFF0C\u7C7B\u4F3C\u4E8E MySQL \u4E2D\u6570\u636E\u7684\u4E3B\u952E\u67E5\u8BE2</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc/1 \u3002</p><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;found&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u627E\u4E0D\u5B58\u5728\u7684\u5185\u5BB9\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc/1001\u3002</p><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;found&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u770B\u7D22\u5F15\u4E0B\u6240\u6709\u6570\u636E\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\u3002</p><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">133</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_12-\u5165\u95E8-http-\u5168\u91CF\u4FEE\u6539-\u5C40\u90E8\u4FEE\u6539-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_12-\u5165\u95E8-http-\u5168\u91CF\u4FEE\u6539-\u5C40\u90E8\u4FEE\u6539-\u5220\u9664" aria-hidden="true">#</a> 12-\u5165\u95E8-HTTP-\u5168\u91CF\u4FEE\u6539 &amp; \u5C40\u90E8\u4FEE\u6539 &amp; \u5220\u9664</h3><h4 id="\u5168\u91CF\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#\u5168\u91CF\u4FEE\u6539" aria-hidden="true">#</a> \u5168\u91CF\u4FEE\u6539</h4><p>\u548C\u65B0\u589E\u6587\u6863\u4E00\u6837\uFF0C\u8F93\u5165\u76F8\u540C\u7684 URL \u5730\u5740\u8BF7\u6C42\uFF0C\u5982\u679C\u8BF7\u6C42\u4F53\u53D8\u5316\uFF0C\u4F1A\u5C06\u539F\u6709\u7684\u6570\u636E\u5185\u5BB9\u8986\u76D6</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 POST \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc/1</p><p>\u8BF7\u6C42\u4F53JSON\u5185\u5BB9\u4E3A:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://www.gulixueyuan.com/hw.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">1999.00</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539\u6210\u529F\u540E\uFF0C\u670D\u52A1\u5668\u54CD\u5E94\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span><span class="token comment">//&lt;-----------updated \u8868\u793A\u6570\u636E\u88AB\u66F4\u65B0</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5C40\u90E8\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#\u5C40\u90E8\u4FEE\u6539" aria-hidden="true">#</a> \u5C40\u90E8\u4FEE\u6539</h4><p>\u4FEE\u6539\u6570\u636E\u65F6\uFF0C\u4E5F\u53EF\u4EE5\u53EA\u4FEE\u6539\u67D0\u4E00\u7ED9\u6761\u6570\u636E\u7684\u5C40\u90E8\u4FE1\u606F</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 POST \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_update/1\u3002</p><p>\u8BF7\u6C42\u4F53JSON\u5185\u5BB9\u4E3A:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;doc&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span><span class="token comment">//&lt;-----------updated \u8868\u793A\u6570\u636E\u88AB\u66F4\u65B0</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc/1\uFF0C\u67E5\u770B\u4FEE\u6539\u5185\u5BB9\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;found&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/hw.jpg&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#\u5220\u9664" aria-hidden="true">#</a> \u5220\u9664</h4><p>\u5220\u9664\u4E00\u4E2A\u6587\u6863\u4E0D\u4F1A\u7ACB\u5373\u4ECE\u78C1\u76D8\u4E0A\u79FB\u9664\uFF0C\u5B83\u53EA\u662F\u88AB\u6807\u8BB0\u6210\u5DF2\u5220\u9664\uFF08\u903B\u8F91\u5220\u9664\uFF09\u3002</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 DELETE \u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc/1</p><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deleted&quot;</span><span class="token punctuation">,</span><span class="token comment">//&lt;---\u5220\u9664\u6210\u529F</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_doc/1\uFF0C\u67E5\u770B\u662F\u5426\u5220\u9664\u6210\u529F\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;found&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_13-\u5165\u95E8-http-\u6761\u4EF6\u67E5\u8BE2-\u5206\u9875\u67E5\u8BE2-\u67E5\u8BE2\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#_13-\u5165\u95E8-http-\u6761\u4EF6\u67E5\u8BE2-\u5206\u9875\u67E5\u8BE2-\u67E5\u8BE2\u6392\u5E8F" aria-hidden="true">#</a> 13-\u5165\u95E8-HTTP-\u6761\u4EF6\u67E5\u8BE2 &amp; \u5206\u9875\u67E5\u8BE2 &amp; \u67E5\u8BE2\u6392\u5E8F</h3><h4 id="\u6761\u4EF6\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u6761\u4EF6\u67E5\u8BE2" aria-hidden="true">#</a> \u6761\u4EF6\u67E5\u8BE2</h4><p>\u5047\u8BBE\u6709\u4EE5\u4E0B\u6587\u6863\u5185\u5BB9\uFF0C\uFF08\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF09\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="url\u5E26\u53C2\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#url\u5E26\u53C2\u67E5\u8BE2" aria-hidden="true">#</a> URL\u5E26\u53C2\u67E5\u8BE2</h5><p><strong>\u67E5\u627Ecategory\u4E3A\u5C0F\u7C73\u7684\u6587\u6863</strong>\uFF0C\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search?q=category:\u5C0F\u7C73\uFF0C\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">94</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u4E3AURL\u5E26\u53C2\u6570\u5F62\u5F0F\u67E5\u8BE2\uFF0C\u8FD9\u5F88\u5BB9\u6613\u8BA9\u4E0D\u5584\u8005\u5FC3\u6000\u6076\u610F\uFF0C\u6216\u8005\u53C2\u6570\u503C\u51FA\u73B0\u4E2D\u6587\u4F1A\u51FA\u73B0\u4E71\u7801\u60C5\u51B5\u3002\u4E3A\u4E86\u907F\u514D\u8FD9\u4E9B\u60C5\u51B5\uFF0C\u6211\u4EEC\u53EF\u7528\u4F7F\u7528\u5E26JSON\u8BF7\u6C42\u4F53\u8BF7\u6C42\u8FDB\u884C\u67E5\u8BE2\u3002</p><h5 id="\u8BF7\u6C42\u4F53\u5E26\u53C2\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u8BF7\u6C42\u4F53\u5E26\u53C2\u67E5\u8BE2" aria-hidden="true">#</a> \u8BF7\u6C42\u4F53\u5E26\u53C2\u67E5\u8BE2</h5><p>\u63A5\u4E0B\u5E26JSON\u8BF7\u6C42\u4F53\uFF0C\u8FD8\u662F<strong>\u67E5\u627Ecategory\u4E3A\u5C0F\u7C73\u7684\u6587\u6863</strong>\uFF0C\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u5E26\u8BF7\u6C42\u4F53\u65B9\u5F0F\u7684\u67E5\u627E\u6240\u6709\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u5E26\u8BF7\u6C42\u4F53\u65B9\u5F0F\u7684\u67E5\u627E\u6240\u6709\u5185\u5BB9" aria-hidden="true">#</a> \u5E26\u8BF7\u6C42\u4F53\u65B9\u5F0F\u7684\u67E5\u627E\u6240\u6709\u5185\u5BB9</h5><p><strong>\u67E5\u627E\u6240\u6709\u6587\u6863\u5185\u5BB9</strong>\uFF0C\u4E5F\u53EF\u4EE5\u8FD9\u6837\uFF0C\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5219\u8FD4\u56DE\u6240\u6709\u6587\u6863\u5185\u5BB9\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u67E5\u8BE2\u6307\u5B9A\u5B57\u6BB5" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2\u6307\u5B9A\u5B57\u6BB5" aria-hidden="true">#</a> \u67E5\u8BE2\u6307\u5B9A\u5B57\u6BB5</h5><p><strong>\u5982\u679C\u4F60\u60F3\u67E5\u8BE2\u6307\u5B9A\u5B57\u6BB5</strong>\uFF0C\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token property">&quot;_source&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5206\u9875\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u5206\u9875\u67E5\u8BE2" aria-hidden="true">#</a> \u5206\u9875\u67E5\u8BE2</h4><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token property">&quot;from&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">&quot;size&quot;</span><span class="token operator">:</span><span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u8BE2\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2\u6392\u5E8F" aria-hidden="true">#</a> \u67E5\u8BE2\u6392\u5E8F</h4><p>\u5982\u679C\u4F60\u60F3\u901A\u8FC7\u6392\u5E8F\u67E5\u51FA\u4EF7\u683C\u6700\u9AD8\u7684\u624B\u673A\uFF0C\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token property">&quot;sort&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;order&quot;</span><span class="token operator">:</span><span class="token string">&quot;desc&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">96</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token number">3999</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token number">1999</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token number">1999</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token number">1999</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token number">1999</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token number">1999</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_14-\u5165\u95E8-http-\u591A\u6761\u4EF6\u67E5\u8BE2-\u8303\u56F4\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_14-\u5165\u95E8-http-\u591A\u6761\u4EF6\u67E5\u8BE2-\u8303\u56F4\u67E5\u8BE2" aria-hidden="true">#</a> 14-\u5165\u95E8-HTTP-\u591A\u6761\u4EF6\u67E5\u8BE2 &amp; \u8303\u56F4\u67E5\u8BE2</h3><h4 id="\u591A\u6761\u4EF6\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u591A\u6761\u4EF6\u67E5\u8BE2" aria-hidden="true">#</a> \u591A\u6761\u4EF6\u67E5\u8BE2</h4><p>\u5047\u8BBE\u60F3\u627E\u51FA\u5C0F\u7C73\u724C\u5B50\uFF0C\u4EF7\u683C\u4E3A3999\u5143\u7684\u3002\uFF08must\u76F8\u5F53\u4E8E\u6570\u636E\u5E93\u7684&amp;&amp;\uFF09</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;must&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
				<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
					<span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
				<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
					<span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">3999.00</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">134</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">2.3862944</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">2.3862944</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5047\u8BBE\u60F3\u627E\u51FA\u5C0F\u7C73\u548C\u534E\u4E3A\u7684\u724C\u5B50\u3002\uFF08should\u76F8\u5F53\u4E8E\u6570\u636E\u5E93\u7684||\uFF09</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;should&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
				<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
					<span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
				<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
					<span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A&quot;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;range&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                    <span class="token property">&quot;gt&quot;</span><span class="token operator">:</span><span class="token number">2000</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u8303\u56F4\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u8303\u56F4\u67E5\u8BE2" aria-hidden="true">#</a> \u8303\u56F4\u67E5\u8BE2</h4><p>\u5047\u8BBE\u60F3\u627E\u51FA\u5C0F\u7C73\u548C\u534E\u4E3A\u7684\u724C\u5B50\uFF0C\u4EF7\u683C\u5927\u4E8E2000\u5143\u7684\u624B\u673A\u3002</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;should&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
				<span class="token punctuation">{</span>
					<span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
						<span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token punctuation">{</span>
					<span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
						<span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
						<span class="token property">&quot;gt&quot;</span><span class="token operator">:</span> <span class="token number">2000</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">72</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1.3862942</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_15-\u5165\u95E8-http-\u5168\u6587\u68C0\u7D22-\u5B8C\u5168\u5339\u914D-\u9AD8\u4EAE\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_15-\u5165\u95E8-http-\u5168\u6587\u68C0\u7D22-\u5B8C\u5168\u5339\u914D-\u9AD8\u4EAE\u67E5\u8BE2" aria-hidden="true">#</a> 15-\u5165\u95E8-HTTP-\u5168\u6587\u68C0\u7D22 &amp; \u5B8C\u5168\u5339\u914D &amp; \u9AD8\u4EAE\u67E5\u8BE2</h3><h4 id="\u5168\u6587\u68C0\u7D22" tabindex="-1"><a class="header-anchor" href="#\u5168\u6587\u68C0\u7D22" aria-hidden="true">#</a> \u5168\u6587\u68C0\u7D22</h4><p>\u8FD9\u529F\u80FD\u50CF\u641C\u7D22\u5F15\u64CE\u90A3\u6837\uFF0C\u5982\u54C1\u724C\u8F93\u5165\u201C\u5C0F\u534E\u201D\uFF0C\u8FD4\u56DE\u7ED3\u679C\u5E26\u56DE\u54C1\u724C\u6709\u201C\u5C0F\u7C73\u201D\u548C\u534E\u4E3A\u7684\u3002</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u534E&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5B8C\u5168\u5339\u914D" tabindex="-1"><a class="header-anchor" href="#\u5B8C\u5168\u5339\u914D" aria-hidden="true">#</a> \u5B8C\u5168\u5339\u914D</h4><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u4E3A&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u9AD8\u4EAE\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u9AD8\u4EAE\u67E5\u8BE2" aria-hidden="true">#</a> \u9AD8\u4EAE\u67E5\u8BE2</h4><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;\u4E3A&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;highlight&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment">//&lt;----\u9AD8\u4EAE\u8FD9\u5B57\u6BB5</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;highlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;\u534E&lt;em&gt;\u4E3A&lt;/em&gt;&quot;</span><span class="token comment">//&lt;------\u9AD8\u4EAE\u4E00\u4E2A\u4E3A\u5B57\u3002</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;highlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;\u534E&lt;em&gt;\u4E3A&lt;/em&gt;&quot;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.6931471</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;highlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;\u534E&lt;em&gt;\u4E3A&lt;/em&gt;&quot;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_16-\u5165\u95E8-http-\u805A\u5408\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_16-\u5165\u95E8-http-\u805A\u5408\u67E5\u8BE2" aria-hidden="true">#</a> 16-\u5165\u95E8-HTTP-\u805A\u5408\u67E5\u8BE2</h3><p>\u805A\u5408\u5141\u8BB8\u4F7F\u7528\u8005\u5BF9 es \u6587\u6863\u8FDB\u884C\u7EDF\u8BA1\u5206\u6790\uFF0C\u7C7B\u4F3C\u4E0E\u5173\u7CFB\u578B\u6570\u636E\u5E93\u4E2D\u7684 group by\uFF0C\u5F53\u7136\u8FD8\u6709\u5F88\u591A\u5176\u4ED6\u7684\u805A\u5408\uFF0C\u4F8B\u5982\u53D6\u6700\u5927\u503Cmax\u3001\u5E73\u5747\u503Cavg\u7B49\u7B49\u3002</p><p>\u63A5\u4E0B\u6765\u6309price\u5B57\u6BB5\u8FDB\u884C\u5206\u7EC4\uFF1A</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">//\u805A\u5408\u64CD\u4F5C</span>
		<span class="token property">&quot;price_group&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">//\u540D\u79F0\uFF0C\u968F\u610F\u8D77\u540D</span>
			<span class="token property">&quot;terms&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">//\u5206\u7EC4</span>
				<span class="token property">&quot;field&quot;</span><span class="token operator">:</span><span class="token string">&quot;price&quot;</span><span class="token comment">//\u5206\u7EC4\u5B57\u6BB5</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">63</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ANQqsHgBaKNfVnMbhZYU&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">3999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A9R5sHgBaKNfVnMb25Ya&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BNR5sHgBaKNfVnMb7pal&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BtR6sHgBaKNfVnMbX5Y5&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B9R6sHgBaKNfVnMbZpZ6&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CdR7sHgBaKNfVnMbsJb9&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u534E\u4E3A&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://www.gulixueyuan.com/xm.jpg&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">1999</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggregations&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;price_group&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token number">1999</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;doc_count&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token number">3999</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;doc_count&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u8FD4\u56DE\u7ED3\u679C\u4F1A\u9644\u5E26\u539F\u59CB\u6570\u636E\u7684\u3002\u82E5\u4E0D\u60F3\u8981\u4E0D\u9644\u5E26\u539F\u59CB\u6570\u636E\u7684\u7ED3\u679C\uFF0C\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;price_group&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;terms&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
				<span class="token property">&quot;field&quot;</span><span class="token operator">:</span><span class="token string">&quot;price&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggregations&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;price_group&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token number">1999</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;doc_count&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token number">3999</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;doc_count&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u82E5\u60F3\u5BF9\u6240\u6709\u624B\u673A\u4EF7\u683C\u6C42<strong>\u5E73\u5747\u503C</strong>\u3002</p><p>\u5728 Postman \u4E2D\uFF0C\u5411 ES \u670D\u52A1\u5668\u53D1 GET\u8BF7\u6C42 \uFF1A http://127.0.0.1:9200/shopping/_search\uFF0C\u9644\u5E26JSON\u4F53\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;price_avg&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">//\u540D\u79F0\uFF0C\u968F\u610F\u8D77\u540D</span>
			<span class="token property">&quot;avg&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">//\u6C42\u5E73\u5747</span>
				<span class="token property">&quot;field&quot;</span><span class="token operator">:</span><span class="token string">&quot;price&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;size&quot;</span><span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggregations&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;price_avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">2332.3333333333335</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-\u5165\u95E8-http-\u6620\u5C04\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#_17-\u5165\u95E8-http-\u6620\u5C04\u5173\u7CFB" aria-hidden="true">#</a> 17-\u5165\u95E8-HTTP-\u6620\u5C04\u5173\u7CFB</h3><p>\u6709\u4E86\u7D22\u5F15\u5E93\uFF0C\u7B49\u4E8E\u6709\u4E86\u6570\u636E\u5E93\u4E2D\u7684 database\u3002</p><p>\u63A5\u4E0B\u6765\u5C31\u9700\u8981\u5EFA\u7D22\u5F15\u5E93(index)\u4E2D\u7684\u6620\u5C04\u4E86\uFF0C\u7C7B\u4F3C\u4E8E\u6570\u636E\u5E93(database)\u4E2D\u7684\u8868\u7ED3\u6784(table)\u3002</p><p>\u521B\u5EFA\u6570\u636E\u5E93\u8868\u9700\u8981\u8BBE\u7F6E\u5B57\u6BB5\u540D\u79F0\uFF0C\u7C7B\u578B\uFF0C\u957F\u5EA6\uFF0C\u7EA6\u675F\u7B49\uFF1B\u7D22\u5F15\u5E93\u4E5F\u4E00\u6837\uFF0C\u9700\u8981\u77E5\u9053\u8FD9\u4E2A\u7C7B\u578B\u4E0B\u6709\u54EA\u4E9B\u5B57\u6BB5\uFF0C\u6BCF\u4E2A\u5B57\u6BB5\u6709\u54EA\u4E9B\u7EA6\u675F\u4FE1\u606F\uFF0C\u8FD9\u5C31\u53EB\u505A\u6620\u5C04(mapping)\u3002</p><p>\u5148\u521B\u5EFA\u4E00\u4E2A\u7D22\u5F15\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;shards_acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u521B\u5EFA\u6620\u5C04</strong></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_mapping</span>

<span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        	<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        	<span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;sex&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        	<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
        	<span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;tel&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        	<span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
        	<span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u67E5\u8BE2\u6620\u5C04</strong></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_mapping</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;sex&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;tel&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u589E\u52A0\u6570\u636E</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_create/1001</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;sex&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u7537\u7684&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;tel&quot;</span><span class="token operator">:</span><span class="token string">&quot;1111&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u627Ename\u542B\u6709\u201D\u5C0F\u201C\u6570\u636E\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_search</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5C0F&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">495</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">0.2876821</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.2876821</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;sex&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u7537\u7684&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;tel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1111&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u627Esex\u542B\u6709\u201D\u7537\u201C\u6570\u636E\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_search</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;sex&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u7537&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u627E\u4E0D\u60F3\u8981\u7684\u7ED3\u679C\uFF0C\u53EA\u56E0\u521B\u5EFA\u6620\u5C04\u65F6&quot;sex&quot;\u7684\u7C7B\u578B\u4E3A&quot;keyword&quot;\u3002</p><p>&quot;sex&quot;\u53EA\u80FD\u5B8C\u5168\u4E3A\u201D\u7537\u7684\u201C\uFF0C\u624D\u80FD\u5F97\u51FA\u539F\u6570\u636E\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_search</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;sex&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u7537\u7684&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;skipped&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;relation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span> <span class="token number">0.2876821</span><span class="token punctuation">,</span>
        <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">0.2876821</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;sex&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u7537\u7684&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;tel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1111&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u8BE2\u7535\u8BDD</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/user/_search</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
			<span class="token property">&quot;tel&quot;</span><span class="token operator">:</span><span class="token string">&quot;11&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;root_cause&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;query_shard_exception&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;failed to create query: Cannot search on field [tel] since it is not indexed.&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;index_uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ivLnMfQKROS7Skb2MTFOew&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;search_phase_execution_exception&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;all shards failed&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;phase&quot;</span><span class="token operator">:</span> <span class="token string">&quot;query&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;grouped&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;shard&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4P7dIRfXSbezE5JTiuylew&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;query_shard_exception&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;failed to create query: Cannot search on field [tel] since it is not indexed.&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;index_uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ivLnMfQKROS7Skb2MTFOew&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;caused_by&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;illegal_argument_exception&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Cannot search on field [tel] since it is not indexed.&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">400</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u62A5\u9519\u53EA\u56E0\u521B\u5EFA\u6620\u5C04\u65F6&quot;tel&quot;\u7684&quot;index&quot;\u4E3Afalse\u3002</p><h3 id="_18-\u5165\u95E8-javaapi-\u73AF\u5883\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_18-\u5165\u95E8-javaapi-\u73AF\u5883\u51C6\u5907" aria-hidden="true">#</a> 18-\u5165\u95E8-JavaAPI-\u73AF\u5883\u51C6\u5907</h3><p>\u65B0\u5EFAMaven\u5DE5\u7A0B\u3002</p><p>\u6DFB\u52A0\u4F9D\u8D56\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- elasticsearch \u7684\u5BA2\u6237\u7AEF --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- elasticsearch \u4F9D\u8D56 2.x \u7684 log4j --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.9.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- junit \u5355\u5143\u6D4B\u8BD5 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HelloElasticsearch</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloElasticsearch</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token comment">// \u521B\u5EFA\u5BA2\u6237\u7AEF\u5BF9\u8C61</span>
		<span class="token class-name">RestHighLevelClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
				<span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//		...</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// \u5173\u95ED\u5BA2\u6237\u7AEF\u8FDE\u63A5</span>
		client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_19-\u5165\u95E8-javaapi-\u7D22\u5F15-\u521B\u5EFA" tabindex="-1"><a class="header-anchor" href="#_19-\u5165\u95E8-javaapi-\u7D22\u5F15-\u521B\u5EFA" aria-hidden="true">#</a> 19-\u5165\u95E8-JavaAPI-\u7D22\u5F15-\u521B\u5EFA</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>create<span class="token punctuation">.</span></span><span class="token class-name">CreateIndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>create<span class="token punctuation">.</span></span><span class="token class-name">CreateIndexResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreateIndex</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u5BA2\u6237\u7AEF\u5BF9\u8C61</span>
        <span class="token class-name">RestHighLevelClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
                <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u521B\u5EFA\u7D22\u5F15 - \u8BF7\u6C42\u5BF9\u8C61</span>
        <span class="token class-name">CreateIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94</span>
        <span class="token class-name">CreateIndexResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>
                <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> acknowledged <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">isAcknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u54CD\u5E94\u72B6\u6001</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u64CD\u4F5C\u72B6\u6001 = &quot;</span> <span class="token operator">+</span> acknowledged<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u5173\u95ED\u5BA2\u6237\u7AEF\u8FDE\u63A5</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u4E8C\u6708 <span class="token number">19</span>, <span class="token number">2024</span> <span class="token number">10</span>:06:27 \u4E0A\u5348 org.elasticsearch.client.RestClient logResponse
\u8B66\u544A: request <span class="token punctuation">[</span>PUT http://localhost:9200/user2?master_timeout<span class="token operator">=</span>30s<span class="token operator">&amp;</span><span class="token assign-left variable">include_type_name</span><span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">timeout</span><span class="token operator">=</span>30s<span class="token punctuation">]</span> returned <span class="token number">1</span> warnings: <span class="token punctuation">[</span><span class="token number">299</span> Elasticsearch-7.6.1-aa751e09be0a5072e8570670309b1f12348f023b <span class="token string">&quot;[types removal] Using include_type_name in create index requests is deprecated. The parameter will be removed in the next major version.&quot;</span><span class="token punctuation">]</span>
\u64CD\u4F5C\u72B6\u6001 <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_20-\u5165\u95E8-javaapi-\u7D22\u5F15-\u67E5\u8BE2-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_20-\u5165\u95E8-javaapi-\u7D22\u5F15-\u67E5\u8BE2-\u5220\u9664" aria-hidden="true">#</a> 20-\u5165\u95E8-JavaAPI-\u7D22\u5F15-\u67E5\u8BE2 &amp; \u5220\u9664</h3><h4 id="\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2" aria-hidden="true">#</a> \u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">GetIndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">GetIndexResponse</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SearchIndex</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u5BA2\u6237\u7AEF\u5BF9\u8C61</span>
        <span class="token class-name">RestHighLevelClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
                <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u67E5\u8BE2\u7D22\u5F15 - \u8BF7\u6C42\u5BF9\u8C61</span>
        <span class="token class-name">GetIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94</span>
        <span class="token class-name">GetIndexResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>
                <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;aliases:&quot;</span><span class="token operator">+</span>response<span class="token punctuation">.</span><span class="token function">getAliases</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;mappings:&quot;</span><span class="token operator">+</span>response<span class="token punctuation">.</span><span class="token function">getMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;settings:&quot;</span><span class="token operator">+</span>response<span class="token punctuation">.</span><span class="token function">getSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>aliases:<span class="token punctuation">{</span>user2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
mappings:<span class="token punctuation">{</span>user2<span class="token operator">=</span>org.elasticsearch.cluster.metadata.MappingMetaData@7d5f4b99<span class="token punctuation">}</span>
settings:<span class="token punctuation">{</span>user2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;index.creation_date&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1708308387854&quot;</span>,<span class="token string">&quot;index.number_of_replicas&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1&quot;</span>,<span class="token string">&quot;index.number_of_shards&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1&quot;</span>,<span class="token string">&quot;index.provided_name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user2&quot;</span>,<span class="token string">&quot;index.uuid&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;vwY4D7ANTYGbUFCQA9sLoA&quot;</span>,<span class="token string">&quot;index.version.created&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;7060199&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5220\u9664-1" tabindex="-1"><a class="header-anchor" href="#\u5220\u9664-1" aria-hidden="true">#</a> \u5220\u9664</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>delete<span class="token punctuation">.</span></span><span class="token class-name">DeleteIndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>support<span class="token punctuation">.</span>master<span class="token punctuation">.</span></span><span class="token class-name">AcknowledgedResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeleteIndex</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">RestHighLevelClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
                <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5220\u9664\u7D22\u5F15 - \u8BF7\u6C42\u5BF9\u8C61</span>
        <span class="token class-name">DeleteIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94</span>
        <span class="token class-name">AcknowledgedResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u64CD\u4F5C\u7ED3\u679C</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u64CD\u4F5C\u7ED3\u679C \uFF1A &quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isAcknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u64CD\u4F5C\u7ED3\u679C \uFF1A <span class="token boolean">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_21-\u5165\u95E8-javaapi-\u6587\u6863-\u65B0\u589E-\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#_21-\u5165\u95E8-javaapi-\u6587\u6863-\u65B0\u589E-\u4FEE\u6539" aria-hidden="true">#</a> 21-\u5165\u95E8-JavaAPI-\u6587\u6863-\u65B0\u589E &amp; \u4FEE\u6539</h3><h4 id="\u91CD\u6784" tabindex="-1"><a class="header-anchor" href="#\u91CD\u6784" aria-hidden="true">#</a> \u91CD\u6784</h4><p>\u4E0A\u6587\u7531\u4E8E\u9891\u7E41\u4F7F\u7528\u4EE5\u4E0B\u8FDE\u63A5Elasticsearch\u548C\u5173\u95ED\u5B83\u7684\u4EE3\u7801\uFF0C\u4E8E\u662F<strong>\u4E2A\u4EBA</strong>\u5BF9\u5B83\u8FDB\u884C\u91CD\u6784\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">RestHighLevelClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
                <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u91CD\u6784\u540E\u7684\u4EE3\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ElasticsearchTask</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token class-name">ElasticsearchTask</span> task<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u5BA2\u6237\u7AEF\u5BF9\u8C61</span>
        <span class="token class-name">RestHighLevelClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
                <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            task<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5173\u95ED\u5BA2\u6237\u7AEF\u8FDE\u63A5</span>
            client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u5982\u679C\u60F3\u8BA9Elasticsearch\u5B8C\u6210\u4E00\u4E9B\u64CD\u4F5C\uFF0C\u5C31\u7F16\u5199\u4E00\u4E2Alambda\u5F0F\u5373\u53EF\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">//do something</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u65B0\u589E" tabindex="-1"><a class="header-anchor" href="#\u65B0\u589E" aria-hidden="true">#</a> \u65B0\u589E</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> sex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span><span class="token class-name">String</span> sex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>hello<span class="token punctuation">.</span></span><span class="token class-name">ConnectElasticsearch</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">IndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">IndexResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>xcontent<span class="token punctuation">.</span></span><span class="token class-name">XContentType</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InsertDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u65B0\u589E\u6587\u6863 - \u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">IndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u8BBE\u7F6E\u7D22\u5F15\u53CA\u552F\u4E00\u6027\u6807\u8BC6</span>
            request<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// \u521B\u5EFA\u6570\u636E\u5BF9\u8C61</span>
            <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setSex</span><span class="token punctuation">(</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> productJson <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6DFB\u52A0\u6587\u6863\u6570\u636E\uFF0C\u6570\u636E\u683C\u5F0F\u4E3A JSON \u683C\u5F0F</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>productJson<span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
            <span class="token class-name">IndexResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6253\u5370\u7ED3\u679C\u4FE1\u606F</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_index:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_id:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_result:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>_index:user
_id:1001
_result:CREATED
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539" aria-hidden="true">#</a> \u4FEE\u6539</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>hello<span class="token punctuation">.</span></span><span class="token class-name">ConnectElasticsearch</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>update<span class="token punctuation">.</span></span><span class="token class-name">UpdateRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>update<span class="token punctuation">.</span></span><span class="token class-name">UpdateResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>xcontent<span class="token punctuation">.</span></span><span class="token class-name">XContentType</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UpdateDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u4FEE\u6539\u6587\u6863 - \u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">UpdateRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UpdateRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u914D\u7F6E\u4FEE\u6539\u53C2\u6570</span>
            request<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u8BBE\u7F6E\u8BF7\u6C42\u4F53\uFF0C\u5BF9\u6570\u636E\u8FDB\u884C\u4FEE\u6539</span>
            request<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
            <span class="token class-name">UpdateResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_index:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_id:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_result:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>_index:user
_id:1001
_result:UPDATE
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_22-\u5165\u95E8-javaapi-\u6587\u6863-\u67E5\u8BE2-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_22-\u5165\u95E8-javaapi-\u6587\u6863-\u67E5\u8BE2-\u5220\u9664" aria-hidden="true">#</a> 22-\u5165\u95E8-JavaAPI-\u6587\u6863-\u67E5\u8BE2 &amp; \u5220\u9664</h3><h4 id="\u67E5\u8BE2-1" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2-1" aria-hidden="true">#</a> \u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>hello<span class="token punctuation">.</span></span><span class="token class-name">ConnectElasticsearch</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>get<span class="token punctuation">.</span></span><span class="token class-name">GetRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>get<span class="token punctuation">.</span></span><span class="token class-name">GetResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//1.\u521B\u5EFA\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">GetRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2.\u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
            <span class="token class-name">GetResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//3.\u6253\u5370\u7ED3\u679C\u4FE1\u606F</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_index:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_type:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_id:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;source:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>_index:user
_type:_doc
_id:1001
source:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span>,<span class="token string">&quot;age&quot;</span>:30<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5220\u9664-2" tabindex="-1"><a class="header-anchor" href="#\u5220\u9664-2" aria-hidden="true">#</a> \u5220\u9664</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>hello<span class="token punctuation">.</span></span><span class="token class-name">ConnectElasticsearch</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>delete<span class="token punctuation">.</span></span><span class="token class-name">DeleteRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>delete<span class="token punctuation">.</span></span><span class="token class-name">DeleteResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeleteDoc</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u521B\u5EFA\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">DeleteRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
            <span class="token class-name">DeleteResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u6253\u5370\u4FE1\u606F</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>DeleteResponse<span class="token punctuation">[</span>index<span class="token operator">=</span>user,type<span class="token operator">=</span>_doc,id<span class="token operator">=</span><span class="token number">1001</span>,version<span class="token operator">=</span><span class="token number">3</span>,result<span class="token operator">=</span>deleted,shards<span class="token operator">=</span>ShardInfo<span class="token punctuation">{</span>total<span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">successful</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">failures</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_23-\u5165\u95E8-javaapi-\u6587\u6863-\u6279\u91CF\u65B0\u589E-\u6279\u91CF\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#_23-\u5165\u95E8-javaapi-\u6587\u6863-\u6279\u91CF\u65B0\u589E-\u6279\u91CF\u5220\u9664" aria-hidden="true">#</a> 23-\u5165\u95E8-JavaAPI-\u6587\u6863-\u6279\u91CF\u65B0\u589E &amp; \u6279\u91CF\u5220\u9664</h3><h4 id="\u6279\u91CF\u65B0\u589E" tabindex="-1"><a class="header-anchor" href="#\u6279\u91CF\u65B0\u589E" aria-hidden="true">#</a> \u6279\u91CF\u65B0\u589E</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>bulk<span class="token punctuation">.</span></span><span class="token class-name">BulkRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>bulk<span class="token punctuation">.</span></span><span class="token class-name">BulkResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">IndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>xcontent<span class="token punctuation">.</span></span><span class="token class-name">XContentType</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BatchInsertDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u521B\u5EFA\u6279\u91CF\u65B0\u589E\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">BulkRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1003&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wangwu1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;40&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1004&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wangwu2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1005&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wangwu3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;50&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1006&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wangwu4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
            <span class="token class-name">BulkResponse</span> responses <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">bulk</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u6253\u5370\u7ED3\u679C\u4FE1\u606F</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> responses<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;items:&quot;</span> <span class="token operator">+</span> responses<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:5ms
items:<span class="token punctuation">[</span>Lorg.elasticsearch.action.bulk.BulkItemResponse<span class="token punctuation">;</span>@d21a74c
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6279\u91CF\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#\u6279\u91CF\u5220\u9664" aria-hidden="true">#</a> \u6279\u91CF\u5220\u9664</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>hello<span class="token punctuation">.</span></span><span class="token class-name">ConnectElasticsearch</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>bulk<span class="token punctuation">.</span></span><span class="token class-name">BulkRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>bulk<span class="token punctuation">.</span></span><span class="token class-name">BulkResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>delete<span class="token punctuation">.</span></span><span class="token class-name">DeleteRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BatchDeleteDoc</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u521B\u5EFA\u6279\u91CF\u5220\u9664\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">BulkRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1003&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1004&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1005&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1006&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
            <span class="token class-name">BulkResponse</span> responses <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">bulk</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u6253\u5370\u7ED3\u679C\u4FE1\u606F</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> responses<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;items:&quot;</span> <span class="token operator">+</span> responses<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:6ms
items:<span class="token punctuation">[</span>Lorg.elasticsearch.action.bulk.BulkItemResponse<span class="token punctuation">;</span>@247bddad
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_24-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u5168\u91CF\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_24-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u5168\u91CF\u67E5\u8BE2" aria-hidden="true">#</a> 24-\u5165\u95E8-JavaAPI-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u5168\u91CF\u67E5\u8BE2</h3><p><strong>\u67E5\u8BE2\u6240\u6709\u7D22\u5F15\u6570\u636E</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u6240\u6709\u6570\u636E</span>
            <span class="token function">setSearchAll</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u6240\u6709\u6570\u636E
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchAll</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchAllQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:1ms
timeout:false
total:6 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;10&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;40&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu2&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu3&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;50&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu4&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_25-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u5206\u9875\u67E5\u8BE2-\u6761\u4EF6\u67E5\u8BE2-\u67E5\u8BE2\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#_25-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u5206\u9875\u67E5\u8BE2-\u6761\u4EF6\u67E5\u8BE2-\u67E5\u8BE2\u6392\u5E8F" aria-hidden="true">#</a> 25-\u5165\u95E8-JavaAPI-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u5206\u9875\u67E5\u8BE2 &amp; \u6761\u4EF6\u67E5\u8BE2 &amp; \u67E5\u8BE2\u6392\u5E8F</h3><h4 id="\u6761\u4EF6\u67E5\u8BE2-1" tabindex="-1"><a class="header-anchor" href="#\u6761\u4EF6\u67E5\u8BE2-1" aria-hidden="true">#</a> \u6761\u4EF6\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6761\u4EF6\u67E5\u8BE2\u6570\u636E</span>
            <span class="token function">setSearchByCondition</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token doc-comment comment">/**
     * \u6761\u4EF6\u67E5\u8BE2\u6570\u636E
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchByCondition</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:1ms
timeout:false
total:1 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5206\u9875\u67E5\u8BE2-1" tabindex="-1"><a class="header-anchor" href="#\u5206\u9875\u67E5\u8BE2-1" aria-hidden="true">#</a> \u5206\u9875\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5206\u9875\u67E5\u8BE2\u6570\u636E</span>
            <span class="token function">setSearchByPage</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5206\u9875\u67E5\u8BE2\u6570\u636E
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchByPage</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u5F53\u524D\u9875\u5176\u5B9E\u7D22\u5F15(\u7B2C\u4E00\u6761\u6570\u636E\u7684\u987A\u5E8F\u53F7)\uFF0C from</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchAllQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u6BCF\u9875\u663E\u793A\u591A\u5C11\u6761 size</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:1ms
timeout:false
total:6 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;10&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u8BE2\u6392\u5E8F-1" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2\u6392\u5E8F-1" aria-hidden="true">#</a> \u67E5\u8BE2\u6392\u5E8F</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6570\u636E\u6392\u5E8F</span>
            <span class="token function">setSearchOrder</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u6570\u636E\u5E76\u6392\u5E8F
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchOrder</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchAllQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u6392\u5E8F</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token class-name">SortOrder</span><span class="token punctuation">.</span>ASC<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:15ms
timeout:false
total:6 hits
MaxScore:NaN
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;10&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu2&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu4&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;40&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu3&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;50&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u8BE2\u8FC7\u6EE4" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2\u8FC7\u6EE4" aria-hidden="true">#</a> \u67E5\u8BE2\u8FC7\u6EE4</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u8FC7\u6EE4\u5B57\u6BB5</span>
            <span class="token function">setSearchFilter</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u6570\u636E\u5E76\u8FC7\u6EE4\u5B57\u6BB5
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchFilter</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchAllQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8FC7\u6EE4\u6389age\u5B57\u6BB5</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> excludes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> includes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">fetchSource</span><span class="token punctuation">(</span>includes<span class="token punctuation">,</span> excludes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:2ms
timeout:false
total:6 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu2&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu3&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu4&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_26-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u7EC4\u5408\u67E5\u8BE2-\u8303\u56F4\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_26-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u7EC4\u5408\u67E5\u8BE2-\u8303\u56F4\u67E5\u8BE2" aria-hidden="true">#</a> 26-\u5165\u95E8-JavaAPI-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u7EC4\u5408\u67E5\u8BE2 &amp; \u8303\u56F4\u67E5\u8BE2</h3><h4 id="\u7EC4\u5408\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u7EC4\u5408\u67E5\u8BE2" aria-hidden="true">#</a> \u7EC4\u5408\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">BoolQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u7EC4\u5408\u67E5\u8BE2</span>
            <span class="token function">setSearchCombination</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u7EC4\u5408\u67E5\u8BE2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchCombination</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BoolQueryBuilder</span> boolQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">boolQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5FC5\u987B\u5305\u542B</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">must</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u4E00\u5B9A\u4E0D\u542B</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">mustNot</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u53EF\u80FD\u5305\u542B</span>
        boolQueryBuilder<span class="token punctuation">.</span><span class="token function">should</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>boolQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:2ms
timeout:false
total:1 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u8303\u56F4\u67E5\u8BE2-1" tabindex="-1"><a class="header-anchor" href="#\u8303\u56F4\u67E5\u8BE2-1" aria-hidden="true">#</a> \u8303\u56F4\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">BoolQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">RangeQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u8303\u56F4\u67E5\u8BE2</span>
            <span class="token function">setSearchRange</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8303\u56F4\u67E5\u8BE2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchRange</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RangeQueryBuilder</span> rangeQuery <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">rangeQuery</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5927\u4E8E\u7B49\u4E8E</span>
        rangeQuery<span class="token punctuation">.</span><span class="token function">gte</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5C0F\u4E8E</span>
        rangeQuery<span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>rangeQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:3ms
timeout:false
total:2 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;40&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_27-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u6A21\u7CCA\u67E5\u8BE2-\u9AD8\u4EAE\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_27-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u6A21\u7CCA\u67E5\u8BE2-\u9AD8\u4EAE\u67E5\u8BE2" aria-hidden="true">#</a> 27-\u5165\u95E8-JavaAPI-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u6A21\u7CCA\u67E5\u8BE2 &amp; \u9AD8\u4EAE\u67E5\u8BE2</h3><h4 id="\u6A21\u7CCA\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u6A21\u7CCA\u67E5\u8BE2" aria-hidden="true">#</a> \u6A21\u7CCA\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>unit<span class="token punctuation">.</span></span><span class="token class-name">Fuzziness</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">BoolQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">RangeQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6A21\u7CCA\u67E5\u8BE2</span>
            <span class="token function">setSearchFuzzy</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token doc-comment comment">/**
     * \u6A21\u7CCA\u67E5\u8BE2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchFuzzy</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Fuzziness.TWO \u4EE3\u8868\u6700\u591A\u6709\u4E24\u4E2A\u5B57\u6BB5\u6A21\u7CCA \u4F8B\u5982\u53EF\u4EE5\u67E5wangwu12,\u5982\u679C\u662FFuzziness.TWO \u5C31\u67E5\u4E0D\u5230wangwu12</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">fuzzyQuery</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fuzziness</span><span class="token punctuation">(</span><span class="token class-name">Fuzziness</span><span class="token punctuation">.</span>TWO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:3ms
timeout:false
total:4 hits
MaxScore:1.2837042
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;40&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu2&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu3&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;50&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu4&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u9AD8\u4EAE\u67E5\u8BE2-1" tabindex="-1"><a class="header-anchor" href="#\u9AD8\u4EAE\u67E5\u8BE2-1" aria-hidden="true">#</a> \u9AD8\u4EAE\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>unit<span class="token punctuation">.</span></span><span class="token class-name">Fuzziness</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">BoolQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">RangeQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">TermsQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHit</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchHits</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>fetch<span class="token punctuation">.</span>subphase<span class="token punctuation">.</span>highlight<span class="token punctuation">.</span></span><span class="token class-name">HighlightBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>fetch<span class="token punctuation">.</span>subphase<span class="token punctuation">.</span>highlight<span class="token punctuation">.</span></span><span class="token class-name">HighlightField</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u9AD8\u4EAE\u67E5\u8BE2</span>
            <span class="token function">setSearchHighlight</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u67E5\u8BE2\u5339\u914D</span>
            <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;took:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;timeout:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">isTimedOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;total:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getTotalHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MaxScore:&quot;</span> <span class="token operator">+</span> hits<span class="token punctuation">.</span><span class="token function">getMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hits========&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> hits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8F93\u51FA\u6BCF\u6761\u67E5\u8BE2\u7684\u7ED3\u679C\u4FE1\u606F</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// \u53EA\u6709\u9AD8\u4EAE\u67E5\u8BE2\u65F6\u52A0\u4E0B\u9762\u4E24\u884C\u4EE3\u7801</span>
                <span class="token comment">//\u6253\u5370\u9AD8\u4EAE\u7ED3\u679C</span>
                <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">HighlightField</span><span class="token punctuation">&gt;</span></span> highlightFields <span class="token operator">=</span> hit<span class="token punctuation">.</span><span class="token function">getHighlightFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>highlightFields<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u9AD8\u4EAE\u67E5\u8BE2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchHighlight</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TermsQueryBuilder</span> termsQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termsQuery</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">HighlightBuilder</span> highlightBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HighlightBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">preTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;font color=&#39;red&#39;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">postTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/font&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        highlightBuilder<span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        sourceBuilder<span class="token punctuation">.</span><span class="token function">highlighter</span><span class="token punctuation">(</span>highlightBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>termsQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>took:1ms
timeout:false
total:1 hits
MaxScore:1.0
<span class="token assign-left variable">hits</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;&gt;</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;10&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span>name<span class="token operator">=</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span>, fragments<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>font <span class="token assign-left variable">color</span><span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token operator">&gt;</span>zhangsan<span class="token operator">&lt;</span>/font<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_28-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u6700\u5927\u503C\u67E5\u8BE2-\u5206\u7EC4\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_28-\u5165\u95E8-javaapi-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u6700\u5927\u503C\u67E5\u8BE2-\u5206\u7EC4\u67E5\u8BE2" aria-hidden="true">#</a> 28-\u5165\u95E8-JavaAPI-\u6587\u6863-\u9AD8\u7EA7\u67E5\u8BE2-\u6700\u5927\u503C\u67E5\u8BE2 &amp; \u5206\u7EC4\u67E5\u8BE2</h3><h4 id="\u6700\u5927\u503C\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u6700\u5927\u503C\u67E5\u8BE2" aria-hidden="true">#</a> \u6700\u5927\u503C\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>unit<span class="token punctuation">.</span></span><span class="token class-name">Fuzziness</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">BoolQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">RangeQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">TermsQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>aggregations<span class="token punctuation">.</span></span><span class="token class-name">AggregationBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>aggregations<span class="token punctuation">.</span></span><span class="token class-name">AggregationBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>fetch<span class="token punctuation">.</span>subphase<span class="token punctuation">.</span>highlight<span class="token punctuation">.</span></span><span class="token class-name">HighlightBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6700\u5927\u503C\u67E5\u8BE2</span>
            <span class="token function">setSearchMax</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6700\u5927\u503C\u67E5\u8BE2\u53EA\u6253\u5370\u8FD9\u4E2A</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u6700\u5927\u503C\u67E5\u8BE2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchMax</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AggregationBuilder</span> aggregationBuilder <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">&quot;maxAge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>aggregationBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">{</span><span class="token string">&quot;took&quot;</span>:1,<span class="token string">&quot;timed_out&quot;</span>:false,<span class="token string">&quot;_shards&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;total&quot;</span>:1,<span class="token string">&quot;successful&quot;</span>:1,<span class="token string">&quot;skipped&quot;</span>:0,<span class="token string">&quot;failed&quot;</span>:0<span class="token punctuation">}</span>,<span class="token string">&quot;hits&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;total&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span>:6,<span class="token string">&quot;relation&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;eq&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;max_score&quot;</span>:1.0,<span class="token string">&quot;hits&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1001&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;10&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1002&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1003&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;40&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1004&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu2&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1005&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu3&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;50&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1006&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu4&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>,<span class="token string">&quot;aggregations&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;max#maxAge&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span>:50.0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="\u5206\u7EC4\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u5206\u7EC4\u67E5\u8BE2" aria-hidden="true">#</a> \u5206\u7EC4\u67E5\u8BE2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>search<span class="token punctuation">.</span></span><span class="token class-name">SearchResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RequestOptions</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>unit<span class="token punctuation">.</span></span><span class="token class-name">Fuzziness</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">BoolQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">RangeQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">TermsQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>aggregations<span class="token punctuation">.</span></span><span class="token class-name">AggregationBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>aggregations<span class="token punctuation">.</span></span><span class="token class-name">AggregationBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>builder<span class="token punctuation">.</span></span><span class="token class-name">SearchSourceBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>fetch<span class="token punctuation">.</span>subphase<span class="token punctuation">.</span>highlight<span class="token punctuation">.</span></span><span class="token class-name">HighlightBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>search<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">SortOrder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryDoc</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConnectElasticsearch</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>client <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u521B\u5EFA\u641C\u7D22\u8BF7\u6C42\u5BF9\u8C61</span>
            <span class="token class-name">SearchRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6784\u5EFA\u67E5\u8BE2\u7684\u8BF7\u6C42\u4F53</span>
            <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5206\u7EC4\u67E5\u8BE2</span>
            <span class="token function">setSearchByGroup</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SearchResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5206\u7EC4\u67E5\u8BE2\u53EA\u6253\u5370\u8FD9\u4E2A</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5206\u7EC4\u67E5\u8BE2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setSearchByGroup</span><span class="token punctuation">(</span><span class="token class-name">SearchSourceBuilder</span> sourceBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AggregationBuilder</span> aggregationBuilder <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">terms</span><span class="token punctuation">(</span><span class="token string">&quot;ageGroup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>aggregationBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u540E\u53F0\u6253\u5370</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">{</span><span class="token string">&quot;took&quot;</span>:7,<span class="token string">&quot;timed_out&quot;</span>:false,<span class="token string">&quot;_shards&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;total&quot;</span>:1,<span class="token string">&quot;successful&quot;</span>:1,<span class="token string">&quot;skipped&quot;</span>:0,<span class="token string">&quot;failed&quot;</span>:0<span class="token punctuation">}</span>,<span class="token string">&quot;hits&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;total&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span>:6,<span class="token string">&quot;relation&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;eq&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;max_score&quot;</span>:1.0,<span class="token string">&quot;hits&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1001&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;zhangsan&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;10&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1002&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;lisi&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;30&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1003&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu1&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;40&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1004&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu2&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1005&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu3&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;50&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;user&quot;</span>,<span class="token string">&quot;_type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;_doc&quot;</span>,<span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;1006&quot;</span>,<span class="token string">&quot;_score&quot;</span>:1.0,<span class="token string">&quot;_source&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;wangwu4&quot;</span>,<span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;20&quot;</span>,<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>,<span class="token string">&quot;aggregations&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;lterms#ageGroup&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;doc_count_error_upper_bound&quot;</span>:0,<span class="token string">&quot;sum_other_doc_count&quot;</span>:0,<span class="token string">&quot;buckets&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;key&quot;</span>:20,<span class="token string">&quot;doc_count&quot;</span>:2<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;key&quot;</span>:10,<span class="token string">&quot;doc_count&quot;</span>:1<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;key&quot;</span>:30,<span class="token string">&quot;doc_count&quot;</span>:1<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;key&quot;</span>:40,<span class="token string">&quot;doc_count&quot;</span>:1<span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;key&quot;</span>:50,<span class="token string">&quot;doc_count&quot;</span>:1<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="\u7B2C3\u7AE0-elasticsearch\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#\u7B2C3\u7AE0-elasticsearch\u73AF\u5883" aria-hidden="true">#</a> \u7B2C3\u7AE0 Elasticsearch\u73AF\u5883</h2><h3 id="_29-\u73AF\u5883-\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#_29-\u73AF\u5883-\u7B80\u4ECB" aria-hidden="true">#</a> 29-\u73AF\u5883-\u7B80\u4ECB</h3><h4 id="\u5355\u673A-\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u5355\u673A-\u96C6\u7FA4" aria-hidden="true">#</a> \u5355\u673A &amp; \u96C6\u7FA4</h4><p>\u5355\u53F0 Elasticsearch \u670D\u52A1\u5668\u63D0\u4F9B\u670D\u52A1\uFF0C\u5F80\u5F80\u90FD\u6709\u6700\u5927\u7684\u8D1F\u8F7D\u80FD\u529B\uFF0C\u8D85\u8FC7\u8FD9\u4E2A\u9608\u503C\uFF0C\u670D\u52A1\u5668 \u6027\u80FD\u5C31\u4F1A\u5927\u5927\u964D\u4F4E\u751A\u81F3\u4E0D\u53EF\u7528\uFF0C\u6240\u4EE5\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u4E00\u822C\u90FD\u662F\u8FD0\u884C\u5728\u6307\u5B9A\u670D\u52A1\u5668\u96C6\u7FA4\u4E2D\u3002 \u9664\u4E86\u8D1F\u8F7D\u80FD\u529B\uFF0C\u5355\u70B9\u670D\u52A1\u5668\u4E5F\u5B58\u5728\u5176\u4ED6\u95EE\u9898\uFF1A</p><ul><li>\u5355\u53F0\u673A\u5668\u5B58\u50A8\u5BB9\u91CF\u6709\u9650</li><li>\u5355\u670D\u52A1\u5668\u5BB9\u6613\u51FA\u73B0\u5355\u70B9\u6545\u969C\uFF0C\u65E0\u6CD5\u5B9E\u73B0\u9AD8\u53EF\u7528</li><li>\u5355\u670D\u52A1\u7684\u5E76\u53D1\u5904\u7406\u80FD\u529B\u6709\u9650</li></ul><p>\u914D\u7F6E\u670D\u52A1\u5668\u96C6\u7FA4\u65F6\uFF0C\u96C6\u7FA4\u4E2D\u8282\u70B9\u6570\u91CF\u6CA1\u6709\u9650\u5236\uFF0C\u5927\u4E8E\u7B49\u4E8E 2 \u4E2A\u8282\u70B9\u5C31\u53EF\u4EE5\u770B\u505A\u662F\u96C6\u7FA4\u4E86\u3002\u4E00\u822C\u51FA\u4E8E\u9AD8\u6027\u80FD\u53CA\u9AD8\u53EF\u7528\u65B9\u9762\u6765\u8003\u8651\u96C6\u7FA4\u4E2D\u8282\u70B9\u6570\u91CF\u90FD\u662F 3 \u4E2A\u4EE5\u4E0A</p><p>\u603B\u4E4B\uFF0C\u96C6\u7FA4\u80FD\u63D0\u9AD8\u6027\u80FD\uFF0C\u589E\u52A0\u5BB9\u9519\u3002</p><h4 id="\u96C6\u7FA4-cluster" tabindex="-1"><a class="header-anchor" href="#\u96C6\u7FA4-cluster" aria-hidden="true">#</a> \u96C6\u7FA4 Cluster</h4><p>\u4E00\u4E2A\u96C6\u7FA4\u5C31\u662F\u7531\u4E00\u4E2A\u6216\u591A\u4E2A\u670D\u52A1\u5668\u8282\u70B9\u7EC4\u7EC7\u5728\u4E00\u8D77\uFF0C\u5171\u540C\u6301\u6709\u6574\u4E2A\u7684\u6570\u636E\uFF0C\u5E76\u4E00\u8D77\u63D0\u4F9B\u7D22\u5F15\u548C\u641C\u7D22\u529F\u80FD\u3002\u4E00\u4E2A Elasticsearch \u96C6\u7FA4\u6709\u4E00\u4E2A\u552F\u4E00\u7684\u540D\u5B57\u6807\u8BC6\uFF0C\u8FD9\u4E2A\u540D\u5B57\u9ED8\u8BA4\u5C31\u662F\u201Delasticsearch\u201D\u3002\u8FD9\u4E2A\u540D\u5B57\u662F\u91CD\u8981\u7684\uFF0C\u56E0\u4E3A\u4E00\u4E2A\u8282\u70B9\u53EA\u80FD\u901A\u8FC7\u6307\u5B9A\u67D0\u4E2A\u96C6\u7FA4\u7684\u540D\u5B57\uFF0C\u6765\u52A0\u5165\u8FD9\u4E2A\u96C6\u7FA4\u3002</p><h4 id="\u8282\u70B9-node" tabindex="-1"><a class="header-anchor" href="#\u8282\u70B9-node" aria-hidden="true">#</a> \u8282\u70B9 Node</h4><p>\u96C6\u7FA4\u4E2D\u5305\u542B\u5F88\u591A\u670D\u52A1\u5668\uFF0C \u4E00\u4E2A\u8282\u70B9\u5C31\u662F\u5176\u4E2D\u7684\u4E00\u4E2A\u670D\u52A1\u5668\u3002 \u4F5C\u4E3A\u96C6\u7FA4\u7684\u4E00\u90E8\u5206\uFF0C\u5B83\u5B58\u50A8\u6570\u636E\uFF0C\u53C2\u4E0E\u96C6\u7FA4\u7684\u7D22\u5F15\u548C\u641C\u7D22\u529F\u80FD\u3002</p><p>\u4E00\u4E2A\u8282\u70B9\u4E5F\u662F\u7531\u4E00\u4E2A\u540D\u5B57\u6765\u6807\u8BC6\u7684\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u8FD9\u4E2A\u540D\u5B57\u662F\u4E00\u4E2A\u968F\u673A\u7684\u6F2B\u5A01\u6F2B\u753B\u89D2\u8272\u7684\u540D\u5B57\uFF0C\u8FD9\u4E2A\u540D\u5B57\u4F1A\u5728\u542F\u52A8\u7684\u65F6\u5019\u8D4B\u4E88\u8282\u70B9\u3002\u8FD9\u4E2A\u540D\u5B57\u5BF9\u4E8E\u7BA1\u7406\u5DE5\u4F5C\u6765\u8BF4\u633A\u91CD\u8981\u7684\uFF0C\u56E0\u4E3A\u5728\u8FD9\u4E2A\u7BA1\u7406\u8FC7\u7A0B\u4E2D\uFF0C\u4F60\u4F1A\u53BB\u786E\u5B9A\u7F51\u7EDC\u4E2D\u7684\u54EA\u4E9B\u670D\u52A1\u5668\u5BF9\u5E94\u4E8E Elasticsearch \u96C6\u7FA4\u4E2D\u7684\u54EA\u4E9B\u8282\u70B9\u3002</p><p>\u4E00\u4E2A\u8282\u70B9\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6E\u96C6\u7FA4\u540D\u79F0\u7684\u65B9\u5F0F\u6765\u52A0\u5165\u4E00\u4E2A\u6307\u5B9A\u7684\u96C6\u7FA4\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6BCF\u4E2A\u8282\u70B9\u90FD\u4F1A\u88AB\u5B89\u6392\u52A0\u5165\u5230\u4E00\u4E2A\u53EB\u505A\u201Celasticsearch\u201D\u7684\u96C6\u7FA4\u4E2D\uFF0C\u8FD9\u610F\u5473\u7740\uFF0C\u5982\u679C\u4F60\u5728\u4F60\u7684\u7F51\u7EDC\u4E2D\u542F\u52A8\u4E86\u82E5\u5E72\u4E2A\u8282\u70B9\uFF0C\u5E76\u5047\u5B9A\u5B83\u4EEC\u80FD\u591F\u76F8\u4E92\u53D1\u73B0\u5F7C\u6B64\uFF0C\u5B83\u4EEC\u5C06\u4F1A\u81EA\u52A8\u5730\u5F62\u6210\u5E76\u52A0\u5165\u5230\u4E00\u4E2A\u53EB\u505A\u201Celasticsearch\u201D\u7684\u96C6\u7FA4\u4E2D\u3002</p><p>\u5728\u4E00\u4E2A\u96C6\u7FA4\u91CC\uFF0C\u53EA\u8981\u4F60\u60F3\uFF0C\u53EF\u4EE5\u62E5\u6709\u4EFB\u610F\u591A\u4E2A\u8282\u70B9\u3002\u800C\u4E14\uFF0C\u5982\u679C\u5F53\u524D\u4F60\u7684\u7F51\u7EDC\u4E2D\u6CA1\u6709\u8FD0<br> \u884C\u4EFB\u4F55 Elasticsearch \u8282\u70B9\uFF0C\u8FD9\u65F6\u542F\u52A8\u4E00\u4E2A\u8282\u70B9\uFF0C\u4F1A\u9ED8\u8BA4\u521B\u5EFA\u5E76\u52A0\u5165\u4E00\u4E2A\u53EB\u505A\u201Celasticsearch\u201D\u7684<br> \u96C6\u7FA4\u3002</p><h3 id="_30-\u73AF\u5883-windows\u96C6\u7FA4\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#_30-\u73AF\u5883-windows\u96C6\u7FA4\u90E8\u7F72" aria-hidden="true">#</a> 30-\u73AF\u5883-Windows\u96C6\u7FA4\u90E8\u7F72</h3><h4 id="\u90E8\u7F72\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u90E8\u7F72\u96C6\u7FA4" aria-hidden="true">#</a> \u90E8\u7F72\u96C6\u7FA4</h4><p>\u4E00\u3001\u521B\u5EFA elasticsearch-cluster \u6587\u4EF6\u5939</p><p>\u521B\u5EFA elasticsearch-7.6.1-cluster \u6587\u4EF6\u5939\uFF0C\u5728\u5185\u90E8\u590D\u5236\u4E09\u4E2A elasticsearch \u670D\u52A1\u3002</p><p><img src="https://qiniu.xinghe.fit/image-20240229164229454.png" alt="image-20240229164229454"></p><p>\u4E8C\u3001\u4FEE\u6539\u96C6\u7FA4\u6587\u4EF6\u76EE\u5F55\u4E2D\u6BCF\u4E2A\u8282\u70B9\u7684 config/elasticsearch.yml \u914D\u7F6E\u6587\u4EF6</p><p><strong>node-1001 \u8282\u70B9</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#\u8282\u70B9 1 \u7684\u914D\u7F6E\u4FE1\u606F\uFF1A</span>
<span class="token comment">#\u96C6\u7FA4\u540D\u79F0\uFF0C\u8282\u70B9\u4E4B\u95F4\u8981\u4FDD\u6301\u4E00\u81F4</span>
<span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>elasticsearch
<span class="token comment">#\u8282\u70B9\u540D\u79F0\uFF0C\u96C6\u7FA4\u5185\u8981\u552F\u4E00</span>
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span><span class="token number">1001</span>
<span class="token key atrule">node.master</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">node.data</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#ip \u5730\u5740</span>
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> localhost
<span class="token comment">#http \u7AEF\u53E3</span>
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">1002</span>
<span class="token comment">#tcp \u76D1\u542C\u7AEF\u53E3</span>
<span class="token key atrule">transport.tcp.port</span><span class="token punctuation">:</span> <span class="token number">9301</span>
<span class="token comment">#discovery.seed_hosts: [&quot;localhost:9301&quot;, &quot;localhost:9302&quot;,&quot;localhost:9303&quot;]</span>
<span class="token comment">#discovery.zen.fd.ping_timeout: 1m</span>
<span class="token comment">#discovery.zen.fd.ping_retries: 5</span>
<span class="token comment">#\u96C6\u7FA4\u5185\u7684\u53EF\u4EE5\u88AB\u9009\u4E3A\u4E3B\u8282\u70B9\u7684\u8282\u70B9\u5217\u8868</span>
<span class="token comment">#cluster.initial_master_nodes: [&quot;node-1&quot;, &quot;node-2&quot;,&quot;node-3&quot;]</span>
<span class="token comment">#\u8DE8\u57DF\u914D\u7F6E</span>
<span class="token comment">#action.destructive_requires_name: true</span>
<span class="token key atrule">http.cors.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">http.cors.allow-origin</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>node-1002 \u8282\u70B9</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#\u8282\u70B9 2 \u7684\u914D\u7F6E\u4FE1\u606F\uFF1A</span>
<span class="token comment">#\u96C6\u7FA4\u540D\u79F0\uFF0C\u8282\u70B9\u4E4B\u95F4\u8981\u4FDD\u6301\u4E00\u81F4</span>
<span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>elasticsearch
<span class="token comment">#\u8282\u70B9\u540D\u79F0\uFF0C\u96C6\u7FA4\u5185\u8981\u552F\u4E00</span>
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span><span class="token number">1002</span>
<span class="token key atrule">node.master</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">node.data</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#ip \u5730\u5740</span>
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> localhost
<span class="token comment">#http \u7AEF\u53E3</span>
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">1003</span>
<span class="token comment">#tcp \u76D1\u542C\u7AEF\u53E3</span>
<span class="token key atrule">transport.tcp.port</span><span class="token punctuation">:</span> <span class="token number">9302</span>
<span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;localhost:9301&quot;</span><span class="token punctuation">]</span>
<span class="token key atrule">discovery.zen.fd.ping_timeout</span><span class="token punctuation">:</span> 1m
<span class="token key atrule">discovery.zen.fd.ping_retries</span><span class="token punctuation">:</span> <span class="token number">5</span>
<span class="token comment">#\u96C6\u7FA4\u5185\u7684\u53EF\u4EE5\u88AB\u9009\u4E3A\u4E3B\u8282\u70B9\u7684\u8282\u70B9\u5217\u8868</span>
<span class="token comment">#cluster.initial_master_nodes: [&quot;node-1&quot;, &quot;node-2&quot;,&quot;node-3&quot;]</span>
<span class="token comment">#\u8DE8\u57DF\u914D\u7F6E</span>
<span class="token comment">#action.destructive_requires_name: true</span>
<span class="token key atrule">http.cors.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">http.cors.allow-origin</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>node-1003 \u8282\u70B9</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#\u8282\u70B9 3 \u7684\u914D\u7F6E\u4FE1\u606F\uFF1A</span>
<span class="token comment">#\u96C6\u7FA4\u540D\u79F0\uFF0C\u8282\u70B9\u4E4B\u95F4\u8981\u4FDD\u6301\u4E00\u81F4</span>
<span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>elasticsearch
<span class="token comment">#\u8282\u70B9\u540D\u79F0\uFF0C\u96C6\u7FA4\u5185\u8981\u552F\u4E00</span>
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span><span class="token number">1003</span>
<span class="token key atrule">node.master</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">node.data</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#ip \u5730\u5740</span>
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> localhost
<span class="token comment">#http \u7AEF\u53E3</span>
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">1004</span>
<span class="token comment">#tcp \u76D1\u542C\u7AEF\u53E3</span>
<span class="token key atrule">transport.tcp.port</span><span class="token punctuation">:</span> <span class="token number">9303</span>
<span class="token comment">#\u5019\u9009\u4E3B\u8282\u70B9\u7684\u5730\u5740\uFF0C\u5728\u5F00\u542F\u670D\u52A1\u540E\u53EF\u4EE5\u88AB\u9009\u4E3A\u4E3B\u8282\u70B9</span>
<span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;localhost:9301&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost:9302&quot;</span><span class="token punctuation">]</span>
<span class="token key atrule">discovery.zen.fd.ping_timeout</span><span class="token punctuation">:</span> 1m
<span class="token key atrule">discovery.zen.fd.ping_retries</span><span class="token punctuation">:</span> <span class="token number">5</span>
<span class="token comment">#\u96C6\u7FA4\u5185\u7684\u53EF\u4EE5\u88AB\u9009\u4E3A\u4E3B\u8282\u70B9\u7684\u8282\u70B9\u5217\u8868</span>
<span class="token comment">#cluster.initial_master_nodes: [&quot;node-1&quot;, &quot;node-2&quot;,&quot;node-3&quot;]</span>
<span class="token comment">#\u8DE8\u57DF\u914D\u7F6E</span>
<span class="token comment">#action.destructive_requires_name: true</span>
<span class="token key atrule">http.cors.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">http.cors.allow-origin</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u3001\u5982\u679C\u6709\u5FC5\u8981\uFF0C\u5220\u9664\u6BCF\u4E2A\u8282\u70B9\u4E2D\u7684 data \u76EE\u5F55\u4E2D\u6240\u6709\u5185\u5BB9\u3002</p><h4 id="\u542F\u52A8\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u96C6\u7FA4" aria-hidden="true">#</a> \u542F\u52A8\u96C6\u7FA4</h4><p>\u5206\u522B\u4F9D\u6B21\u53CC\u51FB\u6267\u884C\u8282\u70B9\u7684bin/elasticsearch.bat, \u542F\u52A8\u8282\u70B9\u670D\u52A1\u5668\uFF08\u53EF\u4EE5\u7F16\u5199\u4E00\u4E2A\u811A\u672C\u542F\u52A8\uFF09\uFF0C\u542F\u52A8\u540E\uFF0C\u4F1A\u81EA\u52A8\u52A0\u5165\u6307\u5B9A\u540D\u79F0\u7684\u96C6\u7FA4\u3002</p><p>\u4E00\u952E\u542F\u52A8\u811A\u672C.bat</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>@echo off 
<span class="token builtin class-name">echo</span> elasticsearch is starting<span class="token punctuation">..</span>.
<span class="token builtin class-name">echo</span> node-1001 is starting<span class="token punctuation">..</span>. 
start D:<span class="token punctuation">\\</span>APP<span class="token punctuation">\\</span>elasticsearch-7.6.1-cluster<span class="token punctuation">\\</span>node-1001<span class="token punctuation">\\</span>bin<span class="token punctuation">\\</span>elasticsearch.bat
start D:<span class="token punctuation">\\</span>APP<span class="token punctuation">\\</span>elasticsearch-7.6.1-cluster<span class="token punctuation">\\</span>node-1002<span class="token punctuation">\\</span>bin<span class="token punctuation">\\</span>elasticsearch.bat
start D:<span class="token punctuation">\\</span>APP<span class="token punctuation">\\</span>elasticsearch-7.6.1-cluster<span class="token punctuation">\\</span>node-1003<span class="token punctuation">\\</span>bin<span class="token punctuation">\\</span>elasticsearch.bat
<span class="token builtin class-name">echo</span> elasticsearch started<span class="token punctuation">..</span>.
pause
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E00\u952E\u6682\u505C\u811A\u672C.bat</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>@echo off
<span class="token builtin class-name">set</span> <span class="token assign-left variable">port1</span><span class="token operator">=</span><span class="token number">9301</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">port2</span><span class="token operator">=</span><span class="token number">9302</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">port3</span><span class="token operator">=</span><span class="token number">9303</span>
<span class="token keyword">for</span> /f <span class="token string">&quot;tokens=1-5&quot;</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;netstat -ano^|findstr &quot;:%port1%&quot;&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
    <span class="token builtin class-name">echo</span> <span class="token function">kill</span> the process %%m <span class="token function">who</span> use the port %port1%
    taskkill /F /pid %%m
<span class="token punctuation">)</span>
<span class="token keyword">for</span> /f <span class="token string">&quot;tokens=1-5&quot;</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;netstat -ano^|findstr &quot;:%port2%&quot;&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
    <span class="token builtin class-name">echo</span> <span class="token function">kill</span> the process %%m <span class="token function">who</span> use the port %port2%
    taskkill /F /pid %%m
<span class="token punctuation">)</span>
<span class="token keyword">for</span> /f <span class="token string">&quot;tokens=1-5&quot;</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;netstat -ano^|findstr &quot;:%port3%&quot;&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
    <span class="token builtin class-name">echo</span> <span class="token function">kill</span> the process %%m <span class="token function">who</span> use the port %port3%
    taskkill /F /pid %%m
<span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> stop elasticsearch cluster success<span class="token punctuation">..</span>.
pause
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u96C6\u7FA4" aria-hidden="true">#</a> \u6D4B\u8BD5\u96C6\u7FA4</h4><p>\u4E00\u3001\u7528Postman\uFF0C\u67E5\u770B\u96C6\u7FA4\u72B6\u6001</p><ol><li><code>GET http://127.0.0.1:1002/_cluster/health</code></li><li><code>GET http://127.0.0.1:1003/_cluster/health</code></li><li><code>GET http://127.0.0.1:1004/_cluster/health</code></li></ol><p>\u8FD4\u56DE\u7ED3\u679C\u7686\u4E3A\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;cluster_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my-elasticsearch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timed_out&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;number_of_nodes&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;number_of_data_nodes&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;active_primary_shards&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;active_shards&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;relocating_shards&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;initializing_shards&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;unassigned_shards&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;delayed_unassigned_shards&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;number_of_pending_tasks&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;number_of_in_flight_fetch&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;task_max_waiting_in_queue_millis&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;active_shards_percent_as_number&quot;</span><span class="token operator">:</span> <span class="token number">100.0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>status\u5B57\u6BB5</strong>\u6307\u793A\u7740\u5F53\u524D\u96C6\u7FA4\u5728\u603B\u4F53\u4E0A\u662F\u5426\u5DE5\u4F5C\u6B63\u5E38\u3002\u5B83\u7684\u4E09\u79CD\u989C\u8272\u542B\u4E49\u5982\u4E0B\uFF1A</p><ol><li>green\uFF1A\u6240\u6709\u7684\u4E3B\u5206\u7247\u548C\u526F\u672C\u5206\u7247\u90FD\u6B63\u5E38\u8FD0\u884C\u3002</li><li>yellow\uFF1A\u6240\u6709\u7684\u4E3B\u5206\u7247\u90FD\u6B63\u5E38\u8FD0\u884C\uFF0C\u4F46\u4E0D\u662F\u6240\u6709\u7684\u526F\u672C\u5206\u7247\u90FD\u6B63\u5E38\u8FD0\u884C\u3002</li><li>red\uFF1A\u6709\u4E3B\u5206\u7247\u6CA1\u80FD\u6B63\u5E38\u8FD0\u884C\u3002</li></ol><p>\u4E8C\u3001\u7528Postman\uFF0C\u5728\u4E00\u8282\u70B9\u589E\u52A0\u7D22\u5F15\uFF0C\u53E6\u4E00\u8282\u70B9\u83B7\u53D6\u7D22\u5F15</p><p>\u5411\u96C6\u7FA4\u4E2D\u7684node-1001\u8282\u70B9\u589E\u52A0\u7D22\u5F15\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:1002/user</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;shards_acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5411\u96C6\u7FA4\u4E2D\u7684node-1003\u8282\u70B9\u83B7\u53D6\u7D22\u5F15\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:1004/user</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;aliases&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;creation_date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1709198425914&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;number_of_shards&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;number_of_replicas&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VA4KagwuS7ONDgxZYDNvgA&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;created&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7060199&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;provided_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u57281003\u521B\u5EFA\u7D22\u5F15\uFF0C\u540C\u6837\u57281001\u4E5F\u80FD\u83B7\u53D6\u7D22\u5F15\u4FE1\u606F\uFF0C\u8FD9\u5C31\u662F\u96C6\u7FA4\u80FD\u529B\u3002</p><h3 id="_31-\u73AF\u5883-linux\u5355\u8282\u70B9\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#_31-\u73AF\u5883-linux\u5355\u8282\u70B9\u90E8\u7F72" aria-hidden="true">#</a> 31-\u73AF\u5883-Linux\u5355\u8282\u70B9\u90E8\u7F72</h3><h4 id="\u8F6F\u4EF6\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u8F6F\u4EF6\u5B89\u88C5" aria-hidden="true">#</a> \u8F6F\u4EF6\u5B89\u88C5</h4><p>\u4E00\u3001\u4E0B\u8F7D\u8F6F\u4EF6</p>`,362),f={href:"https://mirrors.huaweicloud.com/elasticsearch/7.6.1/",target:"_blank",rel:"noopener noreferrer"},_=s("\u4E0B\u8F7DLinux\u7248\u7684Elasticsearch"),x=p(`<p>\u4E8C\u3001\u89E3\u538B\u8F6F\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u89E3\u538B\u7F29</span>
<span class="token function">tar</span> -zxvf elasticsearch-7.6.1-linux-x86_64.tar.gz -C /opt/module
<span class="token comment"># \u6539\u540D</span>
<span class="token function">mv</span> elasticsearch-7.6.1 es
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u3001\u521B\u5EFA\u7528\u6237</p><p>\u56E0\u4E3A\u5B89\u5168\u95EE\u9898\uFF0C Elasticsearch \u4E0D\u5141\u8BB8 root \u7528\u6237\u76F4\u63A5\u8FD0\u884C\uFF0C\u6240\u4EE5\u8981\u521B\u5EFA\u65B0\u7528\u6237\uFF0C\u5728 root \u7528\u6237\u4E2D\u521B\u5EFA\u65B0\u7528\u6237\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">useradd</span> es <span class="token comment">#\u65B0\u589E es \u7528\u6237</span>
<span class="token function">passwd</span> es <span class="token comment">#\u4E3A es \u7528\u6237\u8BBE\u7F6E\u5BC6\u7801</span>
<span class="token function">userdel</span> -r es <span class="token comment">#\u5982\u679C\u9519\u4E86\uFF0C\u53EF\u4EE5\u5220\u9664\u518D\u52A0</span>
<span class="token function">chown</span> -R es:es /opt/module/es <span class="token comment">#\u6587\u4EF6\u5939\u6240\u6709\u8005</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u56DB\u3001\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><p>\u4FEE\u6539/opt/module/es/config/elasticsearch.yml\u6587\u4EF6\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># \u52A0\u5165\u5982\u4E0B\u914D\u7F6E</span>
<span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> elasticsearch
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span><span class="token number">1</span>
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> 0.0.0.0
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">9200</span>
<span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node-1&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539/etc/security/limits.conf</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5728\u6587\u4EF6\u672B\u5C3E\u4E2D\u589E\u52A0\u4E0B\u9762\u5185\u5BB9</span>
<span class="token comment"># \u6BCF\u4E2A\u8FDB\u7A0B\u53EF\u4EE5\u6253\u5F00\u7684\u6587\u4EF6\u6570\u7684\u9650\u5236</span>
es soft nofile <span class="token number">65536</span>
es hard nofile <span class="token number">65536</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539/etc/security/limits.d/20-nproc.conf</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5728\u6587\u4EF6\u672B\u5C3E\u4E2D\u589E\u52A0\u4E0B\u9762\u5185\u5BB9</span>
<span class="token comment"># \u6BCF\u4E2A\u8FDB\u7A0B\u53EF\u4EE5\u6253\u5F00\u7684\u6587\u4EF6\u6570\u7684\u9650\u5236</span>
es soft nofile <span class="token number">65536</span>
es hard nofile <span class="token number">65536</span>
<span class="token comment"># \u64CD\u4F5C\u7CFB\u7EDF\u7EA7\u522B\u5BF9\u6BCF\u4E2A\u7528\u6237\u521B\u5EFA\u7684\u8FDB\u7A0B\u6570\u7684\u9650\u5236</span>
* hard nproc <span class="token number">4096</span>
<span class="token comment"># \u6CE8\uFF1A * \u5E26\u8868 Linux \u6240\u6709\u7528\u6237\u540D\u79F0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539/etc/sysctl.conf</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5728\u6587\u4EF6\u4E2D\u589E\u52A0\u4E0B\u9762\u5185\u5BB9</span>
<span class="token comment"># \u4E00\u4E2A\u8FDB\u7A0B\u53EF\u4EE5\u62E5\u6709\u7684 VMA(\u865A\u62DF\u5185\u5B58\u533A\u57DF)\u7684\u6570\u91CF,\u9ED8\u8BA4\u503C\u4E3A 65536</span>
vm.max_map_count<span class="token operator">=</span><span class="token number">655360</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u91CD\u65B0\u52A0\u8F7D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>sysctl -p
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="\u542F\u52A8\u8F6F\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u8F6F\u4EF6" aria-hidden="true">#</a> \u542F\u52A8\u8F6F\u4EF6</h4><p>\u4F7F\u7528 ES \u7528\u6237\u542F\u52A8</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /opt/module/es/
<span class="token comment">#\u542F\u52A8</span>
bin/elasticsearch
<span class="token comment">#\u540E\u53F0\u542F\u52A8</span>
bin/elasticsearch -d  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u542F\u52A8\u65F6\uFF0C\u4F1A\u52A8\u6001\u751F\u6210\u6587\u4EF6\uFF0C\u5982\u679C\u6587\u4EF6\u6240\u5C5E\u7528\u6237\u4E0D\u5339\u914D\uFF0C\u4F1A\u53D1\u751F\u9519\u8BEF\uFF0C\u9700\u8981\u91CD\u65B0\u8FDB\u884C\u4FEE\u6539\u7528\u6237\u548C\u7528\u6237\u7EC4</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/75e24cd1fbc430577681bb4f8a0d3e2b.png" alt=""></p><p>\u5173\u95ED\u9632\u706B\u5899</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u6682\u65F6\u5173\u95ED\u9632\u706B\u5899</span>
systemctl stop firewalld
<span class="token comment">#\u6C38\u4E45\u5173\u95ED\u9632\u706B\u5899</span>
systemctl <span class="token builtin class-name">enable</span> firewalld.service <span class="token comment">#\u6253\u5F00\u9632\u706B\u5899\u6C38\u4E45\u6027\u751F\u6548\uFF0C\u91CD\u542F\u540E\u4E0D\u4F1A\u590D\u539F</span>
systemctl disable firewalld.service <span class="token comment">#\u5173\u95ED\u9632\u706B\u5899\uFF0C\u6C38\u4E45\u6027\u751F\u6548\uFF0C\u91CD\u542F\u540E\u4E0D\u4F1A\u590D\u539F</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u8F6F\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u8F6F\u4EF6" aria-hidden="true">#</a> \u6D4B\u8BD5\u8F6F\u4EF6</h4><p>\u6D4F\u89C8\u5668\u4E2D\u8F93\u5165\u5730\u5740\uFF1A http://linux1:9200/</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/477065a2cb499a32871549c21e2fc487.png" alt=""></p><h3 id="_32-\u73AF\u5883-linux\u96C6\u7FA4\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#_32-\u73AF\u5883-linux\u96C6\u7FA4\u90E8\u7F72" aria-hidden="true">#</a> 32-\u73AF\u5883-Linux\u96C6\u7FA4\u90E8\u7F72</h3><h4 id="\u8F6F\u4EF6\u5B89\u88C5-1" tabindex="-1"><a class="header-anchor" href="#\u8F6F\u4EF6\u5B89\u88C5-1" aria-hidden="true">#</a> \u8F6F\u4EF6\u5B89\u88C5</h4><p>\u4E00\u3001\u4E0B\u8F7D\u8F6F\u4EF6</p>`,29),w={href:"https://mirrors.huaweicloud.com/elasticsearch/7.6.1/",target:"_blank",rel:"noopener noreferrer"},S=s("\u4E0B\u8F7DLinux\u7248\u7684Elasticsearch"),j=p(`<p>\u4E8C\u3001\u89E3\u538B\u8F6F\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u89E3\u538B\u7F29</span>
<span class="token function">tar</span> -zxvf elasticsearch-7.6.1-linux-x86_64.tar.gz -C /opt/module
<span class="token comment"># \u6539\u540D</span>
<span class="token function">mv</span> elasticsearch-7.6.1 es-cluster
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06\u8F6F\u4EF6\u5206\u53D1\u5230\u5176\u4ED6\u8282\u70B9\uFF1A linux2, linux3</p><p>\u4E09\u3001\u521B\u5EFA\u7528\u6237</p><p>\u56E0\u4E3A\u5B89\u5168\u95EE\u9898\uFF0C Elasticsearch \u4E0D\u5141\u8BB8 root \u7528\u6237\u76F4\u63A5\u8FD0\u884C\uFF0C\u6240\u4EE5\u8981\u521B\u5EFA\u65B0\u7528\u6237\uFF0C\u5728 root \u7528\u6237\u4E2D\u521B\u5EFA\u65B0\u7528\u6237\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">useradd</span> es <span class="token comment">#\u65B0\u589E es \u7528\u6237</span>
<span class="token function">passwd</span> es <span class="token comment">#\u4E3A es \u7528\u6237\u8BBE\u7F6E\u5BC6\u7801</span>
<span class="token function">userdel</span> -r es <span class="token comment">#\u5982\u679C\u9519\u4E86\uFF0C\u53EF\u4EE5\u5220\u9664\u518D\u52A0</span>
<span class="token function">chown</span> -R es:es /opt/module/es <span class="token comment">#\u6587\u4EF6\u5939\u6240\u6709\u8005</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u56DB\u3001\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><p>\u4FEE\u6539/opt/module/es/config/elasticsearch.yml \u6587\u4EF6\uFF0C\u5206\u53D1\u6587\u4EF6\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># \u52A0\u5165\u5982\u4E0B\u914D\u7F6E</span>
<span class="token comment">#\u96C6\u7FA4\u540D\u79F0</span>
<span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> cluster<span class="token punctuation">-</span>es
<span class="token comment">#\u8282\u70B9\u540D\u79F0\uFF0C \u6BCF\u4E2A\u8282\u70B9\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D</span>
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span><span class="token number">1</span>
<span class="token comment">#ip \u5730\u5740\uFF0C \u6BCF\u4E2A\u8282\u70B9\u7684\u5730\u5740\u4E0D\u80FD\u91CD\u590D</span>
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> linux1
<span class="token comment">#\u662F\u4E0D\u662F\u6709\u8D44\u683C\u4E3B\u8282\u70B9</span>
<span class="token key atrule">node.master</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">node.data</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">9200</span>
<span class="token comment"># head \u63D2\u4EF6\u9700\u8981\u8FD9\u6253\u5F00\u8FD9\u4E24\u4E2A\u914D\u7F6E</span>
<span class="token key atrule">http.cors.allow-origin</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>
<span class="token key atrule">http.cors.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">http.max_content_length</span><span class="token punctuation">:</span> 200mb
<span class="token comment">#es7.x \u4E4B\u540E\u65B0\u589E\u7684\u914D\u7F6E\uFF0C\u521D\u59CB\u5316\u4E00\u4E2A\u65B0\u7684\u96C6\u7FA4\u65F6\u9700\u8981\u6B64\u914D\u7F6E\u6765\u9009\u4E3E master</span>
<span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node-1&quot;</span><span class="token punctuation">]</span>
<span class="token comment">#es7.x \u4E4B\u540E\u65B0\u589E\u7684\u914D\u7F6E\uFF0C\u8282\u70B9\u53D1\u73B0</span>
<span class="token key atrule">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;linux1:9300&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;linux2:9300&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;linux3:9300&quot;</span><span class="token punctuation">]</span>
<span class="token key atrule">gateway.recover_after_nodes</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token key atrule">network.tcp.keep_alive</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">network.tcp.no_delay</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">transport.tcp.compress</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#\u96C6\u7FA4\u5185\u540C\u65F6\u542F\u52A8\u7684\u6570\u636E\u4EFB\u52A1\u4E2A\u6570\uFF0C\u9ED8\u8BA4\u662F 2 \u4E2A</span>
<span class="token key atrule">cluster.routing.allocation.cluster_concurrent_rebalance</span><span class="token punctuation">:</span> <span class="token number">16</span>
<span class="token comment">#\u6DFB\u52A0\u6216\u5220\u9664\u8282\u70B9\u53CA\u8D1F\u8F7D\u5747\u8861\u65F6\u5E76\u53D1\u6062\u590D\u7684\u7EBF\u7A0B\u4E2A\u6570\uFF0C\u9ED8\u8BA4 4 \u4E2A</span>
<span class="token key atrule">cluster.routing.allocation.node_concurrent_recoveries</span><span class="token punctuation">:</span> <span class="token number">16</span>
<span class="token comment">#\u521D\u59CB\u5316\u6570\u636E\u6062\u590D\u65F6\uFF0C\u5E76\u53D1\u6062\u590D\u7EBF\u7A0B\u7684\u4E2A\u6570\uFF0C\u9ED8\u8BA4 4 \u4E2A</span>
<span class="token key atrule">cluster.routing.allocation.node_initial_primaries_recoveries</span><span class="token punctuation">:</span> <span class="token number">16</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539/etc/security/limits.conf \uFF0C\u5206\u53D1\u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5728\u6587\u4EF6\u672B\u5C3E\u4E2D\u589E\u52A0\u4E0B\u9762\u5185\u5BB9</span>
es soft nofile <span class="token number">65536</span>
es hard nofile <span class="token number">65536</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539/etc/security/limits.d/20-nproc.conf\uFF0C\u5206\u53D1\u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5728\u6587\u4EF6\u672B\u5C3E\u4E2D\u589E\u52A0\u4E0B\u9762\u5185\u5BB9</span>
es soft nofile <span class="token number">65536</span>
es hard nofile <span class="token number">65536</span>
<span class="token punctuation">\\</span>* hard nproc <span class="token number">4096</span>
<span class="token punctuation">\\</span># \u6CE8\uFF1A * \u5E26\u8868 Linux \u6240\u6709\u7528\u6237\u540D\u79F0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539/etc/sysctl.conf</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5728\u6587\u4EF6\u4E2D\u589E\u52A0\u4E0B\u9762\u5185\u5BB9</span>
vm.max_map_count<span class="token operator">=</span><span class="token number">655360</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u91CD\u65B0\u52A0\u8F7D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>sysctl -p
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="\u542F\u52A8\u8F6F\u4EF6-1" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u8F6F\u4EF6-1" aria-hidden="true">#</a> \u542F\u52A8\u8F6F\u4EF6</h4><p>\u5206\u522B\u5728\u4E0D\u540C\u8282\u70B9\u4E0A\u542F\u52A8 ES \u8F6F\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /opt/module/es-cluster
<span class="token comment">#\u542F\u52A8</span>
bin/elasticsearch
<span class="token comment">#\u540E\u53F0\u542F\u52A8</span>
bin/elasticsearch -d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u96C6\u7FA4-1" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u96C6\u7FA4-1" aria-hidden="true">#</a> \u6D4B\u8BD5\u96C6\u7FA4</h4><p><img src="https://qiniu.xinghe.fit/Elasticsearch/0412e37cb5249d1ff0e813ee87f49a50.png" alt=""></p><h2 id="\u7B2C4\u7AE0-elasticsearch\u8FDB\u9636" tabindex="-1"><a class="header-anchor" href="#\u7B2C4\u7AE0-elasticsearch\u8FDB\u9636" aria-hidden="true">#</a> \u7B2C4\u7AE0 Elasticsearch\u8FDB\u9636</h2><h3 id="_33-\u8FDB\u9636-\u6838\u5FC3\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#_33-\u8FDB\u9636-\u6838\u5FC3\u6982\u5FF5" aria-hidden="true">#</a> 33-\u8FDB\u9636-\u6838\u5FC3\u6982\u5FF5</h3><p><img src="https://qiniu.xinghe.fit/Elasticsearch/146a779da01f53e7f7a8d53132d3c7cf.png" alt=""></p><h4 id="\u7D22\u5F15index" tabindex="-1"><a class="header-anchor" href="#\u7D22\u5F15index" aria-hidden="true">#</a> \u7D22\u5F15Index</h4><p>\u4E00\u4E2A\u7D22\u5F15\u5C31\u662F\u4E00\u4E2A\u62E5\u6709\u51E0\u5206\u76F8\u4F3C\u7279\u5F81\u7684\u6587\u6863\u7684\u96C6\u5408\u3002\u6BD4\u5982\u8BF4\uFF0C\u4F60\u53EF\u4EE5\u6709\u4E00\u4E2A\u5BA2\u6237\u6570\u636E\u7684\u7D22\u5F15\uFF0C\u53E6\u4E00\u4E2A\u4EA7\u54C1\u76EE\u5F55\u7684\u7D22\u5F15\uFF0C\u8FD8\u6709\u4E00\u4E2A\u8BA2\u5355\u6570\u636E\u7684\u7D22\u5F15\u3002\u4E00\u4E2A\u7D22\u5F15\u7531\u4E00\u4E2A\u540D\u5B57\u6765\u6807\u8BC6\uFF08\u5FC5\u987B\u5168\u90E8\u662F\u5C0F\u5199\u5B57\u6BCD\uFF09\uFF0C\u5E76\u4E14\u5F53\u6211\u4EEC\u8981\u5BF9\u8FD9\u4E2A\u7D22\u5F15\u4E2D\u7684\u6587\u6863\u8FDB\u884C\u7D22\u5F15\u3001\u641C\u7D22\u3001\u66F4\u65B0\u548C\u5220\u9664\uFF08CRUD\uFF09\u7684\u65F6\u5019\uFF0C\u90FD\u8981\u4F7F\u7528\u5230\u8FD9\u4E2A\u540D\u5B57\u3002\u5728\u4E00\u4E2A\u96C6\u7FA4\u4E2D\uFF0C\u53EF\u4EE5\u5B9A\u4E49\u4EFB\u610F\u591A\u7684\u7D22\u5F15\u3002</p><p>\u80FD\u641C\u7D22\u7684\u6570\u636E\u5FC5\u987B\u7D22\u5F15\uFF0C\u8FD9\u6837\u7684\u597D\u5904\u662F\u53EF\u4EE5\u63D0\u9AD8\u67E5\u8BE2\u901F\u5EA6\uFF0C\u6BD4\u5982\uFF1A\u65B0\u534E\u5B57\u5178\u524D\u9762\u7684\u76EE\u5F55\u5C31\u662F\u7D22\u5F15\u7684\u610F\u601D\uFF0C\u76EE\u5F55\u53EF\u4EE5\u63D0\u9AD8\u67E5\u8BE2\u901F\u5EA6\u3002</p><p><strong>Elasticsearch \u7D22\u5F15\u7684\u7CBE\u9AD3\uFF1A\u4E00\u5207\u8BBE\u8BA1\u90FD\u662F\u4E3A\u4E86\u63D0\u9AD8\u641C\u7D22\u7684\u6027\u80FD\u3002</strong></p><h4 id="\u7C7B\u578Btype" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u578Btype" aria-hidden="true">#</a> \u7C7B\u578BType</h4><p>\u5728\u4E00\u4E2A\u7D22\u5F15\u4E2D\uFF0C\u4F60\u53EF\u4EE5\u5B9A\u4E49\u4E00\u79CD\u6216\u591A\u79CD\u7C7B\u578B\u3002</p><p>\u4E00\u4E2A\u7C7B\u578B\u662F\u4F60\u7684\u7D22\u5F15\u7684\u4E00\u4E2A\u903B\u8F91\u4E0A\u7684\u5206\u7C7B/\u5206\u533A\uFF0C\u5176\u8BED\u4E49\u5B8C\u5168\u7531\u4F60\u6765\u5B9A\u3002\u901A\u5E38\uFF0C\u4F1A\u4E3A\u5177\u6709\u4E00\u7EC4\u5171\u540C\u5B57\u6BB5\u7684\u6587\u6863\u5B9A\u4E49\u4E00\u4E2A\u7C7B\u578B\u3002\u4E0D\u540C\u7684\u7248\u672C\uFF0C\u7C7B\u578B\u53D1\u751F\u4E86\u4E0D\u540C\u7684\u53D8\u5316\u3002</p><table><thead><tr><th style="text-align:center;">\u7248\u672C</th><th style="text-align:center;">Type</th></tr></thead><tbody><tr><td style="text-align:center;">5.x</td><td style="text-align:center;">\u652F\u6301\u591A\u79CD type</td></tr><tr><td style="text-align:center;">6.x</td><td style="text-align:center;">\u53EA\u80FD\u6709\u4E00\u79CD type</td></tr><tr><td style="text-align:center;">7.x</td><td style="text-align:center;">\u9ED8\u8BA4\u4E0D\u518D\u652F\u6301\u81EA\u5B9A\u4E49\u7D22\u5F15\u7C7B\u578B\uFF08\u9ED8\u8BA4\u7C7B\u578B\u4E3A\uFF1A _doc\uFF09</td></tr></tbody></table><h4 id="\u6587\u6863document" tabindex="-1"><a class="header-anchor" href="#\u6587\u6863document" aria-hidden="true">#</a> \u6587\u6863Document</h4><p>\u4E00\u4E2A\u6587\u6863\u662F\u4E00\u4E2A\u53EF\u88AB\u7D22\u5F15\u7684\u57FA\u7840\u4FE1\u606F\u5355\u5143\uFF0C\u4E5F\u5C31\u662F\u4E00\u6761\u6570\u636E\u3002</p><p>\u6BD4\u5982\uFF1A\u4F60\u53EF\u4EE5\u62E5\u6709\u67D0\u4E00\u4E2A\u5BA2\u6237\u7684\u6587\u6863\uFF0C\u67D0\u4E00\u4E2A\u4EA7\u54C1\u7684\u4E00\u4E2A\u6587\u6863\uFF0C\u5F53\u7136\uFF0C\u4E5F\u53EF\u4EE5\u62E5\u6709\u67D0\u4E2A\u8BA2\u5355\u7684\u4E00\u4E2A\u6587\u6863\u3002\u6587\u6863\u4EE5 JSON\uFF08Javascript Object Notation\uFF09\u683C\u5F0F\u6765\u8868\u793A\uFF0C\u800C JSON \u662F\u4E00\u4E2A\u5230\u5904\u5B58\u5728\u7684\u4E92\u8054\u7F51\u6570\u636E\u4EA4\u4E92\u683C\u5F0F\u3002</p><p>\u5728\u4E00\u4E2A index/type \u91CC\u9762\uFF0C\u4F60\u53EF\u4EE5\u5B58\u50A8\u4EFB\u610F\u591A\u7684\u6587\u6863\u3002</p><h4 id="\u5B57\u6BB5field" tabindex="-1"><a class="header-anchor" href="#\u5B57\u6BB5field" aria-hidden="true">#</a> \u5B57\u6BB5Field</h4><p>\u76F8\u5F53\u4E8E\u662F\u6570\u636E\u8868\u7684\u5B57\u6BB5\uFF0C\u5BF9\u6587\u6863\u6570\u636E\u6839\u636E\u4E0D\u540C\u5C5E\u6027\u8FDB\u884C\u7684\u5206\u7C7B\u6807\u8BC6\u3002</p><h4 id="\u6620\u5C04mapping" tabindex="-1"><a class="header-anchor" href="#\u6620\u5C04mapping" aria-hidden="true">#</a> \u6620\u5C04Mapping</h4><p>mapping \u662F\u5904\u7406\u6570\u636E\u7684\u65B9\u5F0F\u548C\u89C4\u5219\u65B9\u9762\u505A\u4E00\u4E9B\u9650\u5236\uFF0C\u5982\uFF1A\u67D0\u4E2A\u5B57\u6BB5\u7684\u6570\u636E\u7C7B\u578B\u3001\u9ED8\u8BA4\u503C\u3001\u5206\u6790\u5668\u3001\u662F\u5426\u88AB\u7D22\u5F15\u7B49\u7B49\u3002\u8FD9\u4E9B\u90FD\u662F\u6620\u5C04\u91CC\u9762\u53EF\u4EE5\u8BBE\u7F6E\u7684\uFF0C\u5176\u5B83\u5C31\u662F\u5904\u7406 ES \u91CC\u9762\u6570\u636E\u7684\u4E00\u4E9B\u4F7F\u7528\u89C4\u5219\u8BBE\u7F6E\u4E5F\u53EB\u505A\u6620\u5C04\uFF0C\u6309\u7740\u6700\u4F18\u89C4\u5219\u5904\u7406\u6570\u636E\u5BF9\u6027\u80FD\u63D0\u9AD8\u5F88\u5927\uFF0C\u56E0\u6B64\u624D\u9700\u8981\u5EFA\u7ACB\u6620\u5C04\uFF0C\u5E76\u4E14\u9700\u8981\u601D\u8003\u5982\u4F55\u5EFA\u7ACB\u6620\u5C04\u624D\u80FD\u5BF9\u6027\u80FD\u66F4\u597D\u3002</p><h4 id="\u5206\u7247shards" tabindex="-1"><a class="header-anchor" href="#\u5206\u7247shards" aria-hidden="true">#</a> \u5206\u7247Shards</h4><p>\u4E00\u4E2A\u7D22\u5F15\u53EF\u4EE5\u5B58\u50A8\u8D85\u51FA\u5355\u4E2A\u8282\u70B9\u786C\u4EF6\u9650\u5236\u7684\u5927\u91CF\u6570\u636E\u3002\u6BD4\u5982\uFF0C\u4E00\u4E2A\u5177\u6709 10 \u4EBF\u6587\u6863\u6570\u636E\u7684\u7D22\u5F15\u5360\u636E 1TB \u7684\u78C1\u76D8\u7A7A\u95F4\uFF0C\u800C\u4EFB\u4E00\u8282\u70B9\u90FD\u53EF\u80FD\u6CA1\u6709\u8FD9\u6837\u5927\u7684\u78C1\u76D8\u7A7A\u95F4\u3002 \u6216\u8005\u5355\u4E2A\u8282\u70B9\u5904\u7406\u641C\u7D22\u8BF7\u6C42\uFF0C\u54CD\u5E94\u592A\u6162\u3002\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0CElasticsearch \u63D0\u4F9B\u4E86\u5C06\u7D22\u5F15\u5212\u5206\u6210\u591A\u4EFD\u7684\u80FD\u529B\uFF0C\u6BCF\u4E00\u4EFD\u5C31\u79F0\u4E4B\u4E3A\u5206\u7247\u3002\u5F53\u4F60\u521B\u5EFA\u4E00\u4E2A\u7D22\u5F15\u7684\u65F6\u5019\uFF0C\u4F60\u53EF\u4EE5\u6307\u5B9A\u4F60\u60F3\u8981\u7684\u5206\u7247\u7684\u6570\u91CF\u3002\u6BCF\u4E2A\u5206\u7247\u672C\u8EAB\u4E5F\u662F\u4E00\u4E2A\u529F\u80FD\u5B8C\u5584\u5E76\u4E14\u72EC\u7ACB\u7684\u201C\u7D22\u5F15\u201D\uFF0C\u8FD9\u4E2A\u201C\u7D22\u5F15\u201D\u53EF\u4EE5\u88AB\u653E\u7F6E\u5230\u96C6\u7FA4\u4E2D\u7684\u4EFB\u4F55\u8282\u70B9\u4E0A\u3002</p><p>\u5206\u7247\u5F88\u91CD\u8981\uFF0C\u4E3B\u8981\u6709\u4E24\u65B9\u9762\u7684\u539F\u56E0\uFF1A</p><ol><li>\u5141\u8BB8\u4F60\u6C34\u5E73\u5206\u5272 / \u6269\u5C55\u4F60\u7684\u5185\u5BB9\u5BB9\u91CF\u3002</li><li>\u5141\u8BB8\u4F60\u5728\u5206\u7247\u4E4B\u4E0A\u8FDB\u884C\u5206\u5E03\u5F0F\u7684\u3001\u5E76\u884C\u7684\u64CD\u4F5C\uFF0C\u8FDB\u800C\u63D0\u9AD8\u6027\u80FD/\u541E\u5410\u91CF\u3002</li></ol><p>\u81F3\u4E8E\u4E00\u4E2A\u5206\u7247\u600E\u6837\u5206\u5E03\uFF0C\u5B83\u7684\u6587\u6863\u600E\u6837\u805A\u5408\u548C\u641C\u7D22\u8BF7\u6C42\uFF0C\u662F\u5B8C\u5168\u7531 Elasticsearch \u7BA1\u7406\u7684\uFF0C\u5BF9\u4E8E\u4F5C\u4E3A\u7528\u6237\u7684\u4F60\u6765\u8BF4\uFF0C\u8FD9\u4E9B\u90FD\u662F\u900F\u660E\u7684\uFF0C\u65E0\u9700\u8FC7\u5206\u5173\u5FC3\u3002</p><p>\u88AB\u6DF7\u6DC6\u7684\u6982\u5FF5\u662F\uFF0C\u4E00\u4E2A Lucene \u7D22\u5F15\u6211\u4EEC\u5728 Elasticsearch \u79F0\u4F5C \u5206\u7247 \u3002 \u4E00\u4E2AElasticsearch \u7D22\u5F15\u662F\u5206\u7247\u7684\u96C6\u5408\u3002 \u5F53 Elasticsearch \u5728\u7D22\u5F15\u4E2D\u641C\u7D22\u7684\u65F6\u5019\uFF0C\u4ED6\u53D1\u9001\u67E5\u8BE2\u5230\u6BCF\u4E00\u4E2A\u5C5E\u4E8E\u7D22\u5F15\u7684\u5206\u7247\uFF08Lucene \u7D22\u5F15\uFF09\uFF0C\u7136\u540E\u5408\u5E76\u6BCF\u4E2A\u5206\u7247\u7684\u7ED3\u679C\u5230\u4E00\u4E2A\u5168\u5C40\u7684\u7ED3\u679C\u96C6\u3002</p><p>Lucene \u662F Apache \u8F6F\u4EF6\u57FA\u91D1\u4F1A Jakarta \u9879\u76EE\u7EC4\u7684\u4E00\u4E2A\u5B50\u9879\u76EE\uFF0C\u63D0\u4F9B\u4E86\u4E00\u4E2A\u7B80\u5355\u5374\u5F3A\u5927\u7684\u5E94\u7528\u7A0B\u5F0F\u63A5\u53E3\uFF0C\u80FD\u591F\u505A\u5168\u6587\u7D22\u5F15\u548C\u641C\u5BFB\u3002\u5728 Java \u5F00\u53D1\u73AF\u5883\u91CC Lucene \u662F\u4E00\u4E2A\u6210\u719F\u7684\u514D\u8D39\u5F00\u6E90\u5DE5\u5177\u3002\u5C31\u5176\u672C\u8EAB\u800C\u8A00\uFF0CLucene \u662F\u5F53\u524D\u4EE5\u53CA\u6700\u8FD1\u51E0\u5E74\u6700\u53D7\u6B22\u8FCE\u7684\u514D\u8D39 Java \u4FE1\u606F\u68C0\u7D22\u7A0B\u5E8F\u5E93\u3002\u4F46 Lucene \u53EA\u662F\u4E00\u4E2A\u63D0\u4F9B\u5168\u6587\u641C\u7D22\u529F\u80FD\u7C7B\u5E93\u7684\u6838\u5FC3\u5DE5\u5177\u5305\uFF0C\u800C\u771F\u6B63\u4F7F\u7528\u5B83\u8FD8\u9700\u8981\u4E00\u4E2A\u5B8C\u5584\u7684\u670D\u52A1\u6846\u67B6\u642D\u5EFA\u8D77\u6765\u8FDB\u884C\u5E94\u7528\u3002</p><p>\u76EE\u524D\u5E02\u9762\u4E0A\u6D41\u884C\u7684\u641C\u7D22\u5F15\u64CE\u8F6F\u4EF6\uFF0C\u4E3B\u6D41\u7684\u5C31\u4E24\u6B3E\uFF1A Elasticsearch \u548C Solr,\u8FD9\u4E24\u6B3E\u90FD\u662F\u57FA\u4E8E Lucene \u642D\u5EFA\u7684\uFF0C\u53EF\u4EE5\u72EC\u7ACB\u90E8\u7F72\u542F\u52A8\u7684\u641C\u7D22\u5F15\u64CE\u670D\u52A1\u8F6F\u4EF6\u3002\u7531\u4E8E\u5185\u6838\u76F8\u540C\uFF0C\u6240\u4EE5\u4E24\u8005\u9664\u4E86\u670D\u52A1\u5668\u5B89\u88C5\u3001\u90E8\u7F72\u3001\u7BA1\u7406\u3001\u96C6\u7FA4\u4EE5\u5916\uFF0C\u5BF9\u4E8E\u6570\u636E\u7684\u64CD\u4F5C \u4FEE\u6539\u3001\u6DFB\u52A0\u3001\u4FDD\u5B58\u3001\u67E5\u8BE2\u7B49\u7B49\u90FD\u5341\u5206\u7C7B\u4F3C\u3002</p><h4 id="\u526F\u672Creplicas" tabindex="-1"><a class="header-anchor" href="#\u526F\u672Creplicas" aria-hidden="true">#</a> \u526F\u672CReplicas</h4><p>\u5728\u4E00\u4E2A\u7F51\u7EDC / \u4E91\u7684\u73AF\u5883\u91CC\uFF0C\u5931\u8D25\u968F\u65F6\u90FD\u53EF\u80FD\u53D1\u751F\uFF0C\u5728\u67D0\u4E2A\u5206\u7247/\u8282\u70B9\u4E0D\u77E5\u600E\u4E48\u7684\u5C31\u5904\u4E8E\u79BB\u7EBF\u72B6\u6001\uFF0C\u6216\u8005\u7531\u4E8E\u4EFB\u4F55\u539F\u56E0\u6D88\u5931\u4E86\uFF0C\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u6709\u4E00\u4E2A\u6545\u969C\u8F6C\u79FB\u673A\u5236\u662F\u975E\u5E38\u6709\u7528\u5E76\u4E14\u662F\u5F3A\u70C8\u63A8\u8350\u7684\u3002\u4E3A\u6B64\u76EE\u7684\uFF0C Elasticsearch \u5141\u8BB8\u4F60\u521B\u5EFA\u5206\u7247\u7684\u4E00\u4EFD\u6216\u591A\u4EFD\u62F7\u8D1D\uFF0C\u8FD9\u4E9B\u62F7\u8D1D\u53EB\u505A\u590D\u5236\u5206\u7247(\u526F\u672C)\u3002</p><p>\u590D\u5236\u5206\u7247\u4E4B\u6240\u4EE5\u91CD\u8981\uFF0C\u6709\u4E24\u4E2A\u4E3B\u8981\u539F\u56E0\uFF1A</p><ul><li>\u5728\u5206\u7247/\u8282\u70B9\u5931\u8D25\u7684\u60C5\u51B5\u4E0B\uFF0C\u63D0\u4F9B\u4E86\u9AD8\u53EF\u7528\u6027\u3002\u56E0\u4E3A\u8FD9\u4E2A\u539F\u56E0\uFF0C\u6CE8\u610F\u5230\u590D\u5236\u5206\u7247\u4ECE\u4E0D\u4E0E\u539F/\u4E3B\u8981\uFF08original/primary\uFF09\u5206\u7247\u7F6E\u4E8E\u540C\u4E00\u8282\u70B9\u4E0A\u662F\u975E\u5E38\u91CD\u8981\u7684\u3002</li><li>\u6269\u5C55\u4F60\u7684\u641C\u7D22\u91CF/\u541E\u5410\u91CF\uFF0C\u56E0\u4E3A\u641C\u7D22\u53EF\u4EE5\u5728\u6240\u6709\u7684\u526F\u672C\u4E0A\u5E76\u884C\u8FD0\u884C\u3002</li></ul><p>\u603B\u4E4B\uFF0C\u6BCF\u4E2A\u7D22\u5F15\u53EF\u4EE5\u88AB\u5206\u6210\u591A\u4E2A\u5206\u7247\u3002\u4E00\u4E2A\u7D22\u5F15\u4E5F\u53EF\u4EE5\u88AB\u590D\u5236 0 \u6B21\uFF08\u610F\u601D\u662F\u6CA1\u6709\u590D\u5236\uFF09\u6216\u591A\u6B21\u3002\u4E00\u65E6\u590D\u5236\u4E86\uFF0C\u6BCF\u4E2A\u7D22\u5F15\u5C31\u6709\u4E86\u4E3B\u5206\u7247\uFF08\u4F5C\u4E3A\u590D\u5236\u6E90\u7684\u539F\u6765\u7684\u5206\u7247\uFF09\u548C\u590D\u5236\u5206\u7247\uFF08\u4E3B\u5206\u7247\u7684\u62F7\u8D1D\uFF09\u4E4B\u522B\u3002</p><p>\u5206\u7247\u548C\u590D\u5236\u7684\u6570\u91CF\u53EF\u4EE5\u5728\u7D22\u5F15\u521B\u5EFA\u7684\u65F6\u5019\u6307\u5B9A\u3002\u5728\u7D22\u5F15\u521B\u5EFA\u4E4B\u540E\uFF0C\u4F60\u53EF\u4EE5\u5728\u4EFB\u4F55\u65F6\u5019\u52A8\u6001\u5730\u6539\u53D8\u590D\u5236\u7684\u6570\u91CF\uFF0C\u4F46\u662F\u4F60\u4E8B\u540E\u4E0D\u80FD\u6539\u53D8\u5206\u7247\u7684\u6570\u91CF\u3002</p><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CElasticsearch \u4E2D\u7684\u6BCF\u4E2A\u7D22\u5F15\u88AB\u5206\u7247 1 \u4E2A\u4E3B\u5206\u7247\u548C 1 \u4E2A\u590D\u5236\uFF0C\u8FD9\u610F\u5473\u7740\uFF0C\u5982\u679C\u4F60\u7684\u96C6\u7FA4\u4E2D\u81F3\u5C11\u6709\u4E24\u4E2A\u8282\u70B9\uFF0C\u4F60\u7684\u7D22\u5F15\u5C06\u4F1A\u6709 1 \u4E2A\u4E3B\u5206\u7247\u548C\u53E6\u5916 1 \u4E2A\u590D\u5236\u5206\u7247\uFF081 \u4E2A\u5B8C\u5168\u62F7\u8D1D\uFF09\uFF0C\u8FD9\u6837\u7684\u8BDD\u6BCF\u4E2A\u7D22\u5F15\u603B\u5171\u5C31\u6709 2 \u4E2A\u5206\u7247\uFF0C \u6211\u4EEC\u9700\u8981\u6839\u636E\u7D22\u5F15\u9700\u8981\u786E\u5B9A\u5206\u7247\u4E2A\u6570\u3002</p><h4 id="\u5206\u914Dallocation" tabindex="-1"><a class="header-anchor" href="#\u5206\u914Dallocation" aria-hidden="true">#</a> \u5206\u914DAllocation</h4><p>\u5C06\u5206\u7247\u5206\u914D\u7ED9\u67D0\u4E2A\u8282\u70B9\u7684\u8FC7\u7A0B\uFF0C\u5305\u62EC\u5206\u914D\u4E3B\u5206\u7247\u6216\u8005\u526F\u672C\u3002\u5982\u679C\u662F\u526F\u672C\uFF0C\u8FD8\u5305\u542B\u4ECE\u4E3B\u5206\u7247\u590D\u5236\u6570\u636E\u7684\u8FC7\u7A0B\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u662F\u7531 master \u8282\u70B9\u5B8C\u6210\u7684\u3002</p><h3 id="_34-\u8FDB\u9636-\u7CFB\u7EDF\u67B6\u6784-\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#_34-\u8FDB\u9636-\u7CFB\u7EDF\u67B6\u6784-\u7B80\u4ECB" aria-hidden="true">#</a> 34-\u8FDB\u9636-\u7CFB\u7EDF\u67B6\u6784-\u7B80\u4ECB</h3><p><img src="https://qiniu.xinghe.fit/Elasticsearch/e4d13427545dc174eb9ccface85c1f0c.png" alt=""></p><p>\u4E00\u4E2A\u8FD0\u884C\u4E2D\u7684 Elasticsearch \u5B9E\u4F8B\u79F0\u4E3A\u4E00\u4E2A\u8282\u70B9\uFF0C\u800C\u96C6\u7FA4\u662F\u7531\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u62E5\u6709\u76F8\u540C cluster.name \u914D\u7F6E\u7684\u8282\u70B9\u7EC4\u6210\uFF0C \u5B83\u4EEC\u5171\u540C\u627F\u62C5\u6570\u636E\u548C\u8D1F\u8F7D\u7684\u538B\u529B\u3002\u5F53\u6709\u8282\u70B9\u52A0\u5165\u96C6\u7FA4\u4E2D\u6216\u8005\u4ECE\u96C6\u7FA4\u4E2D\u79FB\u9664\u8282\u70B9\u65F6\uFF0C\u96C6\u7FA4\u5C06\u4F1A\u91CD\u65B0\u5E73\u5747\u5206\u5E03\u6240\u6709\u7684\u6570\u636E\u3002</p><p>\u5F53\u4E00\u4E2A\u8282\u70B9\u88AB\u9009\u4E3E\u6210\u4E3A\u4E3B\u8282\u70B9\u65F6\uFF0C\u5B83\u5C06\u8D1F\u8D23\u7BA1\u7406\u96C6\u7FA4\u8303\u56F4\u5185\u7684\u6240\u6709\u53D8\u66F4\uFF0C\u4F8B\u5982\u589E\u52A0\u3001\u5220\u9664\u7D22\u5F15\uFF0C\u6216\u8005\u589E\u52A0\u3001\u5220\u9664\u8282\u70B9\u7B49\u3002\u800C\u4E3B\u8282\u70B9\u5E76\u4E0D\u9700\u8981\u6D89\u53CA\u5230\u6587\u6863\u7EA7\u522B\u7684\u53D8\u66F4\u548C\u641C\u7D22\u7B49\u64CD\u4F5C\uFF0C\u6240\u4EE5\u5F53\u96C6\u7FA4\u53EA\u62E5\u6709\u4E00\u4E2A\u4E3B\u8282\u70B9\u7684\u60C5\u51B5\u4E0B\uFF0C\u5373\u4F7F\u6D41\u91CF\u7684\u589E\u52A0\u5B83\u4E5F\u4E0D\u4F1A\u6210\u4E3A\u74F6\u9888\u3002\u4EFB\u4F55\u8282\u70B9\u90FD\u53EF\u4EE5\u6210\u4E3A\u4E3B\u8282\u70B9\u3002\u6211\u4EEC\u7684\u793A\u4F8B\u96C6\u7FA4\u5C31\u53EA\u6709\u4E00\u4E2A\u8282\u70B9\uFF0C\u6240\u4EE5\u5B83\u540C\u65F6\u4E5F\u6210\u4E3A\u4E86\u4E3B\u8282\u70B9\u3002</p><p>\u4F5C\u4E3A\u7528\u6237\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06\u8BF7\u6C42\u53D1\u9001\u5230\u96C6\u7FA4\u4E2D\u7684\u4EFB\u4F55\u8282\u70B9\uFF0C\u5305\u62EC\u4E3B\u8282\u70B9\u3002\u6BCF\u4E2A\u8282\u70B9\u90FD\u77E5\u9053\u4EFB\u610F\u6587\u6863\u6240\u5904\u7684\u4F4D\u7F6E\uFF0C\u5E76\u4E14\u80FD\u591F\u5C06\u6211\u4EEC\u7684\u8BF7\u6C42\u76F4\u63A5\u8F6C\u53D1\u5230\u5B58\u50A8\u6211\u4EEC\u6240\u9700\u6587\u6863\u7684\u8282\u70B9\u3002\u65E0\u8BBA\u6211\u4EEC\u5C06\u8BF7\u6C42\u53D1\u9001\u5230\u54EA\u4E2A\u8282\u70B9\uFF0C\u5B83\u90FD\u80FD\u8D1F\u8D23\u4ECE\u5404\u4E2A\u5305\u542B\u6211\u4EEC\u6240\u9700\u6587\u6863\u7684\u8282\u70B9\u6536\u96C6\u56DE\u6570\u636E\uFF0C\u5E76\u5C06\u6700\u7EC8\u7ED3\u679C\u8FD4\u56DE\u7D66\u5BA2\u6237\u7AEF\u3002 Elasticsearch \u5BF9\u8FD9\u4E00\u5207\u7684\u7BA1\u7406\u90FD\u662F\u900F\u660E\u7684\u3002</p><h3 id="_35-\u8FDB\u9636-\u5355\u8282\u70B9\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#_35-\u8FDB\u9636-\u5355\u8282\u70B9\u96C6\u7FA4" aria-hidden="true">#</a> 35-\u8FDB\u9636-\u5355\u8282\u70B9\u96C6\u7FA4</h3><p>\u6211\u4EEC\u5728\u5305\u542B\u4E00\u4E2A\u7A7A\u8282\u70B9\u7684\u96C6\u7FA4\u5185\u521B\u5EFA\u540D\u4E3A users \u7684\u7D22\u5F15\uFF0C\u4E3A\u4E86\u6F14\u793A\u76EE\u7684\uFF0C\u6211\u4EEC\u5C06\u5206\u914D 3\u4E2A\u4E3B\u5206\u7247\u548C\u4E00\u4EFD\u526F\u672C\uFF08\u6BCF\u4E2A\u4E3B\u5206\u7247\u62E5\u6709\u4E00\u4E2A\u526F\u672C\u5206\u7247\uFF09\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:1002/users</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;settings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;number_of_shards&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">&quot;number_of_replicas&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u96C6\u7FA4\u73B0\u5728\u662F\u62E5\u6709\u4E00\u4E2A\u7D22\u5F15\u7684\u5355\u8282\u70B9\u96C6\u7FA4\u3002\u6240\u6709 3 \u4E2A\u4E3B\u5206\u7247\u90FD\u88AB\u5206\u914D\u5728 node-1 \u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/54ee6753be248cc7d345b38a0eae7d96.png" alt=""></p><p>\u901A\u8FC7 elasticsearch-head \u63D2\u4EF6\uFF08\u4E00\u4E2AChrome\u63D2\u4EF6\uFF09\u67E5\u770B\u96C6\u7FA4\u60C5\u51B5 \u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/e8b15d0b243d486e91f478a220da63bf.png" alt=""></p><ul><li>\u96C6\u7FA4\u5065\u5EB7\u503C:yellow( 3 of 6 )\uFF1A\u8868\u793A\u5F53\u524D\u96C6\u7FA4\u7684\u5168\u90E8\u4E3B\u5206\u7247\u90FD\u6B63\u5E38\u8FD0\u884C\uFF0C\u4F46\u662F\u526F\u672C\u5206\u7247\u6CA1\u6709\u5168\u90E8\u5904\u5728\u6B63\u5E38\u72B6\u6001\u3002</li><li><img src="https://qiniu.xinghe.fit/Elasticsearch/489b6de480112879a00067b793bde685.png" alt="">\uFF1A3 \u4E2A\u4E3B\u5206\u7247\u6B63\u5E38\u3002</li><li><img src="https://qiniu.xinghe.fit/Elasticsearch/3ce9a78d26ee762f0a7a8abf7817a58e.png" alt="">\uFF1A3 \u4E2A\u526F\u672C\u5206\u7247\u90FD\u662F Unassigned\uFF0C\u5B83\u4EEC\u90FD\u6CA1\u6709\u88AB\u5206\u914D\u5230\u4EFB\u4F55\u8282\u70B9\u3002 \u5728\u540C \u4E00\u4E2A\u8282\u70B9\u4E0A\u65E2\u4FDD\u5B58\u539F\u59CB\u6570\u636E\u53C8\u4FDD\u5B58\u526F\u672C\u662F\u6CA1\u6709\u610F\u4E49\u7684\uFF0C\u56E0\u4E3A\u4E00\u65E6\u5931\u53BB\u4E86\u90A3\u4E2A\u8282\u70B9\uFF0C\u6211\u4EEC\u4E5F\u5C06\u4E22\u5931\u8BE5\u8282\u70B9\u4E0A\u7684\u6240\u6709\u526F\u672C\u6570\u636E\u3002</li></ul><p>\u5F53\u524D\u96C6\u7FA4\u662F\u6B63\u5E38\u8FD0\u884C\u7684\uFF0C\u4F46\u5B58\u5728\u4E22\u5931\u6570\u636E\u7684\u98CE\u9669\u3002</p><hr><p><strong>elasticsearch-head chrome\u63D2\u4EF6\u5B89\u88C5</strong></p><p>https://blog.csdn.net/qq_45919082/article/details/133077606</p>`,75),E={href:"https://github.com/mobz/elasticsearch-head",target:"_blank",rel:"noopener noreferrer"},R=s("\u63D2\u4EF6\u83B7\u53D6\u7F51\u5740"),B=s("\uFF0C\u4E0B\u8F7D\u538B\u7F29\u5305\uFF0C\u89E3\u538B\u540E\u5C06\u5185\u5BB9\u653E\u5165\u81EA\u5B9A\u4E49\u547D\u540D\u4E3Aelasticsearch-head\u6587\u4EF6\u5939\u3002"),T=p(`<p>\u63A5\u7740\u70B9\u51FBChrome\u53F3\u4E0A\u89D2\u9009\u9879-&gt;\u5DE5\u5177-&gt;\u7BA1\u7406\u6269\u5C55\uFF08\u6216\u5219\u5730\u5740\u680F\u8F93\u5165chrome://extensions/\uFF09\uFF0C\u9009\u62E9\u6253\u5F00\u201C\u5F00\u53D1\u8005\u6A21\u5F0F\u201D\uFF0C\u8BA9\u540E\u70B9\u51FB\u201C\u52A0\u8F7D\u5DF2\u89E3\u538B\u5F97\u6269\u5C55\u7A0B\u5E8F\u201D\uFF0C\u9009\u62E9elasticsearch-head/_site\uFF0C\u5373\u53EF\u5B8C\u6210chrome\u63D2\u4EF6\u5B89\u88C5\u3002</p><h3 id="_36-\u8FDB\u9636-\u6545\u969C\u8F6C\u79FB" tabindex="-1"><a class="header-anchor" href="#_36-\u8FDB\u9636-\u6545\u969C\u8F6C\u79FB" aria-hidden="true">#</a> 36-\u8FDB\u9636-\u6545\u969C\u8F6C\u79FB</h3><p>\u5F53\u96C6\u7FA4\u4E2D\u53EA\u6709\u4E00\u4E2A\u8282\u70B9\u5728\u8FD0\u884C\u65F6\uFF0C\u610F\u5473\u7740\u4F1A\u6709\u4E00\u4E2A\u5355\u70B9\u6545\u969C\u95EE\u9898---\u6CA1\u6709\u5197\u4F59\u3002 \u5E78\u8FD0\u7684\u662F\uFF0C\u6211\u4EEC\u53EA\u9700\u518D\u542F\u52A8\u4E00\u4E2A\u8282\u70B9\u5373\u53EF\u9632\u6B62\u6570\u636E\u4E22\u5931\u3002\u5F53\u4F60\u5728\u540C\u4E00\u53F0\u673A\u5668\u4E0A\u542F\u52A8\u4E86\u7B2C\u4E8C\u4E2A\u8282\u70B9\u65F6\uFF0C\u53EA\u8981\u5B83\u548C\u7B2C\u4E00\u4E2A\u8282\u70B9\u6709\u540C\u6837\u7684 cluster.name \u914D\u7F6E\uFF0C\u5B83\u5C31\u4F1A\u81EA\u52A8\u53D1\u73B0\u96C6\u7FA4\u5E76\u52A0\u5165\u5230\u5176\u4E2D\u3002\u4F46\u662F\u5728\u4E0D\u540C\u673A\u5668\u4E0A\u542F\u52A8\u8282\u70B9\u7684\u65F6\u5019\uFF0C\u4E3A\u4E86\u52A0\u5165\u5230\u540C\u4E00\u96C6\u7FA4\uFF0C\u4F60\u9700\u8981\u914D\u7F6E\u4E00\u4E2A\u53EF\u8FDE\u63A5\u5230\u7684\u5355\u64AD\u4E3B\u673A\u5217\u8868\u3002\u4E4B\u6240\u4EE5\u914D\u7F6E\u4E3A\u4F7F\u7528\u5355\u64AD\u53D1\u73B0\uFF0C\u4EE5\u9632\u6B62\u8282\u70B9\u65E0\u610F\u4E2D\u52A0\u5165\u96C6\u7FA4\u3002\u53EA\u6709\u5728\u540C\u4E00\u53F0\u673A\u5668\u4E0A\u8FD0\u884C\u7684\u8282\u70B9\u624D\u4F1A\u81EA\u52A8\u7EC4\u6210\u96C6\u7FA4\u3002</p><p>\u5982\u679C\u542F\u52A8\u4E86\u7B2C\u4E8C\u4E2A\u8282\u70B9\uFF0C\u96C6\u7FA4\u5C06\u4F1A\u62E5\u6709\u4E24\u4E2A\u8282\u70B9 : \u6240\u6709\u4E3B\u5206\u7247\u548C\u526F\u672C\u5206\u7247\u90FD\u5DF2\u88AB\u5206\u914D \u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/bf76cb1bfbdf07555918d9055817ab44.png" alt=""></p><p>\u901A\u8FC7 elasticsearch-head \u63D2\u4EF6\u67E5\u770B\u96C6\u7FA4\u60C5\u51B5</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/18db400822b83e727d6206f486b7b2ea.png" alt=""></p><ul><li>\u96C6\u7FA4\u5065\u5EB7\u503C:green( 3 of 6 )\uFF1A\u8868\u793A\u6240\u6709 6 \u4E2A\u5206\u7247\uFF08\u5305\u62EC 3 \u4E2A\u4E3B\u5206\u7247\u548C 3 \u4E2A\u526F\u672C\u5206\u7247\uFF09\u90FD\u5728\u6B63\u5E38\u8FD0\u884C\u3002</li><li><img src="https://qiniu.xinghe.fit/Elasticsearch/e485d8263a4aa3a94af0be951bd5a241.png" alt="">\uFF1A3 \u4E2A\u4E3B\u5206\u7247\u6B63\u5E38\u3002</li><li><img src="https://qiniu.xinghe.fit/Elasticsearch/e485d8263a4aa3a94af0be951bd5a241.png" alt="">\uFF1A\u7B2C\u4E8C\u4E2A\u8282\u70B9\u52A0\u5165\u5230\u96C6\u7FA4\u540E\uFF0C 3 \u4E2A\u526F\u672C\u5206\u7247\u5C06\u4F1A\u5206\u914D\u5230\u8FD9\u4E2A\u8282\u70B9\u4E0A\u2014\u2014\u6BCF\u4E2A\u4E3B\u5206\u7247\u5BF9\u5E94\u4E00\u4E2A\u526F\u672C\u5206\u7247\u3002\u8FD9\u610F\u5473\u7740\u5F53\u96C6\u7FA4\u5185\u4EFB\u4F55\u4E00\u4E2A\u8282\u70B9\u51FA\u73B0\u95EE\u9898\u65F6\uFF0C\u6211\u4EEC\u7684\u6570\u636E\u90FD\u5B8C\u597D\u65E0\u635F\u3002\u6240\u6709\u65B0\u8FDB\u88AB\u7D22\u5F15\u7684\u6587\u6863\u90FD\u5C06\u4F1A\u4FDD\u5B58\u5728\u4E3B\u5206\u7247\u4E0A\uFF0C\u7136\u540E\u88AB\u5E76\u884C\u7684\u590D\u5236\u5230\u5BF9\u5E94\u7684\u526F\u672C\u5206\u7247\u4E0A\u3002\u8FD9\u5C31\u4FDD\u8BC1\u4E86\u6211\u4EEC\u65E2\u53EF\u4EE5\u4ECE\u4E3B\u5206\u7247\u53C8\u53EF\u4EE5\u4ECE\u526F\u672C\u5206\u7247\u4E0A\u83B7\u5F97\u6587\u6863\u3002</li></ul><h3 id="_37-\u8FDB\u9636-\u6C34\u5E73\u6269\u5BB9" tabindex="-1"><a class="header-anchor" href="#_37-\u8FDB\u9636-\u6C34\u5E73\u6269\u5BB9" aria-hidden="true">#</a> 37-\u8FDB\u9636-\u6C34\u5E73\u6269\u5BB9</h3><p>\u600E\u6837\u4E3A\u6211\u4EEC\u7684\u6B63\u5728\u589E\u957F\u4E2D\u7684\u5E94\u7528\u7A0B\u5E8F\u6309\u9700\u6269\u5BB9\u5462\uFF1F\u5F53\u542F\u52A8\u4E86\u7B2C\u4E09\u4E2A\u8282\u70B9\uFF0C\u6211\u4EEC\u7684\u96C6\u7FA4\u5C06\u4F1A\u62E5\u6709\u4E09\u4E2A\u8282\u70B9\u7684\u96C6\u7FA4: \u4E3A\u4E86\u5206\u6563\u8D1F\u8F7D\u800C\u5BF9\u5206\u7247\u8FDB\u884C\u91CD\u65B0\u5206\u914D\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/d527e26aa2bccdf54b11410024eadc92.png" alt=""></p><p>\u901A\u8FC7 elasticsearch-head \u63D2\u4EF6\u67E5\u770B\u96C6\u7FA4\u60C5\u51B5\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/6985fe14454c1269204478320d089bd7.png" alt=""></p><p>\u96C6\u7FA4\u5065\u5EB7\u503C:green( 3 of 6 )\uFF1A\u8868\u793A\u6240\u6709 6 \u4E2A\u5206\u7247\uFF08\u5305\u62EC 3 \u4E2A\u4E3B\u5206\u7247\u548C 3 \u4E2A\u526F\u672C\u5206\u7247\uFF09\u90FD\u5728\u6B63\u5E38\u8FD0\u884C\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/9494419153adb44bedb395ac5d7bc488.png" alt=""></p><p>Node 1 \u548C Node 2 \u4E0A\u5404\u6709\u4E00\u4E2A\u5206\u7247\u88AB\u8FC1\u79FB\u5230\u4E86\u65B0\u7684 Node 3 \u8282\u70B9\uFF0C\u73B0\u5728\u6BCF\u4E2A\u8282\u70B9\u4E0A\u90FD\u62E5\u6709 2 \u4E2A\u5206\u7247\uFF0C\u800C\u4E0D\u662F\u4E4B\u524D\u7684 3 \u4E2A\u3002\u8FD9\u8868\u793A\u6BCF\u4E2A\u8282\u70B9\u7684\u786C\u4EF6\u8D44\u6E90\uFF08CPU, RAM, I/O)\u5C06\u88AB\u66F4\u5C11\u7684\u5206\u7247\u6240\u5171\u4EAB\uFF0C\u6BCF\u4E2A\u5206\u7247\u7684\u6027\u80FD\u5C06\u4F1A\u5F97\u5230\u63D0\u5347\u3002</p><p>\u5206\u7247\u662F\u4E00\u4E2A\u529F\u80FD\u5B8C\u6574\u7684\u641C\u7D22\u5F15\u64CE\uFF0C\u5B83\u62E5\u6709\u4F7F\u7528\u4E00\u4E2A\u8282\u70B9\u4E0A\u7684\u6240\u6709\u8D44\u6E90\u7684\u80FD\u529B\u3002 \u6211\u4EEC\u8FD9\u4E2A\u62E5\u6709 6 \u4E2A\u5206\u7247\uFF083 \u4E2A\u4E3B\u5206\u7247\u548C 3 \u4E2A\u526F\u672C\u5206\u7247\uFF09\u7684\u7D22\u5F15\u53EF\u4EE5\u6700\u5927\u6269\u5BB9\u5230 6 \u4E2A\u8282\u70B9\uFF0C\u6BCF\u4E2A\u8282\u70B9\u4E0A\u5B58\u5728\u4E00\u4E2A\u5206\u7247\uFF0C\u5E76\u4E14\u6BCF\u4E2A\u5206\u7247\u62E5\u6709\u6240\u5728\u8282\u70B9\u7684\u5168\u90E8\u8D44\u6E90\u3002</p><p><strong>\u4F46\u662F\u5982\u679C\u6211\u4EEC\u60F3\u8981\u6269\u5BB9\u8D85\u8FC7 6 \u4E2A\u8282\u70B9\u600E\u4E48\u529E\u5462\uFF1F</strong></p><p>\u4E3B\u5206\u7247\u7684\u6570\u76EE\u5728\u7D22\u5F15\u521B\u5EFA\u65F6\u5C31\u5DF2\u7ECF\u786E\u5B9A\u4E86\u4E0B\u6765\u3002\u5B9E\u9645\u4E0A\uFF0C\u8FD9\u4E2A\u6570\u76EE\u5B9A\u4E49\u4E86\u8FD9\u4E2A\u7D22\u5F15\u80FD\u591F\u5B58\u50A8\u7684\u6700\u5927\u6570\u636E\u91CF\u3002\uFF08\u5B9E\u9645\u5927\u5C0F\u53D6\u51B3\u4E8E\u4F60\u7684\u6570\u636E\u3001\u786C\u4EF6\u548C\u4F7F\u7528\u573A\u666F\uFF09\u4F46\u662F\uFF0C\u8BFB\u64CD\u4F5C---\u641C\u7D22\u548C\u8FD4\u56DE\u6570\u636E---\u53EF\u4EE5\u540C\u65F6\u88AB\u4E3B\u5206\u7247\u6216\u526F\u672C\u5206\u7247\u6240\u5904\u7406\uFF0C\u6240\u4EE5\u5F53\u4F60\u62E5\u6709\u8D8A\u591A\u7684\u526F\u672C\u5206\u7247\u65F6\uFF0C\u4E5F\u5C06\u62E5\u6709\u8D8A\u9AD8\u7684\u541E\u5410\u91CF\u3002</p><p>\u5728\u8FD0\u884C\u4E2D\u7684\u96C6\u7FA4\u4E0A\u662F\u53EF\u4EE5\u52A8\u6001\u8C03\u6574\u526F\u672C\u5206\u7247\u6570\u76EE\u7684\uFF0C\u6211\u4EEC\u53EF\u4EE5\u6309\u9700\u4F38\u7F29\u96C6\u7FA4\u3002\u8BA9\u6211\u4EEC\u628A\u526F\u672C\u6570\u4ECE\u9ED8\u8BA4\u7684 1 \u589E\u52A0\u5230 2\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:1002/users/_settings</span>

<span class="token punctuation">{</span>
    <span class="token property">&quot;number_of_replicas&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>users \u7D22\u5F15\u73B0\u5728\u62E5\u6709 9 \u4E2A\u5206\u7247\uFF1A 3 \u4E2A\u4E3B\u5206\u7247\u548C 6 \u4E2A\u526F\u672C\u5206\u7247\u3002 \u8FD9\u610F\u5473\u7740\u6211\u4EEC\u53EF\u4EE5\u5C06\u96C6\u7FA4\u6269\u5BB9\u5230 9 \u4E2A\u8282\u70B9\uFF0C\u6BCF\u4E2A\u8282\u70B9\u4E0A\u4E00\u4E2A\u5206\u7247\u3002\u76F8\u6BD4\u539F\u6765 3 \u4E2A\u8282\u70B9\u65F6\uFF0C\u96C6\u7FA4\u641C\u7D22\u6027\u80FD\u53EF\u4EE5\u63D0\u5347 3 \u500D\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/97fd01e34e5d8df23d226c4fef157801.png" alt=""></p><p>\u901A\u8FC7 elasticsearch-head \u63D2\u4EF6\u67E5\u770B\u96C6\u7FA4\u60C5\u51B5\uFF1A</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/8bf9dbf0cec5b7875bf8aa9d17a9a67c.png" alt=""></p><p>\u5F53\u7136\uFF0C\u5982\u679C\u53EA\u662F\u5728\u76F8\u540C\u8282\u70B9\u6570\u76EE\u7684\u96C6\u7FA4\u4E0A\u589E\u52A0\u66F4\u591A\u7684\u526F\u672C\u5206\u7247\u5E76\u4E0D\u80FD\u63D0\u9AD8\u6027\u80FD\uFF0C\u56E0\u4E3A\u6BCF\u4E2A\u5206\u7247\u4ECE\u8282\u70B9\u4E0A\u83B7\u5F97\u7684\u8D44\u6E90\u4F1A\u53D8\u5C11\u3002\u4F60\u9700\u8981\u589E\u52A0\u66F4\u591A\u7684\u786C\u4EF6\u8D44\u6E90\u6765\u63D0\u5347\u541E\u5410\u91CF\u3002\u4F46\u662F\u66F4\u591A\u7684\u526F\u672C\u5206\u7247\u6570\u63D0\u9AD8\u4E86\u6570\u636E\u5197\u4F59\u91CF\uFF1A\u6309\u7167\u4E0A\u9762\u7684\u8282\u70B9\u914D\u7F6E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u5931\u53BB 2 \u4E2A\u8282\u70B9\u7684\u60C5\u51B5\u4E0B\u4E0D\u4E22\u5931\u4EFB\u4F55\u6570\u636E\u3002</p><h3 id="_38-\u8FDB\u9636-\u5E94\u5BF9\u6545\u969C" tabindex="-1"><a class="header-anchor" href="#_38-\u8FDB\u9636-\u5E94\u5BF9\u6545\u969C" aria-hidden="true">#</a> 38-\u8FDB\u9636-\u5E94\u5BF9\u6545\u969C</h3><p>\u6211\u4EEC\u5173\u95ED\u7B2C\u4E00\u4E2A\u8282\u70B9\uFF0C\u8FD9\u65F6\u96C6\u7FA4\u7684\u72B6\u6001\u4E3A:\u5173\u95ED\u4E86\u4E00\u4E2A\u8282\u70B9\u540E\u7684\u96C6\u7FA4\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/44e841004be934e6bce08187ca3852bb.png" alt=""></p><p>\u6211\u4EEC\u5173\u95ED\u7684\u8282\u70B9\u662F\u4E00\u4E2A\u4E3B\u8282\u70B9\u3002\u800C\u96C6\u7FA4\u5FC5\u987B\u62E5\u6709\u4E00\u4E2A\u4E3B\u8282\u70B9\u6765\u4FDD\u8BC1\u6B63\u5E38\u5DE5\u4F5C\uFF0C\u6240\u4EE5\u53D1\u751F\u7684\u7B2C\u4E00\u4EF6\u4E8B\u60C5\u5C31\u662F\u9009\u4E3E\u4E00\u4E2A\u65B0\u7684\u4E3B\u8282\u70B9\uFF1A Node 2 \u3002\u5728\u6211\u4EEC\u5173\u95ED Node 1 \u7684\u540C\u65F6\u4E5F\u5931\u53BB\u4E86\u4E3B\u5206\u7247 1 \u548C 2 \uFF0C\u5E76\u4E14\u5728\u7F3A\u5931\u4E3B\u5206\u7247\u7684\u65F6\u5019\u7D22\u5F15\u4E5F\u4E0D\u80FD\u6B63\u5E38\u5DE5\u4F5C\u3002 \u5982\u679C\u6B64\u65F6\u6765\u68C0\u67E5\u96C6\u7FA4\u7684\u72B6\u51B5\uFF0C\u6211\u4EEC\u770B\u5230\u7684\u72B6\u6001\u5C06\u4F1A\u4E3A red \uFF1A\u4E0D\u662F\u6240\u6709\u4E3B\u5206\u7247\u90FD\u5728\u6B63\u5E38\u5DE5\u4F5C\u3002</p><p>\u5E78\u8FD0\u7684\u662F\uFF0C\u5728\u5176\u5B83\u8282\u70B9\u4E0A\u5B58\u5728\u7740\u8FD9\u4E24\u4E2A\u4E3B\u5206\u7247\u7684\u5B8C\u6574\u526F\u672C\uFF0C \u6240\u4EE5\u65B0\u7684\u4E3B\u8282\u70B9\u7ACB\u5373\u5C06\u8FD9\u4E9B\u5206\u7247\u5728 Node 2 \u548C Node 3 \u4E0A\u5BF9\u5E94\u7684\u526F\u672C\u5206\u7247\u63D0\u5347\u4E3A\u4E3B\u5206\u7247\uFF0C \u6B64\u65F6\u96C6\u7FA4\u7684\u72B6\u6001\u5C06\u4F1A\u4E3Ayellow\u3002\u8FD9\u4E2A\u63D0\u5347\u4E3B\u5206\u7247\u7684\u8FC7\u7A0B\u662F\u77AC\u95F4\u53D1\u751F\u7684\uFF0C\u5982\u540C\u6309\u4E0B\u4E00\u4E2A\u5F00\u5173\u4E00\u822C\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/e956bda7e0d005699e27760d4193d101.png" alt=""></p><p><strong>\u4E3A\u4EC0\u4E48\u6211\u4EEC\u96C6\u7FA4\u72B6\u6001\u662F yellow \u800C\u4E0D\u662F green \u5462\uFF1F</strong></p><p>\u867D\u7136\u6211\u4EEC\u62E5\u6709\u6240\u6709\u7684\u4E09\u4E2A\u4E3B\u5206\u7247\uFF0C\u4F46\u662F\u540C\u65F6\u8BBE\u7F6E\u4E86\u6BCF\u4E2A\u4E3B\u5206\u7247\u9700\u8981\u5BF9\u5E94 2 \u4EFD\u526F\u672C\u5206\u7247\uFF0C\u800C\u6B64\u65F6\u53EA\u5B58\u5728\u4E00\u4EFD\u526F\u672C\u5206\u7247\u3002 \u6240\u4EE5\u96C6\u7FA4\u4E0D\u80FD\u4E3A green \u7684\u72B6\u6001\uFF0C\u4E0D\u8FC7\u6211\u4EEC\u4E0D\u5FC5\u8FC7\u4E8E\u62C5\u5FC3\uFF1A\u5982\u679C\u6211\u4EEC\u540C\u6837\u5173\u95ED\u4E86 Node 2 \uFF0C\u6211\u4EEC\u7684\u7A0B\u5E8F \u4F9D\u7136 \u53EF\u4EE5\u4FDD\u6301\u5728\u4E0D\u4E22\u4EFB\u4F55\u6570\u636E\u7684\u60C5\u51B5\u4E0B\u8FD0\u884C\uFF0C\u56E0\u4E3A Node 3 \u4E3A\u6BCF\u4E00\u4E2A\u5206\u7247\u90FD\u4FDD\u7559\u7740\u4E00\u4EFD\u526F\u672C\u3002</p><p>\u5982\u679C\u60F3\u56DE\u590D\u539F\u6765\u7684\u6837\u5B50\uFF0C\u8981\u786E\u4FDDNode-1\u7684\u914D\u7F6E\u6587\u4EF6\u6709\u5982\u4E0B\u914D\u7F6E\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">discovery.seed_hosts</span><span class="token punctuation">:</span> <span class="token value attr-value">[&quot;localhost:9302&quot;, &quot;localhost:9303&quot;]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u96C6\u7FA4\u53EF\u4EE5\u5C06\u7F3A\u5931\u7684\u526F\u672C\u5206\u7247\u518D\u6B21\u8FDB\u884C\u5206\u914D\uFF0C\u90A3\u4E48\u96C6\u7FA4\u7684\u72B6\u6001\u4E5F\u5C06\u6062\u590D\u6210\u4E4B\u524D\u7684\u72B6\u6001\u3002 \u5982\u679C Node 1 \u4F9D\u7136\u62E5\u6709\u7740\u4E4B\u524D\u7684\u5206\u7247\uFF0C\u5B83\u5C06\u5C1D\u8BD5\u53BB\u91CD\u7528\u5B83\u4EEC\uFF0C\u540C\u65F6\u4EC5\u4ECE\u4E3B\u5206\u7247\u590D\u5236\u53D1\u751F\u4E86\u4FEE\u6539\u7684\u6570\u636E\u6587\u4EF6\u3002\u548C\u4E4B\u524D\u7684\u96C6\u7FA4\u76F8\u6BD4\uFF0C\u53EA\u662F Master \u8282\u70B9\u5207\u6362\u4E86\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/37eea6a8dae7ba908312f2ebf0eced11.png" alt=""></p><h3 id="_39-\u8FDB\u9636-\u8DEF\u7531\u8BA1\u7B97-\u5206\u7247\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#_39-\u8FDB\u9636-\u8DEF\u7531\u8BA1\u7B97-\u5206\u7247\u63A7\u5236" aria-hidden="true">#</a> 39-\u8FDB\u9636-\u8DEF\u7531\u8BA1\u7B97 &amp; \u5206\u7247\u63A7\u5236</h3><h4 id="\u8DEF\u7531\u8BA1\u7B97" tabindex="-1"><a class="header-anchor" href="#\u8DEF\u7531\u8BA1\u7B97" aria-hidden="true">#</a> \u8DEF\u7531\u8BA1\u7B97</h4><p>\u5F53\u7D22\u5F15\u4E00\u4E2A\u6587\u6863\u7684\u65F6\u5019\uFF0C\u6587\u6863\u4F1A\u88AB\u5B58\u50A8\u5230\u4E00\u4E2A\u4E3B\u5206\u7247\u4E2D\u3002 Elasticsearch \u5982\u4F55\u77E5\u9053\u4E00\u4E2A\u6587\u6863\u5E94\u8BE5\u5B58\u653E\u5230\u54EA\u4E2A\u5206\u7247\u4E2D\u5462\uFF1F\u5F53\u6211\u4EEC\u521B\u5EFA\u6587\u6863\u65F6\uFF0C\u5B83\u5982\u4F55\u51B3\u5B9A\u8FD9\u4E2A\u6587\u6863\u5E94\u5F53\u88AB\u5B58\u50A8\u5728\u5206\u7247 1 \u8FD8\u662F\u5206\u7247 2 \u4E2D\u5462\uFF1F\u9996\u5148\u8FD9\u80AF\u5B9A\u4E0D\u4F1A\u662F\u968F\u673A\u7684\uFF0C\u5426\u5219\u5C06\u6765\u8981\u83B7\u53D6\u6587\u6863\u7684\u65F6\u5019\u6211\u4EEC\u5C31\u4E0D\u77E5\u9053\u4ECE\u4F55\u5904\u5BFB\u627E\u4E86\u3002\u5B9E\u9645\u4E0A\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u662F\u6839\u636E\u4E0B\u9762\u8FD9\u4E2A\u516C\u5F0F\u51B3\u5B9A\u7684\uFF1A</p><p><strong>shard = hash(routing) % number_of_primary_shards</strong></p><p>routing \u662F\u4E00\u4E2A\u53EF\u53D8\u503C\uFF0C\u9ED8\u8BA4\u662F\u6587\u6863\u7684 _id \uFF0C\u4E5F\u53EF\u4EE5\u8BBE\u7F6E\u6210\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7684\u503C\u3002 routing \u901A\u8FC7hash \u51FD\u6570\u751F\u6210\u4E00\u4E2A\u6570\u5B57\uFF0C\u7136\u540E\u8FD9\u4E2A\u6570\u5B57\u518D\u9664\u4EE5 number_of_primary_shards \uFF08\u4E3B\u5206\u7247\u7684\u6570\u91CF\uFF09\u540E\u5F97\u5230\u4F59\u6570 \u3002\u8FD9\u4E2A\u5206\u5E03\u5728 0 \u5230 number_of_primary_shards-1 \u4E4B\u95F4\u7684\u4F59\u6570\uFF0C\u5C31\u662F\u6211\u4EEC\u6240\u5BFB\u6C42\u7684\u6587\u6863\u6240\u5728\u5206\u7247\u7684\u4F4D\u7F6E\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/9c34e8603887c2bed475416e3b67cd9a.png" alt=""></p><p>\u8FD9\u5C31\u89E3\u91CA\u4E86\u4E3A\u4EC0\u4E48\u6211\u4EEC\u8981\u5728\u521B\u5EFA\u7D22\u5F15\u7684\u65F6\u5019\u5C31\u786E\u5B9A\u597D\u4E3B\u5206\u7247\u7684\u6570\u91CF\u5E76\u4E14\u6C38\u8FDC\u4E0D\u4F1A\u6539\u53D8\u8FD9\u4E2A\u6570\u91CF\uFF1A\u56E0\u4E3A\u5982\u679C\u6570\u91CF\u53D8\u5316\u4E86\uFF0C\u90A3\u4E48\u6240\u6709\u4E4B\u524D\u8DEF\u7531\u7684\u503C\u90FD\u4F1A\u65E0\u6548\uFF0C\u6587\u6863\u4E5F\u518D\u4E5F\u627E\u4E0D\u5230\u4E86\u3002</p><p>\u6240\u6709\u7684\u6587\u6863API ( get . index . delete \u3001 bulk , update\u4EE5\u53CA mget \uFF09\u90FD\u63A5\u53D7\u4E00\u4E2A\u53EB\u505A routing \u7684\u8DEF\u7531\u53C2\u6570\uFF0C\u901A\u8FC7\u8FD9\u4E2A\u53C2\u6570\u6211\u4EEC\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6587\u6863\u5230\u5206\u7247\u7684\u6620\u5C04\u3002\u4E00\u4E2A\u81EA\u5B9A\u4E49\u7684\u8DEF\u7531\u53C2\u6570\u53EF\u4EE5\u7528\u6765\u786E\u4FDD\u6240\u6709\u76F8\u5173\u7684\u6587\u6863\u2014\u4E00\u4F8B\u5982\u6240\u6709\u5C5E\u4E8E\u540C\u4E00\u4E2A\u7528\u6237\u7684\u6587\u6863\u2014\u2014\u90FD\u88AB\u5B58\u50A8\u5230\u540C\u4E00\u4E2A\u5206\u7247\u4E2D\u3002</p><h4 id="\u5206\u7247\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u5206\u7247\u63A7\u5236" aria-hidden="true">#</a> \u5206\u7247\u63A7\u5236</h4><p>\u6211\u4EEC\u53EF\u4EE5\u53D1\u9001\u8BF7\u6C42\u5230\u96C6\u7FA4\u4E2D\u7684\u4EFB\u4E00\u8282\u70B9\u3002\u6BCF\u4E2A\u8282\u70B9\u90FD\u6709\u80FD\u529B\u5904\u7406\u4EFB\u610F\u8BF7\u6C42\u3002\u6BCF\u4E2A\u8282\u70B9\u90FD\u77E5\u9053\u96C6\u7FA4\u4E2D\u4EFB\u4E00\u6587\u6863\u4F4D\u7F6E\uFF0C\u6240\u4EE5\u53EF\u4EE5\u76F4\u63A5\u5C06\u8BF7\u6C42\u8F6C\u53D1\u5230\u9700\u8981\u7684\u8282\u70B9\u4E0A\u3002\u5728\u4E0B\u9762\u7684\u4F8B\u5B50\u4E2D\uFF0C\u5982\u679C\u5C06\u6240\u6709\u7684\u8BF7\u6C42\u53D1\u9001\u5230Node 1001\uFF0C\u6211\u4EEC\u5C06\u5176\u79F0\u4E3A\u534F\u8C03\u8282\u70B9<strong>coordinating node</strong>\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/3940d6cdb197259368542b86384911a4.png" alt=""></p><p>\u5F53\u53D1\u9001\u8BF7\u6C42\u7684\u65F6\u5019\uFF0C\u4E3A\u4E86\u6269\u5C55\u8D1F\u8F7D\uFF0C\u66F4\u597D\u7684\u505A\u6CD5\u662F\u8F6E\u8BE2\u96C6\u7FA4\u4E2D\u6240\u6709\u7684\u8282\u70B9\u3002</p><h3 id="_40-\u8FDB\u9636-\u6570\u636E\u5199\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_40-\u8FDB\u9636-\u6570\u636E\u5199\u6D41\u7A0B" aria-hidden="true">#</a> 40-\u8FDB\u9636-\u6570\u636E\u5199\u6D41\u7A0B</h3><p>\u65B0\u5EFA\u3001\u7D22\u5F15\u548C\u5220\u9664\u8BF7\u6C42\u90FD\u662F\u5199\u64CD\u4F5C\uFF0C\u5FC5\u987B\u5728\u4E3B\u5206\u7247\u4E0A\u9762\u5B8C\u6210\u4E4B\u540E\u624D\u80FD\u88AB\u590D\u5236\u5230\u76F8\u5173\u7684\u526F\u672C\u5206\u7247\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/418356a32516c222a8d366df021276c2.png" alt=""></p><p>\u5728\u5BA2\u6237\u7AEF\u6536\u5230\u6210\u529F\u54CD\u5E94\u65F6\uFF0C\u6587\u6863\u53D8\u66F4\u5DF2\u7ECF\u5728\u4E3B\u5206\u7247\u548C\u6240\u6709\u526F\u672C\u5206\u7247\u6267\u884C\u5B8C\u6210\uFF0C\u53D8\u66F4\u662F\u5B89\u5168\u7684\u3002\u6709\u4E00\u4E9B\u53EF\u9009\u7684\u8BF7\u6C42\u53C2\u6570\u5141\u8BB8\u60A8\u5F71\u54CD\u8FD9\u4E2A\u8FC7\u7A0B\uFF0C\u53EF\u80FD\u4EE5\u6570\u636E\u5B89\u5168\u4E3A\u4EE3\u4EF7\u63D0\u5347\u6027\u80FD\u3002\u8FD9\u4E9B\u9009\u9879\u5F88\u5C11\u4F7F\u7528\uFF0C\u56E0\u4E3A Elasticsearch \u5DF2\u7ECF\u5F88\u5FEB\uFF0C\u4F46\u662F\u4E3A\u4E86\u5B8C\u6574\u8D77\u89C1\uFF0C\u8BF7\u53C2\u8003\u4E0B\u6587\uFF1A</p><ol><li>consistency</li></ol><ul><li>\u5373\u4E00\u81F4\u6027\u3002\u5728\u9ED8\u8BA4\u8BBE\u7F6E\u4E0B\uFF0C\u5373\u4F7F\u4EC5\u4EC5\u662F\u5728\u8BD5\u56FE\u6267\u884C\u4E00\u4E2A\u5199\u64CD\u4F5C\u4E4B\u524D\uFF0C\u4E3B\u5206\u7247\u90FD\u4F1A\u8981\u6C42\u5FC5\u987B\u8981\u6709\u89C4\u5B9A\u6570\u91CFquorum\uFF08\u6216\u8005\u6362\u79CD\u8BF4\u6CD5\uFF0C\u4E5F\u5373\u5FC5\u987B\u8981\u6709\u5927\u591A\u6570\uFF09\u7684\u5206\u7247\u526F\u672C\u5904\u4E8E\u6D3B\u8DC3\u53EF\u7528\u72B6\u6001\uFF0C\u624D\u4F1A\u53BB\u6267\u884C\u5199\u64CD\u4F5C\uFF08\u5176\u4E2D\u5206\u7247\u526F\u672C \u53EF\u4EE5\u662F\u4E3B\u5206\u7247\u6216\u8005\u526F\u672C\u5206\u7247\uFF09\u3002\u8FD9\u662F\u4E3A\u4E86\u907F\u514D\u5728\u53D1\u751F\u7F51\u7EDC\u5206\u533A\u6545\u969C\uFF08network partition\uFF09\u7684\u65F6\u5019\u8FDB\u884C\u5199\u64CD\u4F5C\uFF0C\u8FDB\u800C\u5BFC\u81F4\u6570\u636E\u4E0D\u4E00\u81F4\u3002 \u89C4\u5B9A\u6570\u91CF\u5373\uFF1A<strong>int((primary + number_of_replicas) / 2 ) + 1</strong></li><li>consistency \u53C2\u6570\u7684\u503C\u53EF\u4EE5\u8BBE\u4E3A\uFF1A <ul><li>one \uFF1A\u53EA\u8981\u4E3B\u5206\u7247\u72B6\u6001 ok \u5C31\u5141\u8BB8\u6267\u884C\u5199\u64CD\u4F5C\u3002</li><li>all\uFF1A\u5FC5\u987B\u8981\u4E3B\u5206\u7247\u548C\u6240\u6709\u526F\u672C\u5206\u7247\u7684\u72B6\u6001\u6CA1\u95EE\u9898\u624D\u5141\u8BB8\u6267\u884C\u5199\u64CD\u4F5C\u3002</li><li>quorum\uFF1A\u9ED8\u8BA4\u503C\u4E3Aquorum , \u5373\u5927\u591A\u6570\u7684\u5206\u7247\u526F\u672C\u72B6\u6001\u6CA1\u95EE\u9898\u5C31\u5141\u8BB8\u6267\u884C\u5199\u64CD\u4F5C\u3002</li></ul></li><li>\u6CE8\u610F\uFF0C\u89C4\u5B9A\u6570\u91CF\u7684\u8BA1\u7B97\u516C\u5F0F\u4E2Dnumber_of_replicas\u6307\u7684\u662F\u5728\u7D22\u5F15\u8BBE\u7F6E\u4E2D\u7684\u8BBE\u5B9A\u526F\u672C\u5206\u7247\u6570\uFF0C\u800C\u4E0D\u662F\u6307\u5F53\u524D\u5904\u7406\u6D3B\u52A8\u72B6\u6001\u7684\u526F\u672C\u5206\u7247\u6570\u3002\u5982\u679C\u4F60\u7684\u7D22\u5F15\u8BBE\u7F6E\u4E2D\u6307\u5B9A\u4E86\u5F53\u524D\u7D22\u5F15\u62E5\u67093\u4E2A\u526F\u672C\u5206\u7247\uFF0C\u90A3\u89C4\u5B9A\u6570\u91CF\u7684\u8BA1\u7B97\u7ED3\u679C\u5373\uFF1A<strong>int((1 primary + 3 replicas) / 2) + 1 = 3</strong>\uFF0C\u5982\u679C\u6B64\u65F6\u4F60\u53EA\u542F\u52A8\u4E24\u4E2A\u8282\u70B9\uFF0C\u90A3\u4E48\u5904\u4E8E\u6D3B\u8DC3\u72B6\u6001\u7684\u5206\u7247\u526F\u672C\u6570\u91CF\u5C31\u8FBE\u4E0D\u5230\u89C4\u5B9A\u6570\u91CF\uFF0C\u4E5F\u56E0\u6B64\u60A8\u5C06\u65E0\u6CD5\u7D22\u5F15\u548C\u5220\u9664\u4EFB\u4F55\u6587\u6863\u3002</li></ul><ol start="2"><li>timeout <ul><li>\u5982\u679C\u6CA1\u6709\u8DB3\u591F\u7684\u526F\u672C\u5206\u7247\u4F1A\u53D1\u751F\u4EC0\u4E48\uFF1FElasticsearch \u4F1A\u7B49\u5F85\uFF0C\u5E0C\u671B\u66F4\u591A\u7684\u5206\u7247\u51FA\u73B0\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5B83\u6700\u591A\u7B49\u5F85 1 \u5206\u949F\u3002 \u5982\u679C\u4F60\u9700\u8981\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528timeout\u53C2\u6570\u4F7F\u5B83\u66F4\u65E9\u7EC8\u6B62\uFF1A100\u662F100 \u6BEB\u79D2\uFF0C30s\u662F30\u79D2\u3002</li></ul></li></ol><p>\u65B0\u7D22\u5F15\u9ED8\u8BA4\u67091\u4E2A\u526F\u672C\u5206\u7247\uFF0C\u8FD9\u610F\u5473\u7740\u4E3A\u6EE1\u8DB3\u89C4\u5B9A\u6570\u91CF\u5E94\u8BE5\u9700\u8981\u4E24\u4E2A\u6D3B\u52A8\u7684\u5206\u7247\u526F\u672C\u3002 \u4F46\u662F\uFF0C\u8FD9\u4E9B\u9ED8\u8BA4\u7684\u8BBE\u7F6E\u4F1A\u963B\u6B62\u6211\u4EEC\u5728\u5355\u4E00\u8282\u70B9\u4E0A\u505A\u4EFB\u4F55\u4E8B\u60C5\u3002\u4E3A\u4E86\u907F\u514D\u8FD9\u4E2A\u95EE\u9898\uFF0C\u8981\u6C42\u53EA\u6709\u5F53number_of_replicas \u5927\u4E8E1\u7684\u65F6\u5019\uFF0C\u89C4\u5B9A\u6570\u91CF\u624D\u4F1A\u6267\u884C\u3002</p><h3 id="_41-\u8FDB\u9636-\u6570\u636E\u8BFB\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_41-\u8FDB\u9636-\u6570\u636E\u8BFB\u6D41\u7A0B" aria-hidden="true">#</a> 41-\u8FDB\u9636-\u6570\u636E\u8BFB\u6D41\u7A0B</h3><p><img src="https://qiniu.xinghe.fit/Elasticsearch/7139df83ee6f7a59c5d3252d34cc8762.png" alt=""></p><p>\u5728\u5904\u7406\u8BFB\u53D6\u8BF7\u6C42\u65F6\uFF0C\u534F\u8C03\u7ED3\u70B9\u5728\u6BCF\u6B21\u8BF7\u6C42\u7684\u65F6\u5019\u90FD\u4F1A\u901A\u8FC7\u8F6E\u8BE2\u6240\u6709\u7684\u526F\u672C\u5206\u7247\u6765\u8FBE\u5230\u8D1F\u8F7D\u5747\u8861\u3002\u5728\u6587\u6863\u88AB\u68C0\u7D22\u65F6\uFF0C\u5DF2\u7ECF\u88AB\u7D22\u5F15\u7684\u6587\u6863\u53EF\u80FD\u5DF2\u7ECF\u5B58\u5728\u4E8E\u4E3B\u5206\u7247\u4E0A\u4F46\u662F\u8FD8\u6CA1\u6709\u590D\u5236\u5230\u526F\u672C\u5206\u7247\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u526F\u672C\u5206\u7247\u53EF\u80FD\u4F1A\u62A5\u544A\u6587\u6863\u4E0D\u5B58\u5728\uFF0C\u4F46\u662F\u4E3B\u5206\u7247\u53EF\u80FD\u6210\u529F\u8FD4\u56DE\u6587\u6863\u3002 \u4E00\u65E6\u7D22\u5F15\u8BF7\u6C42\u6210\u529F\u8FD4\u56DE\u7ED9\u7528\u6237\uFF0C\u6587\u6863\u5728\u4E3B\u5206\u7247\u548C\u526F\u672C\u5206\u7247\u90FD\u662F\u53EF\u7528\u7684\u3002</p><h3 id="_42-\u8FDB\u9636-\u66F4\u65B0\u6D41\u7A0B-\u6279\u91CF\u64CD\u4F5C\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_42-\u8FDB\u9636-\u66F4\u65B0\u6D41\u7A0B-\u6279\u91CF\u64CD\u4F5C\u6D41\u7A0B" aria-hidden="true">#</a> 42-\u8FDB\u9636-\u66F4\u65B0\u6D41\u7A0B &amp; \u6279\u91CF\u64CD\u4F5C\u6D41\u7A0B</h3><h4 id="\u66F4\u65B0\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u66F4\u65B0\u6D41\u7A0B" aria-hidden="true">#</a> \u66F4\u65B0\u6D41\u7A0B</h4><p>\u90E8\u5206\u66F4\u65B0\u4E00\u4E2A\u6587\u6863\u7ED3\u5408\u4E86\u5148\u524D\u8BF4\u660E\u7684\u8BFB\u53D6\u548C\u5199\u5165\u6D41\u7A0B\uFF1A</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/ca41993144aee98311671278725437cd.png" alt=""></p><p>\u90E8\u5206\u66F4\u65B0\u4E00\u4E2A\u6587\u6863\u7684\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><ol><li>\u5BA2\u6237\u7AEF\u5411Node 1\u53D1\u9001\u66F4\u65B0\u8BF7\u6C42\u3002</li><li>\u5B83\u5C06\u8BF7\u6C42\u8F6C\u53D1\u5230\u4E3B\u5206\u7247\u6240\u5728\u7684Node 3 \u3002</li><li>Node 3\u4ECE\u4E3B\u5206\u7247\u68C0\u7D22\u6587\u6863\uFF0C\u4FEE\u6539_source\u5B57\u6BB5\u4E2D\u7684JSON\uFF0C\u5E76\u4E14\u5C1D\u8BD5\u91CD\u65B0\u7D22\u5F15\u4E3B\u5206\u7247\u7684\u6587\u6863\u3002\u5982\u679C\u6587\u6863\u5DF2\u7ECF\u88AB\u53E6\u4E00\u4E2A\u8FDB\u7A0B\u4FEE\u6539,\u5B83\u4F1A\u91CD\u8BD5\u6B65\u9AA43 ,\u8D85\u8FC7retry_on_conflict\u6B21\u540E\u653E\u5F03\u3002</li><li>\u5982\u679C Node 3\u6210\u529F\u5730\u66F4\u65B0\u6587\u6863\uFF0C\u5B83\u5C06\u65B0\u7248\u672C\u7684\u6587\u6863\u5E76\u884C\u8F6C\u53D1\u5230Node 1\u548C Node 2\u4E0A\u7684\u526F\u672C\u5206\u7247\uFF0C\u91CD\u65B0\u5EFA\u7ACB\u7D22\u5F15\u3002\u4E00\u65E6\u6240\u6709\u526F\u672C\u5206\u7247\u90FD\u8FD4\u56DE\u6210\u529F\uFF0CNode 3\u5411\u534F\u8C03\u8282\u70B9\u4E5F\u8FD4\u56DE\u6210\u529F\uFF0C\u534F\u8C03\u8282\u70B9\u5411\u5BA2\u6237\u7AEF\u8FD4\u56DE\u6210\u529F\u3002</li></ol><p>\u5F53\u4E3B\u5206\u7247\u628A\u66F4\u6539\u8F6C\u53D1\u5230\u526F\u672C\u5206\u7247\u65F6\uFF0C \u5B83\u4E0D\u4F1A\u8F6C\u53D1\u66F4\u65B0\u8BF7\u6C42\u3002 \u76F8\u53CD\uFF0C\u5B83\u8F6C\u53D1\u5B8C\u6574\u6587\u6863\u7684\u65B0\u7248\u672C\u3002\u8BF7\u8BB0\u4F4F\uFF0C\u8FD9\u4E9B\u66F4\u6539\u5C06\u4F1A\u5F02\u6B65\u8F6C\u53D1\u5230\u526F\u672C\u5206\u7247\uFF0C\u5E76\u4E14\u4E0D\u80FD\u4FDD\u8BC1\u5B83\u4EEC\u4EE5\u53D1\u9001\u5B83\u4EEC\u76F8\u540C\u7684\u987A\u5E8F\u5230\u8FBE\u3002 \u5982\u679C Elasticsearch \u4EC5\u8F6C\u53D1\u66F4\u6539\u8BF7\u6C42\uFF0C\u5219\u53EF\u80FD\u4EE5\u9519\u8BEF\u7684\u987A\u5E8F\u5E94\u7528\u66F4\u6539\uFF0C\u5BFC\u81F4\u5F97\u5230\u635F\u574F\u7684\u6587\u6863\u3002</p><h4 id="\u6279\u91CF\u64CD\u4F5C\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u6279\u91CF\u64CD\u4F5C\u6D41\u7A0B" aria-hidden="true">#</a> \u6279\u91CF\u64CD\u4F5C\u6D41\u7A0B</h4><p>mget\u548C bulk API\u7684\u6A21\u5F0F\u7C7B\u4F3C\u4E8E\u5355\u6587\u6863\u6A21\u5F0F\u3002\u533A\u522B\u5728\u4E8E\u534F\u8C03\u8282\u70B9\u77E5\u9053\u6BCF\u4E2A\u6587\u6863\u5B58\u5728\u4E8E\u54EA\u4E2A\u5206\u7247\u4E2D\u3002\u5B83\u5C06\u6574\u4E2A\u591A\u6587\u6863\u8BF7\u6C42\u5206\u89E3\u6210\u6BCF\u4E2A\u5206\u7247\u7684\u591A\u6587\u6863\u8BF7\u6C42\uFF0C\u5E76\u4E14\u5C06\u8FD9\u4E9B\u8BF7\u6C42\u5E76\u884C\u8F6C\u53D1\u5230\u6BCF\u4E2A\u53C2\u4E0E\u8282\u70B9\u3002</p><p>\u534F\u8C03\u8282\u70B9\u4E00\u65E6\u6536\u5230\u6765\u81EA\u6BCF\u4E2A\u8282\u70B9\u7684\u5E94\u7B54\uFF0C\u5C31\u5C06\u6BCF\u4E2A\u8282\u70B9\u7684\u54CD\u5E94\u6536\u96C6\u6574\u7406\u6210\u5355\u4E2A\u54CD\u5E94\uFF0C\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/b90ea9c79138d8361ca339cff205fdb0.png" alt=""></p><p><strong>\u7528\u5355\u4E2A mget \u8BF7\u6C42\u53D6\u56DE\u591A\u4E2A\u6587\u6863\u6240\u9700\u7684\u6B65\u9AA4\u987A\u5E8F:</strong></p><ol><li>\u5BA2\u6237\u7AEF\u5411 Node 1 \u53D1\u9001 mget \u8BF7\u6C42\u3002</li><li>Node 1\u4E3A\u6BCF\u4E2A\u5206\u7247\u6784\u5EFA\u591A\u6587\u6863\u83B7\u53D6\u8BF7\u6C42\uFF0C\u7136\u540E\u5E76\u884C\u8F6C\u53D1\u8FD9\u4E9B\u8BF7\u6C42\u5230\u6258\u7BA1\u5728\u6BCF\u4E2A\u6240\u9700\u7684\u4E3B\u5206\u7247\u6216\u8005\u526F\u672C\u5206\u7247\u7684\u8282\u70B9\u4E0A\u3002\u4E00\u65E6\u6536\u5230\u6240\u6709\u7B54\u590D\uFF0CNode 1 \u6784\u5EFA\u54CD\u5E94\u5E76\u5C06\u5176\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002</li></ol><p>\u53EF\u4EE5\u5BF9docs\u6570\u7EC4\u4E2D\u6BCF\u4E2A\u6587\u6863\u8BBE\u7F6Erouting\u53C2\u6570\u3002</p><p>bulk API\uFF0C \u5141\u8BB8\u5728\u5355\u4E2A\u6279\u91CF\u8BF7\u6C42\u4E2D\u6267\u884C\u591A\u4E2A\u521B\u5EFA\u3001\u7D22\u5F15\u3001\u5220\u9664\u548C\u66F4\u65B0\u8BF7\u6C42\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/83499315a7b8ab81471a88f3e142f0a8.png" alt=""></p><p><strong>bulk API \u6309\u5982\u4E0B\u6B65\u9AA4\u987A\u5E8F\u6267\u884C\uFF1A</strong></p><ol><li>\u5BA2\u6237\u7AEF\u5411Node 1 \u53D1\u9001 bulk\u8BF7\u6C42\u3002</li><li>Node 1\u4E3A\u6BCF\u4E2A\u8282\u70B9\u521B\u5EFA\u4E00\u4E2A\u6279\u91CF\u8BF7\u6C42\uFF0C\u5E76\u5C06\u8FD9\u4E9B\u8BF7\u6C42\u5E76\u884C\u8F6C\u53D1\u5230\u6BCF\u4E2A\u5305\u542B\u4E3B\u5206\u7247\u7684\u8282\u70B9\u4E3B\u673A\u3002</li><li>\u4E3B\u5206\u7247\u4E00\u4E2A\u63A5\u4E00\u4E2A\u6309\u987A\u5E8F\u6267\u884C\u6BCF\u4E2A\u64CD\u4F5C\u3002\u5F53\u6BCF\u4E2A\u64CD\u4F5C\u6210\u529F\u65F6,\u4E3B\u5206\u7247\u5E76\u884C\u8F6C\u53D1\u65B0\u6587\u6863\uFF08\u6216\u5220\u9664\uFF09\u5230\u526F\u672C\u5206\u7247\uFF0C\u7136\u540E\u6267\u884C\u4E0B\u4E00\u4E2A\u64CD\u4F5C\u3002\u4E00\u65E6\u6240\u6709\u7684\u526F\u672C\u5206\u7247\u62A5\u544A\u6240\u6709\u64CD\u4F5C\u6210\u529F\uFF0C\u8BE5\u8282\u70B9\u5C06\u5411\u534F\u8C03\u8282\u70B9\u62A5\u544A\u6210\u529F\uFF0C\u534F\u8C03\u8282\u70B9\u5C06\u8FD9\u4E9B\u54CD\u5E94\u6536\u96C6\u6574\u7406\u5E76\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002</li></ol><h3 id="_43-\u8FDB\u9636-\u5012\u6392\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#_43-\u8FDB\u9636-\u5012\u6392\u7D22\u5F15" aria-hidden="true">#</a> 43-\u8FDB\u9636-\u5012\u6392\u7D22\u5F15</h3><p>\u5206\u7247\u662FElasticsearch\u6700\u5C0F\u7684\u5DE5\u4F5C\u5355\u5143\u3002\u4F46\u662F\u7A76\u7ADF\u4EC0\u4E48\u662F\u4E00\u4E2A\u5206\u7247\uFF0C\u5B83\u662F\u5982\u4F55\u5DE5\u4F5C\u7684\uFF1F</p><p>\u4F20\u7EDF\u7684\u6570\u636E\u5E93\u6BCF\u4E2A\u5B57\u6BB5\u5B58\u50A8\u5355\u4E2A\u503C\uFF0C\u4F46\u8FD9\u5BF9\u5168\u6587\u68C0\u7D22\u5E76\u4E0D\u591F\u3002\u6587\u672C\u5B57\u6BB5\u4E2D\u7684\u6BCF\u4E2A\u5355\u8BCD\u9700\u8981\u88AB\u641C\u7D22\uFF0C\u5BF9\u6570\u636E\u5E93\u610F\u5473\u7740\u9700\u8981\u5355\u4E2A\u5B57\u6BB5\u6709\u7D22\u5F15\u591A\u503C\u7684\u80FD\u529B\u3002\u6700\u597D\u7684\u652F\u6301\u662F\u4E00\u4E2A\u5B57\u6BB5\u591A\u4E2A\u503C\u9700\u6C42\u7684\u6570\u636E\u7ED3\u6784\u662F\u5012\u6392\u7D22\u5F15\u3002</p><h4 id="\u5012\u6392\u7D22\u5F15\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u5012\u6392\u7D22\u5F15\u539F\u7406" aria-hidden="true">#</a> \u5012\u6392\u7D22\u5F15\u539F\u7406</h4><p>Elasticsearch\u4F7F\u7528\u4E00\u79CD\u79F0\u4E3A\u5012\u6392\u7D22\u5F15\u7684\u7ED3\u6784\uFF0C\u5B83\u9002\u7528\u4E8E\u5FEB\u901F\u7684\u5168\u6587\u641C\u7D22\u3002</p><p>\u89C1\u5176\u540D\uFF0C\u77E5\u5176\u610F\uFF0C\u6709\u5012\u6392\u7D22\u5F15\uFF0C\u80AF\u5B9A\u4F1A\u5BF9\u5E94\u6709\u6B63\u5411\u7D22\u5F15\u3002\u6B63\u5411\u7D22\u5F15\uFF08forward index\uFF09\uFF0C\u53CD\u5411\u7D22\u5F15\uFF08inverted index\uFF09\u66F4\u719F\u6089\u7684\u540D\u5B57\u662F\u5012\u6392\u7D22\u5F15\u3002</p><p>\u6240\u8C13\u7684<strong>\u6B63\u5411\u7D22\u5F15</strong>\uFF0C\u5C31\u662F\u641C\u7D22\u5F15\u64CE\u4F1A\u5C06\u5F85\u641C\u7D22\u7684\u6587\u4EF6\u90FD\u5BF9\u5E94\u4E00\u4E2A\u6587\u4EF6ID\uFF0C\u641C\u7D22\u65F6\u5C06\u8FD9\u4E2AID\u548C\u641C\u7D22\u5173\u952E\u5B57\u8FDB\u884C\u5BF9\u5E94\uFF0C\u5F62\u6210K-V\u5BF9\uFF0C\u7136\u540E\u5BF9\u5173\u952E\u5B57\u8FDB\u884C\u7EDF\u8BA1\u8BA1\u6570\u3002\uFF08\u7EDF\u8BA1\uFF1F\uFF1F\u4E0B\u6587\u6709\u89E3\u91CA\uFF09</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/cba02cc6d7c5f054dfe5d58fafac9a6a.png" alt=""></p><p>\u4F46\u662F\u4E92\u8054\u7F51\u4E0A\u6536\u5F55\u5728\u641C\u7D22\u5F15\u64CE\u4E2D\u7684\u6587\u6863\u7684\u6570\u76EE\u662F\u4E2A\u5929\u6587\u6570\u5B57\uFF0C\u8FD9\u6837\u7684\u7D22\u5F15\u7ED3\u6784\u6839\u672C\u65E0\u6CD5\u6EE1\u8DB3\u5B9E\u65F6\u8FD4\u56DE\u6392\u540D\u7ED3\u679C\u7684\u8981\u6C42\u3002\u6240\u4EE5\uFF0C\u641C\u7D22\u5F15\u64CE\u4F1A\u5C06\u6B63\u5411\u7D22\u5F15\u91CD\u65B0\u6784\u5EFA\u4E3A\u5012\u6392\u7D22\u5F15\uFF0C\u5373\u628A\u6587\u4EF6ID\u5BF9\u5E94\u5230\u5173\u952E\u8BCD\u7684\u6620\u5C04\u8F6C\u6362\u4E3A\u5173\u952E\u8BCD\u5230\u6587\u4EF6ID\u7684\u6620\u5C04\uFF0C\u6BCF\u4E2A\u5173\u952E\u8BCD\u90FD\u5BF9\u5E94\u7740\u4E00\u7CFB\u5217\u7684\u6587\u4EF6\uFF0C\u8FD9\u4E9B\u6587\u4EF6\u4E2D\u90FD\u51FA\u73B0\u8FD9\u4E2A\u5173\u952E\u8BCD\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/a1f52e96e0ac218b5024d708202afba4.png" alt=""></p><h4 id="\u5012\u6392\u7D22\u5F15\u7684\u4F8B\u5B50" tabindex="-1"><a class="header-anchor" href="#\u5012\u6392\u7D22\u5F15\u7684\u4F8B\u5B50" aria-hidden="true">#</a> \u5012\u6392\u7D22\u5F15\u7684\u4F8B\u5B50</h4><p>\u4E00\u4E2A\u5012\u6392\u7D22\u5F15\u7531\u6587\u6863\u4E2D\u6240\u6709\u4E0D\u91CD\u590D\u8BCD\u7684\u5217\u8868\u6784\u6210\uFF0C\u5BF9\u4E8E\u5176\u4E2D\u6BCF\u4E2A\u8BCD\uFF0C\u6709\u4E00\u4E2A\u5305\u542B\u5B83\u7684\u6587\u6863\u5217\u8868\u3002\u4F8B\u5982\uFF0C\u5047\u8BBE\u6211\u4EEC\u6709\u4E24\u4E2A\u6587\u6863\uFF0C\u6BCF\u4E2A\u6587\u6863\u7684content\u57DF\u5305\u542B\u5982\u4E0B\u5185\u5BB9\uFF1A</p><ul><li>The quick brown fox jumped over the lazy dog</li><li>Quick brown foxes leap over lazy dogs in summer</li></ul><p>\u4E3A\u4E86\u521B\u5EFA\u5012\u6392\u7D22\u5F15\uFF0C\u6211\u4EEC\u9996\u5148\u5C06\u6BCF\u4E2A\u6587\u6863\u7684content\u57DF\u62C6\u5206\u6210\u5355\u72EC\u7684\u8BCD\uFF08\u6211\u4EEC\u79F0\u5B83\u4E3A\u8BCD\u6761\u6216tokens )\uFF0C\u521B\u5EFA\u4E00\u4E2A\u5305\u542B\u6240\u6709\u4E0D\u91CD\u590D\u8BCD\u6761\u7684\u6392\u5E8F\u5217\u8868\uFF0C\u7136\u540E\u5217\u51FA\u6BCF\u4E2A\u8BCD\u6761\u51FA\u73B0\u5728\u54EA\u4E2A\u6587\u6863\u3002\u7ED3\u679C\u5982\u4E0B\u6240\u793A\uFF1A</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/3cc642e9bae776c3e617f9d117d41e21.png" alt=""></p><p>\u73B0\u5728\uFF0C\u5982\u679C\u6211\u4EEC\u60F3\u641C\u7D22 quick brown \uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u67E5\u627E\u5305\u542B\u6BCF\u4E2A\u8BCD\u6761\u7684\u6587\u6863\uFF1A</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/f26aaa01e011edfa68736956b2f1ddea.png" alt=""></p><p>\u4E24\u4E2A\u6587\u6863\u90FD\u5339\u914D\uFF0C\u4F46\u662F\u7B2C\u4E00\u4E2A\u6587\u6863\u6BD4\u7B2C\u4E8C\u4E2A\u5339\u914D\u5EA6\u66F4\u9AD8\u3002\u5982\u679C\u6211\u4EEC\u4F7F\u7528\u4EC5\u8BA1\u7B97\u5339\u914D\u8BCD\u6761\u6570\u91CF\u7684\u7B80\u5355\u76F8\u4F3C\u6027\u7B97\u6CD5\uFF0C\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u8BF4\uFF0C\u5BF9\u4E8E\u6211\u4EEC\u67E5\u8BE2\u7684\u76F8\u5173\u6027\u6765\u8BB2\uFF0C\u7B2C\u4E00\u4E2A\u6587\u6863\u6BD4\u7B2C\u4E8C\u4E2A\u6587\u6863\u66F4\u4F73\u3002</p><p>\u4F46\u662F\uFF0C\u6211\u4EEC\u76EE\u524D\u7684\u5012\u6392\u7D22\u5F15\u6709\u4E00\u4E9B\u95EE\u9898\uFF1A</p><ul><li><p>Quick\u548Cquick\u4EE5\u72EC\u7ACB\u7684\u8BCD\u6761\u51FA\u73B0\uFF0C\u7136\u800C\u7528\u6237\u53EF\u80FD\u8BA4\u4E3A\u5B83\u4EEC\u662F\u76F8\u540C\u7684\u8BCD\u3002</p></li><li><p>fox\u548Cfoxes\u975E\u5E38\u76F8\u4F3C\uFF0C\u5C31\u50CFdog\u548Cdogs\uFF1B\u4ED6\u4EEC\u6709\u76F8\u540C\u7684\u8BCD\u6839\u3002</p></li><li><p>jumped\u548Cleap\uFF0C\u5C3D\u7BA1\u6CA1\u6709\u76F8\u540C\u7684\u8BCD\u6839\uFF0C\u4F46\u4ED6\u4EEC\u7684\u610F\u601D\u5F88\u76F8\u8FD1\u3002\u4ED6\u4EEC\u662F\u540C\u4E49\u8BCD\u3002</p></li></ul><p>\u4F7F\u7528\u524D\u9762\u7684\u7D22\u5F15\u641C\u7D22+Quick +fox\u4E0D\u4F1A\u5F97\u5230\u4EFB\u4F55\u5339\u914D\u6587\u6863\u3002(\u8BB0\u4F4F\uFF0C\uFF0B\u524D\u7F00\u8868\u660E\u8FD9\u4E2A\u8BCD\u5FC5\u987B\u5B58\u5728\uFF09\u3002</p><p>\u53EA\u6709\u540C\u65F6\u51FA\u73B0Quick\u548Cfox \u7684\u6587\u6863\u624D\u6EE1\u8DB3\u8FD9\u4E2A\u67E5\u8BE2\u6761\u4EF6\uFF0C\u4F46\u662F\u7B2C\u4E00\u4E2A\u6587\u6863\u5305\u542Bquick fox \uFF0C\u7B2C\u4E8C\u4E2A\u6587\u6863\u5305\u542BQuick foxes\u3002</p><p>\u6211\u4EEC\u7684\u7528\u6237\u53EF\u4EE5\u5408\u7406\u7684\u671F\u671B\u4E24\u4E2A\u6587\u6863\u4E0E\u67E5\u8BE2\u5339\u914D\u3002\u6211\u4EEC\u53EF\u4EE5\u505A\u7684\u66F4\u597D\u3002</p><p>\u5982\u679C\u6211\u4EEC\u5C06\u8BCD\u6761\u89C4\u8303\u4E3A\u6807\u51C6\u6A21\u5F0F\uFF0C\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u627E\u5230\u4E0E\u7528\u6237\u641C\u7D22\u7684\u8BCD\u6761\u4E0D\u5B8C\u5168\u4E00\u81F4\uFF0C\u4F46\u5177\u6709\u8DB3\u591F\u76F8\u5173\u6027\u7684\u6587\u6863\u3002\u4F8B\u5982\uFF1A</p><ul><li>Quick\u53EF\u4EE5\u5C0F\u5199\u5316\u4E3Aquick\u3002</li><li>foxes\u53EF\u4EE5\u8BCD\u5E72\u63D0\u53D6\u53D8\u4E3A\u8BCD\u6839\u7684\u683C\u5F0F\u4E3Afox\u3002\u7C7B\u4F3C\u7684\uFF0Cdogs\u53EF\u4EE5\u4E3A\u63D0\u53D6\u4E3Adog\u3002</li><li>jumped\u548Cleap\u662F\u540C\u4E49\u8BCD\uFF0C\u53EF\u4EE5\u7D22\u5F15\u4E3A\u76F8\u540C\u7684\u5355\u8BCDjump\u3002</li></ul><p>\u73B0\u5728\u7D22\u5F15\u770B\u4E0A\u53BB\u50CF\u8FD9\u6837\uFF1A</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/19813d1918c89461303377444cf85c8c.png" alt=""></p><p>\u8FD9\u8FD8\u8FDC\u8FDC\u4E0D\u591F\u3002\u6211\u4EEC\u641C\u7D22+Quick +fox \u4ECD\u7136\u4F1A\u5931\u8D25\uFF0C\u56E0\u4E3A\u5728\u6211\u4EEC\u7684\u7D22\u5F15\u4E2D\uFF0C\u5DF2\u7ECF\u6CA1\u6709Quick\u4E86\u3002\u4F46\u662F\uFF0C\u5982\u679C\u6211\u4EEC\u5BF9\u641C\u7D22\u7684\u5B57\u7B26\u4E32\u4F7F\u7528\u4E0Econtent\u57DF\u76F8\u540C\u7684\u6807\u51C6\u5316\u89C4\u5219\uFF0C\u4F1A\u53D8\u6210\u67E5\u8BE2+quick +fox\uFF0C\u8FD9\u6837\u4E24\u4E2A\u6587\u6863\u90FD\u4F1A\u5339\u914D\uFF01\u5206\u8BCD\u548C\u6807\u51C6\u5316\u7684\u8FC7\u7A0B\u79F0\u4E3A\u5206\u6790\uFF0C\u8FD9\u975E\u5E38\u91CD\u8981\u3002\u4F60\u53EA\u80FD\u641C\u7D22\u5728\u7D22\u5F15\u4E2D\u51FA\u73B0\u7684\u8BCD\u6761\uFF0C\u6240\u4EE5\u7D22\u5F15\u6587\u672C\u548C\u67E5\u8BE2\u5B57\u7B26\u4E32\u5FC5\u987B\u6807\u51C6\u5316\u4E3A\u76F8\u540C\u7684\u683C\u5F0F\u3002</p><h3 id="_44-\u8FDB\u9636-\u6587\u6863\u641C\u7D22" tabindex="-1"><a class="header-anchor" href="#_44-\u8FDB\u9636-\u6587\u6863\u641C\u7D22" aria-hidden="true">#</a> 44-\u8FDB\u9636-\u6587\u6863\u641C\u7D22</h3><h4 id="\u4E0D\u53EF\u6539\u53D8\u7684\u5012\u6392\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u4E0D\u53EF\u6539\u53D8\u7684\u5012\u6392\u7D22\u5F15" aria-hidden="true">#</a> \u4E0D\u53EF\u6539\u53D8\u7684\u5012\u6392\u7D22\u5F15</h4><p>\u65E9\u671F\u7684\u5168\u6587\u68C0\u7D22\u4F1A\u4E3A\u6574\u4E2A\u6587\u6863\u96C6\u5408\u5EFA\u7ACB\u4E00\u4E2A\u5F88\u5927\u7684\u5012\u6392\u7D22\u5F15\u5E76\u5C06\u5176\u5199\u5165\u5230\u78C1\u76D8\u3002 \u4E00\u65E6\u65B0\u7684\u7D22\u5F15\u5C31\u7EEA\uFF0C\u65E7\u7684\u5C31\u4F1A\u88AB\u5176\u66FF\u6362\uFF0C\u8FD9\u6837\u6700\u8FD1\u7684\u53D8\u5316\u4FBF\u53EF\u4EE5\u88AB\u68C0\u7D22\u5230\u3002</p><p>\u5012\u6392\u7D22\u5F15\u88AB\u5199\u5165\u78C1\u76D8\u540E\u662F\u4E0D\u53EF\u6539\u53D8\u7684\uFF1A\u5B83\u6C38\u8FDC\u4E0D\u4F1A\u4FEE\u6539\u3002</p><ul><li><p>\u4E0D\u9700\u8981\u9501\u3002\u5982\u679C\u4F60\u4ECE\u6765\u4E0D\u66F4\u65B0\u7D22\u5F15\uFF0C\u4F60\u5C31\u4E0D\u9700\u8981\u62C5\u5FC3\u591A\u8FDB\u7A0B\u540C\u65F6\u4FEE\u6539\u6570\u636E\u7684\u95EE\u9898\u3002</p></li><li><p>\u4E00\u65E6\u7D22\u5F15\u88AB\u8BFB\u5165\u5185\u6838\u7684\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58\uFF0C\u4FBF\u4F1A\u7559\u5728\u54EA\u91CC\uFF0C\u7531\u4E8E\u5176\u4E0D\u53D8\u6027\u3002\u53EA\u8981\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58\u4E2D\u8FD8\u6709\u8DB3\u591F\u7684\u7A7A\u95F4\uFF0C\u90A3\u4E48\u5927\u90E8\u5206\u8BFB\u8BF7\u6C42\u4F1A\u76F4\u63A5\u8BF7\u6C42\u5185\u5B58\uFF0C\u800C\u4E0D\u4F1A\u547D\u4E2D\u78C1\u76D8\u3002\u8FD9\u63D0\u4F9B\u4E86\u5F88\u5927\u7684\u6027\u80FD\u63D0\u5347\u3002</p></li><li><p>\u5176\u5B83\u7F13\u5B58(\u50CFfilter\u7F13\u5B58)\uFF0C\u5728\u7D22\u5F15\u7684\u751F\u547D\u5468\u671F\u5185\u59CB\u7EC8\u6709\u6548\u3002\u5B83\u4EEC\u4E0D\u9700\u8981\u5728\u6BCF\u6B21\u6570\u636E\u6539\u53D8\u65F6\u88AB\u91CD\u5EFA\uFF0C\u56E0\u4E3A\u6570\u636E\u4E0D\u4F1A\u53D8\u5316\u3002</p></li><li><p>\u5199\u5165\u5355\u4E2A\u5927\u7684\u5012\u6392\u7D22\u5F15\u5141\u8BB8\u6570\u636E\u88AB\u538B\u7F29\uFF0C\u51CF\u5C11\u78C1\u76D8IO\u548C\u9700\u8981\u88AB\u7F13\u5B58\u5230\u5185\u5B58\u7684\u7D22\u5F15\u7684\u4F7F\u7528\u91CF\u3002</p></li></ul><p>\u5F53\u7136\uFF0C\u4E00\u4E2A\u4E0D\u53D8\u7684\u7D22\u5F15\u4E5F\u6709\u4E0D\u597D\u7684\u5730\u65B9\u3002\u4E3B\u8981\u4E8B\u5B9E\u662F\u5B83\u662F\u4E0D\u53EF\u53D8\u7684! \u4F60\u4E0D\u80FD\u4FEE\u6539\u5B83\u3002\u5982\u679C\u4F60\u9700\u8981\u8BA9\u4E00\u4E2A\u65B0\u7684\u6587\u6863\u53EF\u88AB\u641C\u7D22\uFF0C\u4F60\u9700\u8981\u91CD\u5EFA\u6574\u4E2A\u7D22\u5F15\u3002\u8FD9\u8981\u4E48\u5BF9\u4E00\u4E2A\u7D22\u5F15\u6240\u80FD\u5305\u542B\u7684\u6570\u636E\u91CF\u9020\u6210\u4E86\u5F88\u5927\u7684\u9650\u5236\uFF0C\u8981\u4E48\u5BF9\u7D22\u5F15\u53EF\u88AB\u66F4\u65B0\u7684\u9891\u7387\u9020\u6210\u4E86\u5F88\u5927\u7684\u9650\u5236\u3002</p><h4 id="\u52A8\u6001\u66F4\u65B0\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u52A8\u6001\u66F4\u65B0\u7D22\u5F15" aria-hidden="true">#</a> \u52A8\u6001\u66F4\u65B0\u7D22\u5F15</h4><p>\u5982\u4F55\u5728\u4FDD\u7559\u4E0D\u53D8\u6027\u7684\u524D\u63D0\u4E0B\u5B9E\u73B0\u5012\u6392\u7D22\u5F15\u7684\u66F4\u65B0\uFF1F</p><p>\u7B54\u6848\u662F\uFF1A\u7528\u66F4\u591A\u7684\u7D22\u5F15\u3002\u901A\u8FC7\u589E\u52A0\u65B0\u7684\u8865\u5145\u7D22\u5F15\u6765\u53CD\u6620\u65B0\u8FD1\u7684\u4FEE\u6539\uFF0C\u800C\u4E0D\u662F\u76F4\u63A5\u91CD\u5199\u6574\u4E2A\u5012\u6392\u7D22\u5F15\u3002\u6BCF\u4E00\u4E2A\u5012\u6392\u7D22\u5F15\u90FD\u4F1A\u88AB\u8F6E\u6D41\u67E5\u8BE2\u5230,\u4ECE\u6700\u65E9\u7684\u5F00\u59CB\u67E5\u8BE2\u5B8C\u540E\u518D\u5BF9\u7ED3\u679C\u8FDB\u884C\u5408\u5E76\u3002</p><p>Elasticsearch\u57FA\u4E8ELucene\uFF0C\u8FD9\u4E2Ajava\u5E93\u5F15\u5165\u4E86<strong>\u6309\u6BB5\u641C\u7D22</strong>\u7684\u6982\u5FF5\u3002\u6BCF\u4E00\u6BB5\u672C\u8EAB\u90FD\u662F\u4E00\u4E2A\u5012\u6392\u7D22\u5F15\uFF0C\u4F46\u7D22\u5F15\u5728 Lucene \u4E2D\u9664\u8868\u793A\u6240\u6709\u6BB5\u7684\u96C6\u5408\u5916\uFF0C\u8FD8\u589E\u52A0\u4E86\u63D0\u4EA4\u70B9\u7684\u6982\u5FF5\u2014\u4E00\u4E2A\u5217\u51FA\u4E86\u6240\u6709\u5DF2\u77E5\u6BB5\u7684\u6587\u4EF6\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/9ee1adbb2d55e710257e01b812a6d8cf.png" alt=""></p><p>\u6309\u6BB5\u641C\u7D22\u4F1A\u4EE5\u5982\u4E0B\u6D41\u7A0B\u6267\u884C\uFF1A</p><p>\u4E00\u3001\u65B0\u6587\u6863\u88AB\u6536\u96C6\u5230\u5185\u5B58\u7D22\u5F15\u7F13\u5B58\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/9d499fde966ee9825fa5a424d8357489.png" alt=""></p><p>\u4E8C\u3001\u4E0D\u65F6\u5730, \u7F13\u5B58\u88AB\u63D0\u4EA4\u3002</p><ol><li>\u4E00\u4E2A\u65B0\u7684\u6BB5\uFF0C\u4E00\u4E2A\u8FFD\u52A0\u7684\u5012\u6392\u7D22\u5F15\uFF0C\u88AB\u5199\u5165\u78C1\u76D8\u3002</li><li>\u4E00\u4E2A\u65B0\u7684\u5305\u542B\u65B0\u6BB5\u540D\u5B57\u7684\u63D0\u4EA4\u70B9\u88AB\u5199\u5165\u78C1\u76D8\u3002</li><li>\u78C1\u76D8\u8FDB\u884C\u540C\u6B65\uFF0C\u6240\u6709\u5728\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58\u4E2D\u7B49\u5F85\u7684\u5199\u5165\u90FD\u5237\u65B0\u5230\u78C1\u76D8\uFF0C\u4EE5\u786E\u4FDD\u5B83\u4EEC\u88AB\u5199\u5165\u7269\u7406\u6587\u4EF6</li></ol><p>\u4E09\u3001\u65B0\u7684\u6BB5\u88AB\u5F00\u542F\uFF0C\u8BA9\u5B83\u5305\u542B\u7684\u6587\u6863\u53EF\u89C1\u4EE5\u88AB\u641C\u7D22\u3002</p><p>\u56DB\u3001\u5185\u5B58\u7F13\u5B58\u88AB\u6E05\u7A7A\uFF0C\u7B49\u5F85\u63A5\u6536\u65B0\u7684\u6587\u6863\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/f74828ff58cc4635a97e88706a221e50.png" alt=""></p><p>\u5F53\u4E00\u4E2A\u67E5\u8BE2\u88AB\u89E6\u53D1\uFF0C\u6240\u6709\u5DF2\u77E5\u7684\u6BB5\u6309\u987A\u5E8F\u88AB\u67E5\u8BE2\u3002\u8BCD\u9879\u7EDF\u8BA1\u4F1A\u5BF9\u6240\u6709\u6BB5\u7684\u7ED3\u679C\u8FDB\u884C\u805A\u5408\uFF0C\u4EE5\u4FDD\u8BC1\u6BCF\u4E2A\u8BCD\u548C\u6BCF\u4E2A\u6587\u6863\u7684\u5173\u8054\u90FD\u88AB\u51C6\u786E\u8BA1\u7B97\u3002\u8FD9\u79CD\u65B9\u5F0F\u53EF\u4EE5\u7528\u76F8\u5BF9\u8F83\u4F4E\u7684\u6210\u672C\u5C06\u65B0\u6587\u6863\u6DFB\u52A0\u5230\u7D22\u5F15\u3002</p><p>\u6BB5\u662F\u4E0D\u53EF\u6539\u53D8\u7684\uFF0C\u6240\u4EE5\u65E2\u4E0D\u80FD\u4ECE\u628A\u6587\u6863\u4ECE\u65E7\u7684\u6BB5\u4E2D\u79FB\u9664\uFF0C\u4E5F\u4E0D\u80FD\u4FEE\u6539\u65E7\u7684\u6BB5\u6765\u8FDB\u884C\u53CD\u6620\u6587\u6863\u7684\u66F4\u65B0\u3002\u53D6\u800C\u4EE3\u4E4B\u7684\u662F\uFF0C\u6BCF\u4E2A\u63D0\u4EA4\u70B9\u4F1A\u5305\u542B\u4E00\u4E2A.del \u6587\u4EF6\uFF0C\u6587\u4EF6\u4E2D\u4F1A\u5217\u51FA\u8FD9\u4E9B\u88AB\u5220\u9664\u6587\u6863\u7684\u6BB5\u4FE1\u606F\u3002</p><p>\u5F53\u4E00\u4E2A**\u6587\u6863\u88AB\u201C\u5220\u9664\u201D**\u65F6\uFF0C\u5B83\u5B9E\u9645\u4E0A\u53EA\u662F\u5728 .del \u6587\u4EF6\u4E2D\u88AB\u6807\u8BB0\u5220\u9664\u3002\u4E00\u4E2A\u88AB\u6807\u8BB0\u5220\u9664\u7684\u6587\u6863\u4ECD\u7136\u53EF\u4EE5\u88AB\u67E5\u8BE2\u5339\u914D\u5230\uFF0C\u4F46\u5B83\u4F1A\u5728\u6700\u7EC8\u7ED3\u679C\u88AB\u8FD4\u56DE\u524D\u4ECE\u7ED3\u679C\u96C6\u4E2D\u79FB\u9664\u3002</p><p><strong>\u6587\u6863\u66F4\u65B0</strong>\u4E5F\u662F\u7C7B\u4F3C\u7684\u64CD\u4F5C\u65B9\u5F0F:\u5F53\u4E00\u4E2A\u6587\u6863\u88AB\u66F4\u65B0\u65F6\uFF0C\u65E7\u7248\u672C\u6587\u6863\u88AB\u6807\u8BB0\u5220\u9664\uFF0C\u6587\u6863\u7684\u65B0\u7248\u672C\u88AB\u7D22\u5F15\u5230\u4E00\u4E2A\u65B0\u7684\u6BB5\u4E2D\u3002\u53EF\u80FD\u4E24\u4E2A\u7248\u672C\u7684\u6587\u6863\u90FD\u4F1A\u88AB\u4E00\u4E2A\u67E5\u8BE2\u5339\u914D\u5230\uFF0C\u4F46\u88AB\u5220\u9664\u7684\u90A3\u4E2A\u65E7\u7248\u672C\u6587\u6863\u5728\u7ED3\u679C\u96C6\u8FD4\u56DE\u524D\u5C31\u5DF2\u7ECF\u88AB\u79FB\u9664\u3002</p><h3 id="_45-\u8FDB\u9636-\u6587\u6863\u5237\u65B0-\u6587\u6863\u5237\u5199-\u6587\u6863\u5408\u5E76" tabindex="-1"><a class="header-anchor" href="#_45-\u8FDB\u9636-\u6587\u6863\u5237\u65B0-\u6587\u6863\u5237\u5199-\u6587\u6863\u5408\u5E76" aria-hidden="true">#</a> 45-\u8FDB\u9636-\u6587\u6863\u5237\u65B0 &amp; \u6587\u6863\u5237\u5199 &amp; \u6587\u6863\u5408\u5E76</h3><p><img src="https://qiniu.xinghe.fit/Elasticsearch/b3b31c1e592d5aa794e7c9fcb259c924.png" alt=""></p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/521c25f0f16247240234d1b8eb3c5f25.png" alt=""></p><h4 id="\u8FD1\u5B9E\u65F6\u641C\u7D22" tabindex="-1"><a class="header-anchor" href="#\u8FD1\u5B9E\u65F6\u641C\u7D22" aria-hidden="true">#</a> \u8FD1\u5B9E\u65F6\u641C\u7D22</h4><p>\u968F\u7740\u6309\u6BB5\uFF08per-segment\uFF09\u641C\u7D22\u7684\u53D1\u5C55\uFF0C\u4E00\u4E2A\u65B0\u7684\u6587\u6863\u4ECE\u7D22\u5F15\u5230\u53EF\u88AB\u641C\u7D22\u7684\u5EF6\u8FDF\u663E\u8457\u964D\u4F4E\u4E86\u3002\u65B0\u6587\u6863\u5728\u51E0\u5206\u949F\u4E4B\u5185\u5373\u53EF\u88AB\u68C0\u7D22\uFF0C\u4F46\u8FD9\u6837\u8FD8\u662F\u4E0D\u591F\u5FEB\u3002\u78C1\u76D8\u5728\u8FD9\u91CC\u6210\u4E3A\u4E86\u74F6\u9888\u3002<strong>\u63D0\u4EA4\uFF08Commiting\uFF09\u4E00\u4E2A\u65B0\u7684\u6BB5\u5230\u78C1\u76D8\u9700\u8981\u4E00\u4E2Afsync\u6765\u786E\u4FDD\u6BB5\u88AB\u7269\u7406\u6027\u5730\u5199\u5165\u78C1\u76D8</strong>\uFF0C\u8FD9\u6837\u5728\u65AD\u7535\u7684\u65F6\u5019\u5C31\u4E0D\u4F1A\u4E22\u5931\u6570\u636E\u3002\u4F46\u662Ffsync\u64CD\u4F5C\u4EE3\u4EF7\u5F88\u5927\uFF1B\u5982\u679C\u6BCF\u6B21\u7D22\u5F15\u4E00\u4E2A\u6587\u6863\u90FD\u53BB\u6267\u884C\u4E00\u6B21\u7684\u8BDD\u4F1A\u9020\u6210\u5F88\u5927\u7684\u6027\u80FD\u95EE\u9898\u3002</p><p>\u6211\u4EEC\u9700\u8981\u7684\u662F\u4E00\u4E2A\u66F4\u8F7B\u91CF\u7684\u65B9\u5F0F\u6765\u4F7F\u4E00\u4E2A\u6587\u6863\u53EF\u88AB\u641C\u7D22\uFF0C\u8FD9\u610F\u5473\u7740fsync\u8981\u4ECE\u6574\u4E2A\u8FC7\u7A0B\u4E2D\u88AB\u79FB\u9664\u3002\u5728Elasticsearch\u548C\u78C1\u76D8\u4E4B\u95F4\u662F<strong>\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58</strong>\u3002\u50CF\u4E4B\u524D\u63CF\u8FF0\u7684\u4E00\u6837\uFF0C\u5728\u5185\u5B58\u7D22\u5F15\u7F13\u51B2\u533A\u4E2D\u7684\u6587\u6863\u4F1A\u88AB\u5199\u5165\u5230\u4E00\u4E2A\u65B0\u7684\u6BB5\u4E2D\u3002\u4F46\u662F\u8FD9\u91CC\u65B0\u6BB5\u4F1A\u88AB\u5148\u5199\u5165\u5230\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58\u2014\u8FD9\u4E00\u6B65\u4EE3\u4EF7\u4F1A\u6BD4\u8F83\u4F4E\uFF0C\u7A0D\u540E\u518D\u88AB\u5237\u65B0\u5230\u78C1\u76D8\u2014\u8FD9\u4E00\u6B65\u4EE3\u4EF7\u6BD4\u8F83\u9AD8\u3002\u4E0D\u8FC7\u53EA\u8981\u6587\u4EF6\u5DF2\u7ECF\u5728\u7F13\u5B58\u4E2D\uFF0C\u5C31\u53EF\u4EE5\u50CF\u5176\u5B83\u6587\u4EF6\u4E00\u6837\u88AB\u6253\u5F00\u548C\u8BFB\u53D6\u4E86\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/a679d4f5f4bfa6913a53316251beef2a.png" alt=""></p><p>Lucene\u5141\u8BB8\u65B0\u6BB5\u88AB\u5199\u5165\u548C\u6253\u5F00\uFF0C\u4F7F\u5176\u5305\u542B\u7684\u6587\u6863\u5728\u672A\u8FDB\u884C\u4E00\u6B21\u5B8C\u6574\u63D0\u4EA4\u65F6\u4FBF\u5BF9\u641C\u7D22\u53EF\u89C1\u3002\u8FD9\u79CD\u65B9\u5F0F\u6BD4\u8FDB\u884C\u4E00\u6B21\u63D0\u4EA4\u4EE3\u4EF7\u8981\u5C0F\u5F97\u591A\uFF0C\u5E76\u4E14\u5728\u4E0D\u5F71\u54CD\u6027\u80FD\u7684\u524D\u63D0\u4E0B\u53EF\u4EE5\u88AB\u9891\u7E41\u5730\u6267\u884C\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/673d3a77e254fa3a5a6f5293ffb125ab.png" alt=""></p><p>\u5728 Elasticsearch \u4E2D\uFF0C\u5199\u5165\u548C\u6253\u5F00\u4E00\u4E2A\u65B0\u6BB5\u7684\u8F7B\u91CF\u7684\u8FC7\u7A0B\u53EB\u505Arefresh\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u6BCF\u4E2A\u5206\u7247\u4F1A\u6BCF\u79D2\u81EA\u52A8\u5237\u65B0\u4E00\u6B21\u3002\u8FD9\u5C31\u662F\u4E3A\u4EC0\u4E48\u6211\u4EEC\u8BF4 Elasticsearch\u662F\u8FD1\u5B9E\u65F6\u641C\u7D22\uFF1A\u6587\u6863\u7684\u53D8\u5316\u5E76\u4E0D\u662F\u7ACB\u5373\u5BF9\u641C\u7D22\u53EF\u89C1\uFF0C\u4F46\u4F1A\u5728\u4E00\u79D2\u4E4B\u5185\u53D8\u4E3A\u53EF\u89C1\u3002</p><p>\u8FD9\u4E9B\u884C\u4E3A\u53EF\u80FD\u4F1A\u5BF9\u65B0\u7528\u6237\u9020\u6210\u56F0\u60D1\uFF1A\u4ED6\u4EEC\u7D22\u5F15\u4E86\u4E00\u4E2A\u6587\u6863\u7136\u540E\u5C1D\u8BD5\u641C\u7D22\u5B83\uFF0C\u4F46\u5374\u6CA1\u6709\u641C\u5230\u3002\u8FD9\u4E2A\u95EE\u9898\u7684\u89E3\u51B3\u529E\u6CD5\u662F\u7528refresh API\u6267\u884C\u4E00\u6B21\u624B\u52A8\u5237\u65B0\uFF1A/usersl_refresh</p><p>\u5C3D\u7BA1\u5237\u65B0\u662F\u6BD4\u63D0\u4EA4\u8F7B\u91CF\u5F88\u591A\u7684\u64CD\u4F5C\uFF0C\u5B83\u8FD8\u662F\u4F1A\u6709\u6027\u80FD\u5F00\u9500\u3002\u5F53\u5199\u6D4B\u8BD5\u7684\u65F6\u5019\uFF0C\u624B\u52A8\u5237\u65B0\u5F88\u6709\u7528\uFF0C\u4F46\u662F\u4E0D\u8981\u5728\u751F\u4EA7\u73AF\u5883\u4E0B\u6BCF\u6B21\u7D22\u5F15\u4E00\u4E2A\u6587\u6863\u90FD\u53BB\u624B\u52A8\u5237\u65B0\u3002\u76F8\u53CD\uFF0C\u4F60\u7684\u5E94\u7528\u9700\u8981\u610F\u8BC6\u5230Elasticsearch \u7684\u8FD1\u5B9E\u65F6\u7684\u6027\u8D28\uFF0C\u5E76\u63A5\u53D7\u5B83\u7684\u4E0D\u8DB3\u3002</p><p>\u5E76\u4E0D\u662F\u6240\u6709\u7684\u60C5\u51B5\u90FD\u9700\u8981\u6BCF\u79D2\u5237\u65B0\u3002\u53EF\u80FD\u4F60\u6B63\u5728\u4F7F\u7528Elasticsearch\u7D22\u5F15\u5927\u91CF\u7684\u65E5\u5FD7\u6587\u4EF6\uFF0C\u4F60\u53EF\u80FD\u60F3\u4F18\u5316\u7D22\u5F15\u901F\u5EA6\u800C\u4E0D\u662F\u8FD1\u5B9E\u65F6\u641C\u7D22\uFF0C\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6Erefresh_interval \uFF0C\u964D\u4F4E\u6BCF\u4E2A\u7D22\u5F15\u7684\u5237\u65B0\u9891\u7387</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    	<span class="token property">&quot;refresh_interval&quot;</span><span class="token operator">:</span> <span class="token string">&quot;30s&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>refresh_interval\u53EF\u4EE5\u5728\u65E2\u5B58\u7D22\u5F15\u4E0A\u8FDB\u884C\u52A8\u6001\u66F4\u65B0\u3002\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u5F53\u4F60\u6B63\u5728\u5EFA\u7ACB\u4E00\u4E2A\u5927\u7684\u65B0\u7D22\u5F15\u65F6\uFF0C\u53EF\u4EE5\u5148\u5173\u95ED\u81EA\u52A8\u5237\u65B0\uFF0C\u5F85\u5F00\u59CB\u4F7F\u7528\u8BE5\u7D22\u5F15\u65F6\uFF0C\u518D\u628A\u5B83\u4EEC\u8C03\u56DE\u6765\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># \u5173\u95ED\u81EA\u52A8\u5237\u65B0
PUT /users/_settings
<span class="token punctuation">{</span> <span class="token property">&quot;refresh_interval&quot;</span><span class="token operator">:</span> <span class="token number">-1</span> <span class="token punctuation">}</span>

# \u6BCF\u4E00\u79D2\u5237\u65B0
PUT /users/_settings
<span class="token punctuation">{</span> <span class="token property">&quot;refresh_interval&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1s&quot;</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6301\u4E45\u5316\u53D8\u66F4" tabindex="-1"><a class="header-anchor" href="#\u6301\u4E45\u5316\u53D8\u66F4" aria-hidden="true">#</a> \u6301\u4E45\u5316\u53D8\u66F4</h4><p>\u5982\u679C\u6CA1\u6709\u7528fsync\u628A\u6570\u636E\u4ECE\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58\u5237\uFF08flush\uFF09\u5230\u786C\u76D8\uFF0C\u6211\u4EEC\u4E0D\u80FD\u4FDD\u8BC1\u6570\u636E\u5728\u65AD\u7535\u751A\u81F3\u662F\u7A0B\u5E8F\u6B63\u5E38\u9000\u51FA\u4E4B\u540E\u4F9D\u7136\u5B58\u5728\u3002\u4E3A\u4E86\u4FDD\u8BC1Elasticsearch \u7684\u53EF\u9760\u6027\uFF0C\u9700\u8981\u786E\u4FDD\u6570\u636E\u53D8\u5316\u88AB\u6301\u4E45\u5316\u5230\u78C1\u76D8\u3002\u5728\u52A8\u6001\u66F4\u65B0\u7D22\u5F15\uFF0C\u6211\u4EEC\u8BF4\u4E00\u6B21\u5B8C\u6574\u7684\u63D0\u4EA4\u4F1A\u5C06\u6BB5\u5237\u5230\u78C1\u76D8\uFF0C\u5E76\u5199\u5165\u4E00\u4E2A\u5305\u542B\u6240\u6709\u6BB5\u5217\u8868\u7684\u63D0\u4EA4\u70B9\u3002Elasticsearch \u5728\u542F\u52A8\u6216\u91CD\u65B0\u6253\u5F00\u4E00\u4E2A\u7D22\u5F15\u7684\u8FC7\u7A0B\u4E2D\u4F7F\u7528\u8FD9\u4E2A\u63D0\u4EA4\u70B9\u6765\u5224\u65AD\u54EA\u4E9B\u6BB5\u96B6\u5C5E\u4E8E\u5F53\u524D\u5206\u7247\u3002</p><p>\u5373\u4F7F\u901A\u8FC7\u6BCF\u79D2\u5237\u65B0(refresh\uFF09\u5B9E\u73B0\u4E86\u8FD1\u5B9E\u65F6\u641C\u7D22\uFF0C\u6211\u4EEC\u4ECD\u7136\u9700\u8981\u7ECF\u5E38\u8FDB\u884C\u5B8C\u6574\u63D0\u4EA4\u6765\u786E\u4FDD\u80FD\u4ECE\u5931\u8D25\u4E2D\u6062\u590D\u3002\u4F46\u5728\u4E24\u6B21\u63D0\u4EA4\u4E4B\u95F4\u53D1\u751F\u53D8\u5316\u7684\u6587\u6863\u600E\u4E48\u529E?\u6211\u4EEC\u4E5F\u4E0D\u5E0C\u671B\u4E22\u5931\u6389\u8FD9\u4E9B\u6570\u636E\u3002Elasticsearch \u589E\u52A0\u4E86\u4E00\u4E2Atranslog \uFF0C\u6216\u8005\u53EB\u4E8B\u52A1\u65E5\u5FD7\uFF0C\u5728\u6BCF\u4E00\u6B21\u5BF9Elasticsearch\u8FDB\u884C\u64CD\u4F5C\u65F6\u5747\u8FDB\u884C\u4E86\u65E5\u5FD7\u8BB0\u5F55\u3002</p><p>\u6574\u4E2A\u6D41\u7A0B\u5982\u4E0B:</p><p>\u4E00\u3001\u4E00\u4E2A\u6587\u6863\u88AB\u7D22\u5F15\u4E4B\u540E\uFF0C\u5C31\u4F1A\u88AB\u6DFB\u52A0\u5230\u5185\u5B58\u7F13\u51B2\u533A\uFF0C\u5E76\u4E14\u8FFD\u52A0\u5230\u4E86 translog</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/baeab48c8d6b87660ac4fb954e9c9731.png" alt=""></p><p>\u4E8C\u3001\u5237\u65B0\uFF08refresh\uFF09\u4F7F\u5206\u7247\u6BCF\u79D2\u88AB\u5237\u65B0\uFF08refresh\uFF09\u4E00\u6B21\uFF1A</p><ul><li>\u8FD9\u4E9B\u5728\u5185\u5B58\u7F13\u51B2\u533A\u7684\u6587\u6863\u88AB\u5199\u5165\u5230\u4E00\u4E2A\u65B0\u7684\u6BB5\u4E2D\uFF0C\u4E14\u6CA1\u6709\u8FDB\u884Cfsync\u64CD\u4F5C\u3002</li><li>\u8FD9\u4E2A\u6BB5\u88AB\u6253\u5F00\uFF0C\u4F7F\u5176\u53EF\u88AB\u641C\u7D22\u3002</li><li>\u5185\u5B58\u7F13\u51B2\u533A\u88AB\u6E05\u7A7A\u3002</li></ul><p><img src="https://qiniu.xinghe.fit/Elasticsearch/17be4247e6b23f31b1e589c70d61e817.png" alt=""></p><p>\u4E09\u3001\u8FD9\u4E2A\u8FDB\u7A0B\u7EE7\u7EED\u5DE5\u4F5C\uFF0C\u66F4\u591A\u7684\u6587\u6863\u88AB\u6DFB\u52A0\u5230\u5185\u5B58\u7F13\u51B2\u533A\u548C\u8FFD\u52A0\u5230\u4E8B\u52A1\u65E5\u5FD7\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/4b5c4a3a3ffb4c84625bb283f6a67018.png" alt=""></p><p>\u56DB\u3001\u6BCF\u9694\u4E00\u6BB5\u65F6\u95F4\u2014\u4F8B\u5982translog\u53D8\u5F97\u8D8A\u6765\u8D8A\u5927\uFF0C\u7D22\u5F15\u88AB\u5237\u65B0\uFF08flush\uFF09\uFF1B\u4E00\u4E2A\u65B0\u7684translog\u88AB\u521B\u5EFA\uFF0C\u5E76\u4E14\u4E00\u4E2A\u5168\u91CF\u63D0\u4EA4\u88AB\u6267\u884C\u3002</p><ul><li><p>\u6240\u6709\u5728\u5185\u5B58\u7F13\u51B2\u533A\u7684\u6587\u6863\u90FD\u88AB\u5199\u5165\u4E00\u4E2A\u65B0\u7684\u6BB5\u3002</p></li><li><p>\u7F13\u51B2\u533A\u88AB\u6E05\u7A7A\u3002</p></li><li><p>\u4E00\u4E2A\u63D0\u4EA4\u70B9\u88AB\u5199\u5165\u786C\u76D8\u3002</p></li><li><p>\u6587\u4EF6\u7CFB\u7EDF\u7F13\u5B58\u901A\u8FC7fsync\u88AB\u5237\u65B0\uFF08flush\uFF09 \u3002</p></li><li><p>\u8001\u7684translog\u88AB\u5220\u9664\u3002</p></li></ul><p>translog \u63D0\u4F9B\u6240\u6709\u8FD8\u6CA1\u6709\u88AB\u5237\u5230\u78C1\u76D8\u7684\u64CD\u4F5C\u7684\u4E00\u4E2A\u6301\u4E45\u5316\u7EAA\u5F55\u3002\u5F53Elasticsearch\u542F\u52A8\u7684\u65F6\u5019\uFF0C\u5B83\u4F1A\u4ECE\u78C1\u76D8\u4E2D\u4F7F\u7528\u6700\u540E\u4E00\u4E2A\u63D0\u4EA4\u70B9\u53BB\u6062\u590D\u5DF1\u77E5\u7684\u6BB5\uFF0C\u5E76\u4E14\u4F1A\u91CD\u653Etranslog \u4E2D\u6240\u6709\u5728\u6700\u540E\u4E00\u6B21\u63D0\u4EA4\u540E\u53D1\u751F\u7684\u53D8\u66F4\u64CD\u4F5C\u3002</p><p>translog \u4E5F\u88AB\u7528\u6765\u63D0\u4F9B\u5B9E\u65F6CRUD\u3002\u5F53\u4F60\u8BD5\u7740\u901A\u8FC7ID\u67E5\u8BE2\u3001\u66F4\u65B0\u3001\u5220\u9664\u4E00\u4E2A\u6587\u6863\uFF0C\u5B83\u4F1A\u5728\u5C1D\u8BD5\u4ECE\u76F8\u5E94\u7684\u6BB5\u4E2D\u68C0\u7D22\u4E4B\u524D\uFF0C\u9996\u5148\u68C0\u67E5 translog\u4EFB\u4F55\u6700\u8FD1\u7684\u53D8\u66F4\u3002\u8FD9\u610F\u5473\u7740\u5B83\u603B\u662F\u80FD\u591F\u5B9E\u65F6\u5730\u83B7\u53D6\u5230\u6587\u6863\u7684\u6700\u65B0\u7248\u672C\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/11c7d2cc05244e669eb8402dd8049de9.png" alt=""></p><p>\u6267\u884C\u4E00\u4E2A\u63D0\u4EA4\u5E76\u4E14\u622A\u65ADtranslog \u7684\u884C\u4E3A\u5728 Elasticsearch\u88AB\u79F0\u4F5C\u4E00\u6B21flush\u3002\u5206\u7247\u6BCF30\u5206\u949F\u88AB\u81EA\u52A8\u5237\u65B0\uFF08flush)\uFF0C\u6216\u8005\u5728 translog \u592A\u5927\u7684\u65F6\u5019\u4E5F\u4F1A\u5237\u65B0\u3002</p><p>\u4F60\u5F88\u5C11\u9700\u8981\u81EA\u5DF1\u624B\u52A8\u6267\u884Cflush\u64CD\u4F5C\uFF0C\u901A\u5E38\u60C5\u51B5\u4E0B\uFF0C\u81EA\u52A8\u5237\u65B0\u5C31\u8DB3\u591F\u4E86\u3002\u8FD9\u5C31\u662F\u8BF4\uFF0C\u5728\u91CD\u542F\u8282\u70B9\u6216\u5173\u95ED\u7D22\u5F15\u4E4B\u524D\u6267\u884C flush\u6709\u76CA\u4E8E\u4F60\u7684\u7D22\u5F15\u3002\u5F53Elasticsearch\u5C1D\u8BD5\u6062\u590D\u6216\u91CD\u65B0\u6253\u5F00\u4E00\u4E2A\u7D22\u5F15\uFF0C\u5B83\u9700\u8981\u91CD\u653Etranslog\u4E2D\u6240\u6709\u7684\u64CD\u4F5C\uFF0C\u6240\u4EE5\u5982\u679C\u65E5\u5FD7\u8D8A\u77ED\uFF0C\u6062\u590D\u8D8A\u5FEB\u3002</p><p>translog \u7684\u76EE\u7684\u662F\u4FDD\u8BC1\u64CD\u4F5C\u4E0D\u4F1A\u4E22\u5931\uFF0C\u5728\u6587\u4EF6\u88ABfsync\u5230\u78C1\u76D8\u524D\uFF0C\u88AB\u5199\u5165\u7684\u6587\u4EF6\u5728\u91CD\u542F\u4E4B\u540E\u5C31\u4F1A\u4E22\u5931\u3002\u9ED8\u8BA4translog\u662F\u6BCF5\u79D2\u88ABfsync\u5237\u65B0\u5230\u786C\u76D8\uFF0C\u6216\u8005\u5728\u6BCF\u6B21\u5199\u8BF7\u6C42\u5B8C\u6210\u4E4B\u540E\u6267\u884C\uFF08e.g. index, delete, update, bulk\uFF09\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u5728\u4E3B\u5206\u7247\u548C\u590D\u5236\u5206\u7247\u90FD\u4F1A\u53D1\u751F\u3002\u6700\u7EC8\uFF0C\u57FA\u672C\u4E0A\uFF0C\u8FD9\u610F\u5473\u7740\u5728\u6574\u4E2A\u8BF7\u6C42\u88ABfsync\u5230\u4E3B\u5206\u7247\u548C\u590D\u5236\u5206\u7247\u7684translog\u4E4B\u524D\uFF0C\u4F60\u7684\u5BA2\u6237\u7AEF\u4E0D\u4F1A\u5F97\u5230\u4E00\u4E2A200 OK\u54CD\u5E94\u3002</p><p>\u5728\u6BCF\u6B21\u8BF7\u6C42\u540E\u90FD\u6267\u884C\u4E00\u4E2Afsync\u4F1A\u5E26\u6765\u4E00\u4E9B\u6027\u80FD\u635F\u5931\uFF0C\u5C3D\u7BA1\u5B9E\u8DF5\u8868\u660E\u8FD9\u79CD\u635F\u5931\u76F8\u5BF9\u8F83\u5C0F\uFF08\u7279\u522B\u662F bulk \u5BFC\u5165\uFF0C\u5B83\u5728\u4E00\u6B21\u8BF7\u6C42\u4E2D\u5E73\u644A\u4E86\u5927\u91CF\u6587\u6863\u7684\u5F00\u9500\uFF09\u3002</p><p>\u4F46\u662F\u5BF9\u4E8E\u4E00\u4E9B\u5927\u5BB9\u91CF\u7684\u5076\u5C14\u4E22\u5931\u51E0\u79D2\u6570\u636E\u95EE\u9898\u4E5F\u5E76\u4E0D\u4E25\u91CD\u7684\u96C6\u7FA4\uFF0C\u4F7F\u7528\u5F02\u6B65\u7684 fsync\u8FD8\u662F\u6BD4\u8F83\u6709\u76CA\u7684\u3002\u6BD4\u5982\uFF0C\u5199\u5165\u7684\u6570\u636E\u88AB\u7F13\u5B58\u5230\u5185\u5B58\u4E2D\uFF0C\u518D\u6BCF5\u79D2\u6267\u884C\u4E00\u6B21 fsync \u3002\u5982\u679C\u4F60\u51B3\u5B9A\u4F7F\u7528\u5F02\u6B65translog \u7684\u8BDD\uFF0C\u4F60\u9700\u8981\u4FDD\u8BC1\u5728\u53D1\u751F crash \u65F6\uFF0C\u4E22\u5931\u6389 sync_interval\u65F6\u95F4\u6BB5\u7684\u6570\u636E\u4E5F\u65E0\u6240\u8C13\u3002\u8BF7\u5728\u51B3\u5B9A\u524D\u77E5\u6653\u8FD9\u4E2A\u7279\u6027\u3002\u5982\u679C\u4F60\u4E0D\u786E\u5B9A\u8FD9\u4E2A\u884C\u4E3A\u7684\u540E\u679C\uFF0C\u6700\u597D\u662F\u4F7F\u7528\u9ED8\u8BA4\u7684\u53C2\u6570{\u201Cindex.translog.durability\u201D: \u201Crequest\u201D}\u6765\u907F\u514D\u6570\u636E\u4E22\u5931\u3002</p><h4 id="\u6BB5\u5408\u5E76" tabindex="-1"><a class="header-anchor" href="#\u6BB5\u5408\u5E76" aria-hidden="true">#</a> \u6BB5\u5408\u5E76</h4><p>\u7531\u4E8E\u81EA\u52A8\u5237\u65B0\u6D41\u7A0B\u6BCF\u79D2\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6BB5\uFF0C\u8FD9\u6837\u4F1A\u5BFC\u81F4\u77ED\u65F6\u95F4\u5185\u7684\u6BB5\u6570\u91CF\u66B4\u589E\u3002\u800C\u6BB5\u6570\u76EE\u592A\u591A\u4F1A\u5E26\u6765\u8F83\u5927\u7684\u9EBB\u70E6\u3002\u6BCF\u4E00\u4E2A\u6BB5\u90FD\u4F1A\u6D88\u8017\u6587\u4EF6\u53E5\u67C4\u3001\u5185\u5B58\u548C cpu\u8FD0\u884C\u5468\u671F\u3002\u66F4\u91CD\u8981\u7684\u662F\uFF0C\u6BCF\u4E2A\u641C\u7D22\u8BF7\u6C42\u90FD\u5FC5\u987B\u8F6E\u6D41\u68C0\u67E5\u6BCF\u4E2A\u6BB5\uFF1B\u6240\u4EE5\u6BB5\u8D8A\u591A\uFF0C\u641C\u7D22\u4E5F\u5C31\u8D8A\u6162\u3002</p><p>Elasticsearch\u901A\u8FC7\u5728\u540E\u53F0\u8FDB\u884C\u6BB5\u5408\u5E76\u6765\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u3002\u5C0F\u7684\u6BB5\u88AB\u5408\u5E76\u5230\u5927\u7684\u6BB5\uFF0C\u7136\u540E\u8FD9\u4E9B\u5927\u7684\u6BB5\u518D\u88AB\u5408\u5E76\u5230\u66F4\u5927\u7684\u6BB5\u3002</p><p>\u6BB5\u5408\u5E76\u7684\u65F6\u5019\u4F1A\u5C06\u90A3\u4E9B\u65E7\u7684\u5DF2\u5220\u9664\u6587\u6863\u4ECE\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u6E05\u9664\u3002\u88AB\u5220\u9664\u7684\u6587\u6863\uFF08\u6216\u88AB\u66F4\u65B0\u6587\u6863\u7684\u65E7\u7248\u672C\uFF09\u4E0D\u4F1A\u88AB\u62F7\u8D1D\u5230\u65B0\u7684\u5927\u6BB5\u4E2D\u3002</p><p>\u542F\u52A8\u6BB5\u5408\u5E76\u4E0D\u9700\u8981\u4F60\u505A\u4EFB\u4F55\u4E8B\u3002\u8FDB\u884C\u7D22\u5F15\u548C\u641C\u7D22\u65F6\u4F1A\u81EA\u52A8\u8FDB\u884C\u3002</p><p>\u4E00\u3001\u5F53\u7D22\u5F15\u7684\u65F6\u5019\uFF0C\u5237\u65B0\uFF08refresh\uFF09\u64CD\u4F5C\u4F1A\u521B\u5EFA\u65B0\u7684\u6BB5\u5E76\u5C06\u6BB5\u6253\u5F00\u4EE5\u4F9B\u641C\u7D22\u4F7F\u7528\u3002</p><p>\u4E8C\u3001\u5408\u5E76\u8FDB\u7A0B\u9009\u62E9\u4E00\u5C0F\u90E8\u5206\u5927\u5C0F\u76F8\u4F3C\u7684\u6BB5\uFF0C\u5E76\u4E14\u5728\u540E\u53F0\u5C06\u5B83\u4EEC\u5408\u5E76\u5230\u66F4\u5927\u7684\u6BB5\u4E2D\u3002\u8FD9\u5E76\u4E0D\u4F1A\u4E2D\u65AD\u7D22\u5F15\u548C\u641C\u7D22\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/c907ca35bd7c0393d46aec2c7038af19.png" alt=""></p><p>\u4E09\u3001\u4E00\u65E6\u5408\u5E76\u7ED3\u675F\uFF0C\u8001\u7684\u6BB5\u88AB\u5220\u9664</p><ul><li>\u65B0\u7684\u6BB5\u88AB\u5237\u65B0(flush)\u5230\u4E86\u78C1\u76D8\u3002</li><li>\u5199\u5165\u4E00\u4E2A\u5305\u542B\u65B0\u6BB5\u4E14\u6392\u9664\u65E7\u7684\u548C\u8F83\u5C0F\u7684\u6BB5\u7684\u65B0\u63D0\u4EA4\u70B9\u3002</li><li>\u65B0\u7684\u6BB5\u88AB\u6253\u5F00\u7528\u6765\u641C\u7D22\u3002\u8001\u7684\u6BB5\u88AB\u5220\u9664\u3002</li></ul><p><img src="https://qiniu.xinghe.fit/Elasticsearch/a00cc1c19652c47fcfb663aaf337a41b.png" alt=""></p><p>\u5408\u5E76\u5927\u7684\u6BB5\u9700\u8981\u6D88\u8017\u5927\u91CF\u7684 I/O \u548C CPU \u8D44\u6E90\uFF0C\u5982\u679C\u4EFB\u5176\u53D1\u5C55\u4F1A\u5F71\u54CD\u641C\u7D22\u6027\u80FD\u3002 Elasticsearch\u5728\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u4F1A\u5BF9\u5408\u5E76\u6D41\u7A0B\u8FDB\u884C\u8D44\u6E90\u9650\u5236\uFF0C\u6240\u4EE5\u641C\u7D22\u4ECD\u7136\u6709\u8DB3\u591F\u7684\u8D44\u6E90\u5F88\u597D\u5730\u6267\u884C\u3002</p><h3 id="_46-\u8FDB\u9636-\u6587\u6863\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_46-\u8FDB\u9636-\u6587\u6863\u5206\u6790" aria-hidden="true">#</a> 46-\u8FDB\u9636-\u6587\u6863\u5206\u6790</h3><p>\u5206\u6790\u5305\u542B\u4E0B\u9762\u7684\u8FC7\u7A0B\uFF1A</p><ul><li>\u5C06\u4E00\u5757\u6587\u672C\u5206\u6210\u9002\u5408\u4E8E\u5012\u6392\u7D22\u5F15\u7684\u72EC\u7ACB\u7684\u8BCD\u6761\u3002</li><li>\u5C06\u8FD9\u4E9B\u8BCD\u6761\u7EDF\u4E00\u5316\u4E3A\u6807\u51C6\u683C\u5F0F\u4EE5\u63D0\u9AD8\u5B83\u4EEC\u7684\u201C\u53EF\u641C\u7D22\u6027\u201D\uFF0C\u6216\u8005recall\u3002</li></ul><p>\u5206\u6790\u5668\u6267\u884C\u4E0A\u9762\u7684\u5DE5\u4F5C\u3002\u5206\u6790\u5668\u5B9E\u9645\u4E0A\u662F\u5C06\u4E09\u4E2A\u529F\u80FD\u5C01\u88C5\u5230\u4E86\u4E00\u4E2A\u5305\u91CC\uFF1A</p><ul><li>\u5B57\u7B26\u8FC7\u6EE4\u5668\uFF1A\u9996\u5148\uFF0C\u5B57\u7B26\u4E32\u6309\u987A\u5E8F\u901A\u8FC7\u6BCF\u4E2A \u5B57\u7B26\u8FC7\u6EE4\u5668 \u3002\u4ED6\u4EEC\u7684\u4EFB\u52A1\u662F\u5728\u5206\u8BCD\u524D\u6574\u7406\u5B57\u7B26\u4E32\u3002\u4E00\u4E2A\u5B57\u7B26\u8FC7\u6EE4\u5668\u53EF\u4EE5\u7528\u6765\u53BB\u6389 HTML\uFF0C\u6216\u8005\u5C06 &amp; \u8F6C\u5316\u6210 and\u3002</li><li>\u5206\u8BCD\u5668\uFF1A\u5176\u6B21\uFF0C\u5B57\u7B26\u4E32\u88AB\u5206\u8BCD\u5668\u5206\u4E3A\u5355\u4E2A\u7684\u8BCD\u6761\u3002\u4E00\u4E2A\u7B80\u5355\u7684\u5206\u8BCD\u5668\u9047\u5230\u7A7A\u683C\u548C\u6807\u70B9\u7684\u65F6\u5019\uFF0C\u53EF\u80FD\u4F1A\u5C06\u6587\u672C\u62C6\u5206\u6210\u8BCD\u6761\u3002</li><li>Token \u8FC7\u6EE4\u5668\uFF1A\u6700\u540E\uFF0C\u8BCD\u6761\u6309\u987A\u5E8F\u901A\u8FC7\u6BCF\u4E2A token \u8FC7\u6EE4\u5668 \u3002\u8FD9\u4E2A\u8FC7\u7A0B\u53EF\u80FD\u4F1A\u6539\u53D8\u8BCD\u6761\uFF08\u4F8B\u5982\uFF0C\u5C0F\u5199\u5316Quick \uFF09\uFF0C\u5220\u9664\u8BCD\u6761\uFF08\u4F8B\u5982\uFF0C \u50CF a\uFF0C and\uFF0C the \u7B49\u65E0\u7528\u8BCD\uFF09\uFF0C\u6216\u8005\u589E\u52A0\u8BCD\u6761\uFF08\u4F8B\u5982\uFF0C\u50CFjump\u548Cleap\u8FD9\u79CD\u540C\u4E49\u8BCD\uFF09</li></ul><h4 id="\u5185\u7F6E\u5206\u6790\u5668" tabindex="-1"><a class="header-anchor" href="#\u5185\u7F6E\u5206\u6790\u5668" aria-hidden="true">#</a> \u5185\u7F6E\u5206\u6790\u5668</h4><p>Elasticsearch\u8FD8\u9644\u5E26\u4E86\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u7684\u9884\u5305\u88C5\u7684\u5206\u6790\u5668\u3002\u63A5\u4E0B\u6765\u6211\u4EEC\u4F1A\u5217\u51FA\u6700\u91CD\u8981\u7684\u5206\u6790\u5668\u3002\u4E3A\u4E86\u8BC1\u660E\u5B83\u4EEC\u7684\u5DEE\u5F02\uFF0C\u6211\u4EEC\u770B\u770B\u6BCF\u4E2A\u5206\u6790\u5668\u4F1A\u4ECE\u4E0B\u9762\u7684\u5B57\u7B26\u4E32\u5F97\u5230\u54EA\u4E9B\u8BCD\u6761\uFF1A</p><pre><code>&quot;Set the shape to semi-transparent by calling set_trans(5)&quot;
</code></pre><ul><li>\u6807\u51C6\u5206\u6790\u5668</li></ul><p>\u6807\u51C6\u5206\u6790\u5668\u662FElasticsearch \u9ED8\u8BA4\u4F7F\u7528\u7684\u5206\u6790\u5668\u3002\u5B83\u662F\u5206\u6790\u5404\u79CD\u8BED\u8A00\u6587\u672C\u6700\u5E38\u7528\u7684\u9009\u62E9\u3002\u5B83\u6839\u636EUnicode \u8054\u76DF\u5B9A\u4E49\u7684\u5355\u8BCD\u8FB9\u754C\u5212\u5206\u6587\u672C\u3002\u5220\u9664\u7EDD\u5927\u90E8\u5206\u6807\u70B9\u3002\u6700\u540E\uFF0C\u5C06\u8BCD\u6761\u5C0F\u5199\u3002\u5B83\u4F1A\u4EA7\u751F\uFF1A</p><pre><code>set, the, shape, to, semi, transparent, by, calling, set_trans, 5
</code></pre><ul><li>\u7B80\u5355\u5206\u6790\u5668</li></ul><p>\u7B80\u5355\u5206\u6790\u5668\u5728\u4EFB\u4F55\u4E0D\u662F\u5B57\u6BCD\u7684\u5730\u65B9\u5206\u9694\u6587\u672C\uFF0C\u5C06\u8BCD\u6761\u5C0F\u5199\u3002\u5B83\u4F1A\u4EA7\u751F\uFF1A</p><pre><code>set, the, shape, to, semi, transparent, by, calling, set, trans
</code></pre><ul><li>\u7A7A\u683C\u5206\u6790\u5668</li></ul><p>\u7A7A\u683C\u5206\u6790\u5668\u5728\u7A7A\u683C\u7684\u5730\u65B9\u5212\u5206\u6587\u672C\u3002\u5B83\u4F1A\u4EA7\u751F:</p><pre><code>Set, the, shape, to, semi-transparent, by, calling, set_trans(5)
</code></pre><ul><li>\u8BED\u8A00\u5206\u6790\u5668</li></ul><p>\u7279\u5B9A\u8BED\u8A00\u5206\u6790\u5668\u53EF\u7528\u4E8E\u5F88\u591A\u8BED\u8A00\u3002\u5B83\u4EEC\u53EF\u4EE5\u8003\u8651\u6307\u5B9A\u8BED\u8A00\u7684\u7279\u70B9\u3002\u4F8B\u5982\uFF0C\u82F1\u8BED\u5206\u6790\u5668\u9644\u5E26\u4E86\u4E00\u7EC4\u82F1\u8BED\u65E0\u7528\u8BCD\uFF08\u5E38\u7528\u5355\u8BCD\uFF0C\u4F8B\u5982and\u6216\u8005the ,\u5B83\u4EEC\u5BF9\u76F8\u5173\u6027\u6CA1\u6709\u591A\u5C11\u5F71\u54CD\uFF09\uFF0C\u5B83\u4EEC\u4F1A\u88AB\u5220\u9664\u3002\u7531\u4E8E\u7406\u89E3\u82F1\u8BED\u8BED\u6CD5\u7684\u89C4\u5219\uFF0C\u8FD9\u4E2A\u5206\u8BCD\u5668\u53EF\u4EE5\u63D0\u53D6\u82F1\u8BED\u5355\u8BCD\u7684\u8BCD\u5E72\u3002</p><p>\u82F1\u8BED\u5206\u8BCD\u5668\u4F1A\u4EA7\u751F\u4E0B\u9762\u7684\u8BCD\u6761\uFF1A</p><pre><code>set, shape, semi, transpar, call, set_tran, 5
</code></pre><p>\u6CE8\u610F\u770Btransparent\u3001calling\u548C set_trans\u5DF2\u7ECF\u53D8\u4E3A\u8BCD\u6839\u683C\u5F0F\u3002</p><h4 id="\u5206\u6790\u5668\u4F7F\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#\u5206\u6790\u5668\u4F7F\u7528\u573A\u666F" aria-hidden="true">#</a> \u5206\u6790\u5668\u4F7F\u7528\u573A\u666F</h4><p>\u5F53\u6211\u4EEC\u7D22\u5F15\u4E00\u4E2A\u6587\u6863\uFF0C\u5B83\u7684\u5168\u6587\u57DF\u88AB\u5206\u6790\u6210\u8BCD\u6761\u4EE5\u7528\u6765\u521B\u5EFA\u5012\u6392\u7D22\u5F15\u3002\u4F46\u662F\uFF0C\u5F53\u6211\u4EEC\u5728\u5168\u6587\u57DF\u641C\u7D22\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u9700\u8981\u5C06\u67E5\u8BE2\u5B57\u7B26\u4E32\u901A\u8FC7\u76F8\u540C\u7684\u5206\u6790\u8FC7\u7A0B\uFF0C\u4EE5\u4FDD\u8BC1\u6211\u4EEC\u641C\u7D22\u7684\u8BCD\u6761\u683C\u5F0F\u4E0E\u7D22\u5F15\u4E2D\u7684\u8BCD\u6761\u683C\u5F0F\u4E00\u81F4\u3002</p><p>\u5168\u6587\u67E5\u8BE2\uFF0C\u7406\u89E3\u6BCF\u4E2A\u57DF\u662F\u5982\u4F55\u5B9A\u4E49\u7684\uFF0C\u56E0\u6B64\u5B83\u4EEC\u53EF\u4EE5\u505A\u6B63\u786E\u7684\u4E8B\uFF1A</p><ul><li><p>\u5F53\u4F60\u67E5\u8BE2\u4E00\u4E2A\u5168\u6587\u57DF\u65F6\uFF0C\u4F1A\u5BF9\u67E5\u8BE2\u5B57\u7B26\u4E32\u5E94\u7528\u76F8\u540C\u7684\u5206\u6790\u5668\uFF0C\u4EE5\u4EA7\u751F\u6B63\u786E\u7684\u641C\u7D22\u8BCD\u6761\u5217\u8868\u3002</p></li><li><p>\u5F53\u4F60\u67E5\u8BE2\u4E00\u4E2A\u7CBE\u786E\u503C\u57DF\u65F6\uFF0C\u4E0D\u4F1A\u5206\u6790\u67E5\u8BE2\u5B57\u7B26\u4E32\uFF0C\u800C\u662F\u641C\u7D22\u4F60\u6307\u5B9A\u7684\u7CBE\u786E\u503C\u3002</p></li></ul><h4 id="\u6D4B\u8BD5\u5206\u6790\u5668" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u5206\u6790\u5668" aria-hidden="true">#</a> \u6D4B\u8BD5\u5206\u6790\u5668</h4><p>\u6709\u4E9B\u65F6\u5019\u5F88\u96BE\u7406\u89E3\u5206\u8BCD\u7684\u8FC7\u7A0B\u548C\u5B9E\u9645\u88AB\u5B58\u50A8\u5230\u7D22\u5F15\u4E2D\u7684\u8BCD\u6761\uFF0C\u7279\u522B\u662F\u4F60\u521A\u63A5\u89E6Elasticsearch\u3002\u4E3A\u4E86\u7406\u89E3\u53D1\u751F\u4E86\u4EC0\u4E48\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528analyze API\u6765\u770B\u6587\u672C\u662F\u5982\u4F55\u88AB\u5206\u6790\u7684\u3002\u5728\u6D88\u606F\u4F53\u91CC\uFF0C\u6307\u5B9A\u5206\u6790\u5668\u548C\u8981\u5206\u6790\u7684\u6587\u672C\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//localhost:9200/_analyze</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Text to analyze&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ED3\u679C\u4E2D\u6BCF\u4E2A\u5143\u7D20\u4EE3\u8868\u4E00\u4E2A\u5355\u72EC\u7684\u8BCD\u6761\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;to&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;analyze&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>token\u662F\u5B9E\u9645\u5B58\u50A8\u5230\u7D22\u5F15\u4E2D\u7684\u8BCD\u6761\u3002</li><li>start_ offset \u548Cend_ offset\u6307\u660E\u5B57\u7B26\u5728\u539F\u59CB\u5B57\u7B26\u4E32\u4E2D\u7684\u4F4D\u7F6E\u3002</li><li>position\u6307\u660E\u8BCD\u6761\u5728\u539F\u59CB\u6587\u672C\u4E2D\u51FA\u73B0\u7684\u4F4D\u7F6E\u3002</li></ul><h4 id="\u6307\u5B9A\u5206\u6790\u5668" tabindex="-1"><a class="header-anchor" href="#\u6307\u5B9A\u5206\u6790\u5668" aria-hidden="true">#</a> \u6307\u5B9A\u5206\u6790\u5668</h4><p>\u5F53Elasticsearch\u5728\u4F60\u7684\u6587\u6863\u4E2D\u68C0\u6D4B\u5230\u4E00\u4E2A\u65B0\u7684\u5B57\u7B26\u4E32\u57DF\uFF0C\u5B83\u4F1A\u81EA\u52A8\u8BBE\u7F6E\u5176\u4E3A\u4E00\u4E2A\u5168\u6587\u5B57\u7B26\u4E32\u57DF\uFF0C\u4F7F\u7528 \u6807\u51C6 \u5206\u6790\u5668\u5BF9\u5B83\u8FDB\u884C\u5206\u6790\u3002\u4F60\u4E0D\u5E0C\u671B\u603B\u662F\u8FD9\u6837\u3002\u53EF\u80FD\u4F60\u60F3\u4F7F\u7528\u4E00\u4E2A\u4E0D\u540C\u7684\u5206\u6790\u5668\uFF0C\u9002\u7528\u4E8E\u4F60\u7684\u6570\u636E\u4F7F\u7528\u7684\u8BED\u8A00\u3002\u6709\u65F6\u5019\u4F60\u60F3\u8981\u4E00\u4E2A\u5B57\u7B26\u4E32\u57DF\u5C31\u662F\u4E00\u4E2A\u5B57\u7B26\u4E32\u57DF\uFF0C\u4E0D\u4F7F\u7528\u5206\u6790\uFF0C\u76F4\u63A5\u7D22\u5F15\u4F60\u4F20\u5165\u7684\u7CBE\u786E\u503C\uFF0C\u4F8B\u5982\u7528\u6237 ID \u6216\u8005\u4E00\u4E2A\u5185\u90E8\u7684\u72B6\u6001\u57DF\u6216\u6807\u7B7E\u3002\u8981\u505A\u5230\u8FD9\u4E00\u70B9\uFF0C\u6211\u4EEC\u5FC5\u987B\u624B\u52A8\u6307\u5B9A\u8FD9\u4E9B\u57DF\u7684\u6620\u5C04\u3002</p><p>\uFF08\u7EC6\u7C92\u5EA6\u6307\u5B9A\u5206\u6790\u5668\uFF09</p><h4 id="ik\u5206\u8BCD\u5668" tabindex="-1"><a class="header-anchor" href="#ik\u5206\u8BCD\u5668" aria-hidden="true">#</a> IK\u5206\u8BCD\u5668</h4><p>\u9996\u5148\u901A\u8FC7 Postman \u53D1\u9001 GET \u8BF7\u6C42\u67E5\u8BE2\u5206\u8BCD\u6548\u679C</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># GET http<span class="token operator">:</span><span class="token comment">//localhost:9200/_analyze</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u6D4B\u8BD5\u5355\u8BCD&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ES \u7684\u9ED8\u8BA4\u5206\u8BCD\u5668\u65E0\u6CD5\u8BC6\u522B\u4E2D\u6587\u4E2D\u6D4B\u8BD5\u3001 \u5355\u8BCD\u8FD9\u6837\u7684\u8BCD\u6C47\uFF0C\u800C\u662F\u7B80\u5355\u7684\u5C06\u6BCF\u4E2A\u5B57\u62C6\u5B8C\u5206\u4E3A\u4E00\u4E2A\u8BCD\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u6D4B&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u8BD5&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5355&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u8BCD&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;IDEOGRAPHIC&gt;&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u6837\u7684\u7ED3\u679C\u663E\u7136\u4E0D\u7B26\u5408\u6211\u4EEC\u7684\u4F7F\u7528\u8981\u6C42\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u4E0B\u8F7D ES \u5BF9\u5E94\u7248\u672C\u7684\u4E2D\u6587\u5206\u8BCD\u5668\u3002</p>`,220),I={href:"https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v7.8.0",target:"_blank",rel:"noopener noreferrer"},H=s("IK \u4E2D\u6587\u5206\u8BCD\u5668\u4E0B\u8F7D\u7F51\u5740"),P=p(`<p>\u5C06\u89E3\u538B\u540E\u7684\u540E\u7684\u6587\u4EF6\u5939\u653E\u5165 ES \u6839\u76EE\u5F55\u4E0B\u7684 plugins \u76EE\u5F55\u4E0B\uFF0C\u91CD\u542F ES \u5373\u53EF\u4F7F\u7528\u3002</p><p>\u6211\u4EEC\u8FD9\u6B21\u52A0\u5165\u65B0\u7684\u67E5\u8BE2\u53C2\u6570&quot;analyzer&quot;:\u201Cik_max_word\u201D\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># GET http<span class="token operator">:</span><span class="token comment">//localhost:9200/_analyze</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u6D4B\u8BD5\u5355\u8BCD&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ik_max_word\uFF1A\u4F1A\u5C06\u6587\u672C\u505A\u6700\u7EC6\u7C92\u5EA6\u7684\u62C6\u5206\u3002</li><li>ik_smart\uFF1A\u4F1A\u5C06\u6587\u672C\u505A\u6700\u7C97\u7C92\u5EA6\u7684\u62C6\u5206\u3002</li></ul><p>\u4F7F\u7528\u4E2D\u6587\u5206\u8BCD\u540E\u7684\u7ED3\u679C\u4E3A\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u6D4B\u8BD5&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5355\u8BCD&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ES \u4E2D\u4E5F\u53EF\u4EE5\u8FDB\u884C\u6269\u5C55\u8BCD\u6C47\uFF0C\u9996\u5148\u67E5\u8BE2</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//localhost:9200/_analyze</span>

<span class="token punctuation">{</span>
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u5F17\u96F7\u5C14\u5353\u5FB7&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EC5\u4EC5\u53EF\u4EE5\u5F97\u5230\u6BCF\u4E2A\u5B57\u7684\u5206\u8BCD\u7ED3\u679C\uFF0C\u6211\u4EEC\u9700\u8981\u505A\u7684\u5C31\u662F\u4F7F\u5206\u8BCD\u5668\u8BC6\u522B\u5230\u5F17\u96F7\u5C14\u5353\u5FB7\u4E5F\u662F\u4E00\u4E2A\u8BCD\u8BED\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5F17&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u96F7&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5C14&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5353&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5FB7&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>\u9996\u5148\u8FDB\u5165 ES \u6839\u76EE\u5F55\u4E2D\u7684 plugins \u6587\u4EF6\u5939\u4E0B\u7684 ik \u6587\u4EF6\u5939\uFF0C\u8FDB\u5165 config \u76EE\u5F55\uFF0C\u521B\u5EFA custom.dic\u6587\u4EF6\uFF0C\u5199\u5165\u201C\u5F17\u96F7\u5C14\u5353\u5FB7\u201D\u3002</li><li>\u540C\u65F6\u6253\u5F00 IKAnalyzer.cfg.xml \u6587\u4EF6\uFF0C\u5C06\u65B0\u5EFA\u7684 custom.dic \u914D\u7F6E\u5176\u4E2D\u3002</li><li>\u91CD\u542F ES \u670D\u52A1\u5668 \u3002</li></ol><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">&gt;</span></span>IK Analyzer \u6269\u5C55\u914D\u7F6E<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--\u7528\u6237\u53EF\u4EE5\u5728\u8FD9\u91CC\u914D\u7F6E\u81EA\u5DF1\u7684\u6269\u5C55\u5B57\u5178 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_dict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>custom.dic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
	 <span class="token comment">&lt;!--\u7528\u6237\u53EF\u4EE5\u5728\u8FD9\u91CC\u914D\u7F6E\u81EA\u5DF1\u7684\u6269\u5C55\u505C\u6B62\u8BCD\u5B57\u5178--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_stopwords<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--\u7528\u6237\u53EF\u4EE5\u5728\u8FD9\u91CC\u914D\u7F6E\u8FDC\u7A0B\u6269\u5C55\u5B57\u5178 --&gt;</span>
	<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_dict&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
	<span class="token comment">&lt;!--\u7528\u6237\u53EF\u4EE5\u5728\u8FD9\u91CC\u914D\u7F6E\u8FDC\u7A0B\u6269\u5C55\u505C\u6B62\u8BCD\u5B57\u5178--&gt;</span>
	<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6269\u5C55\u540E\u518D\u6B21\u67E5\u8BE2</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># GET http<span class="token operator">:</span><span class="token comment">//localhost:9200/_analyze</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u6D4B\u8BD5\u5355\u8BCD&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u5982\u4E0B\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\u5F17\u96F7\u5C14\u5353\u5FB7&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u81EA\u5B9A\u4E49\u5206\u6790\u5668" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u5206\u6790\u5668" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u5206\u6790\u5668</h4><p>\u867D\u7136Elasticsearch\u5E26\u6709\u4E00\u4E9B\u73B0\u6210\u7684\u5206\u6790\u5668\uFF0C\u7136\u800C\u5728\u5206\u6790\u5668\u4E0AElasticsearch\u771F\u6B63\u7684\u5F3A\u5927\u4E4B\u5904\u5728\u4E8E\uFF0C\u4F60\u53EF\u4EE5\u901A\u8FC7\u5728\u4E00\u4E2A\u9002\u5408\u4F60\u7684\u7279\u5B9A\u6570\u636E\u7684\u8BBE\u7F6E\u4E4B\u4E2D\u7EC4\u5408\u5B57\u7B26\u8FC7\u6EE4\u5668\u3001\u5206\u8BCD\u5668\u3001\u8BCD\u6C47\u5355\u5143\u8FC7\u6EE4\u5668\u6765\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u5206\u6790\u5668\u3002\u5728\u5206\u6790\u4E0E\u5206\u6790\u5668\u6211\u4EEC\u8BF4\u8FC7\uFF0C\u4E00\u4E2A\u5206\u6790\u5668\u5C31\u662F\u5728\u4E00\u4E2A\u5305\u91CC\u9762\u7EC4\u5408\u4E86\u4E09\u79CD\u51FD\u6570\u7684\u4E00\u4E2A\u5305\u88C5\u5668\uFF0C\u4E09\u79CD\u51FD\u6570\u6309\u7167\u987A\u5E8F\u88AB\u6267\u884C\uFF1A</p><h5 id="\u5B57\u7B26\u8FC7\u6EE4\u5668" tabindex="-1"><a class="header-anchor" href="#\u5B57\u7B26\u8FC7\u6EE4\u5668" aria-hidden="true">#</a> \u5B57\u7B26\u8FC7\u6EE4\u5668</h5><p>\u5B57\u7B26\u8FC7\u6EE4\u5668\u7528\u6765\u6574\u7406\u4E00\u4E2A\u5C1A\u672A\u88AB\u5206\u8BCD\u7684\u5B57\u7B26\u4E32\u3002\u4F8B\u5982\uFF0C\u5982\u679C\u6211\u4EEC\u7684\u6587\u672C\u662FHTML\u683C\u5F0F\u7684\uFF0C\u5B83\u4F1A\u5305\u542B\u50CF<code>&lt;p&gt;</code>\u6216\u8005<code>&lt;div&gt;</code>\u8FD9\u6837\u7684HTML\u6807\u7B7E\uFF0C\u8FD9\u4E9B\u6807\u7B7E\u662F\u6211\u4EEC\u4E0D\u60F3\u7D22\u5F15\u7684\u3002\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528html\u6E05\u9664\u5B57\u7B26\u8FC7\u6EE4\u5668\u6765\u79FB\u9664\u6389\u6240\u6709\u7684HTML\u6807\u7B7E\uFF0C\u5E76\u4E14\u50CF\u628A<code>&amp;Aacute;</code>\u8F6C\u6362\u4E3A\u76F8\u5BF9\u5E94\u7684Unicode\u5B57\u7B26\xC1 \u8FD9\u6837\uFF0C\u8F6C\u6362HTML\u5B9E\u4F53\u3002\u4E00\u4E2A\u5206\u6790\u5668\u53EF\u80FD\u67090\u4E2A\u6216\u8005\u591A\u4E2A\u5B57\u7B26\u8FC7\u6EE4\u5668\u3002</p><h5 id="\u5206\u8BCD\u5668" tabindex="-1"><a class="header-anchor" href="#\u5206\u8BCD\u5668" aria-hidden="true">#</a> \u5206\u8BCD\u5668</h5><p>\u4E00\u4E2A\u5206\u6790\u5668\u5FC5\u987B\u6709\u4E00\u4E2A\u552F\u4E00\u7684\u5206\u8BCD\u5668\u3002\u5206\u8BCD\u5668\u628A\u5B57\u7B26\u4E32\u5206\u89E3\u6210\u5355\u4E2A\u8BCD\u6761\u6216\u8005\u8BCD\u6C47\u5355\u5143\u3002\u6807\u51C6\u5206\u6790\u5668\u91CC\u4F7F\u7528\u7684\u6807\u51C6\u5206\u8BCD\u5668\u628A\u4E00\u4E2A\u5B57\u7B26\u4E32\u6839\u636E\u5355\u8BCD\u8FB9\u754C\u5206\u89E3\u6210\u5355\u4E2A\u8BCD\u6761\uFF0C\u5E76\u4E14\u79FB\u9664\u6389\u5927\u90E8\u5206\u7684\u6807\u70B9\u7B26\u53F7\uFF0C\u7136\u800C\u8FD8\u6709\u5176\u4ED6\u4E0D\u540C\u884C\u4E3A\u7684\u5206\u8BCD\u5668\u5B58\u5728\u3002</p><p>\u4F8B\u5982\uFF0C\u5173\u952E\u8BCD\u5206\u8BCD\u5668\u5B8C\u6574\u5730\u8F93\u51FA\u63A5\u6536\u5230\u7684\u540C\u6837\u7684\u5B57\u7B26\u4E32\uFF0C\u5E76\u4E0D\u505A\u4EFB\u4F55\u5206\u8BCD\u3002\u7A7A\u683C\u5206\u8BCD\u5668\u53EA\u6839\u636E\u7A7A\u683C\u5206\u5272\u6587\u672C\u3002\u6B63\u5219\u5206\u8BCD\u5668\u6839\u636E\u5339\u914D\u6B63\u5219\u8868\u8FBE\u5F0F\u6765\u5206\u5272\u6587\u672C\u3002</p><h5 id="\u8BCD\u5355\u5143\u8FC7\u6EE4\u5668" tabindex="-1"><a class="header-anchor" href="#\u8BCD\u5355\u5143\u8FC7\u6EE4\u5668" aria-hidden="true">#</a> \u8BCD\u5355\u5143\u8FC7\u6EE4\u5668</h5><p>\u7ECF\u8FC7\u5206\u8BCD\uFF0C\u4F5C\u4E3A\u7ED3\u679C\u7684\u8BCD\u5355\u5143\u6D41\u4F1A\u6309\u7167\u6307\u5B9A\u7684\u987A\u5E8F\u901A\u8FC7\u6307\u5B9A\u7684\u8BCD\u5355\u5143\u8FC7\u6EE4\u5668\u3002\u8BCD\u5355\u5143\u8FC7\u6EE4\u5668\u53EF\u4EE5\u4FEE\u6539\u3001\u6DFB\u52A0\u6216\u8005\u79FB\u9664\u8BCD\u5355\u5143\u3002\u6211\u4EEC\u5DF2\u7ECF\u63D0\u5230\u8FC7lowercase\u548Cstop\u8BCD\u8FC7\u6EE4\u5668\uFF0C\u4F46\u662F\u5728Elasticsearch \u91CC\u9762\u8FD8\u6709\u5F88\u591A\u53EF\u4F9B\u9009\u62E9\u7684\u8BCD\u5355\u5143\u8FC7\u6EE4\u5668\u3002\u8BCD\u5E72\u8FC7\u6EE4\u5668\u628A\u5355\u8BCD\u904F\u5236\u4E3A\u8BCD\u5E72\u3002ascii_folding\u8FC7\u6EE4\u5668\u79FB\u9664\u53D8\u97F3\u7B26\uFF0C\u628A\u4E00\u4E2A\u50CF&quot;tr\xE8s\u201D\u8FD9\u6837\u7684\u8BCD\u8F6C\u6362\u4E3A\u201Ctres\u201D\u3002</p><p>ngram\u548C edge_ngram\u8BCD\u5355\u5143\u8FC7\u6EE4\u5668\u53EF\u4EE5\u4EA7\u751F\u9002\u5408\u7528\u4E8E\u90E8\u5206\u5339\u914D\u6216\u8005\u81EA\u52A8\u8865\u5168\u7684\u8BCD\u5355\u5143\u3002</p><h5 id="\u81EA\u5B9A\u4E49\u5206\u6790\u5668\u4F8B\u5B50" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u5206\u6790\u5668\u4F8B\u5B50" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u5206\u6790\u5668\u4F8B\u5B50</h5><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u770B\u770B\u5982\u4F55\u521B\u5EFA\u81EA\u5B9A\u4E49\u7684\u5206\u6790\u5668\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT http<span class="token operator">:</span><span class="token comment">//localhost:9200/my_index</span>

<span class="token punctuation">{</span>
    <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;&amp;_to_and&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mapping&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;&amp;=&gt; and &quot;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;my_stopwords&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;stopwords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;the&quot;</span><span class="token punctuation">,</span> 
                        <span class="token string">&quot;a&quot;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;my_analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;char_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;html_strip&quot;</span><span class="token punctuation">,</span> 
                        <span class="token string">&quot;&amp;_to_and&quot;</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span> 
                    <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span> 
                        <span class="token string">&quot;my_stopwords&quot;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7D22\u5F15\u88AB\u521B\u5EFA\u4EE5\u540E\uFF0C\u4F7F\u7528 analyze API \u6765 \u6D4B\u8BD5\u8FD9\u4E2A\u65B0\u7684\u5206\u6790\u5668\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># GET http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/my_index/_analyze</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;The quick &amp; brown fox&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_analyzer&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\u4E3A\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;tokens&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;quick&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;and&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;brown&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fox&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_offset&quot;</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_offset&quot;</span><span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;ALPHANUM&gt;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_47-\u8FDB\u9636-\u6587\u6863\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#_47-\u8FDB\u9636-\u6587\u6863\u63A7\u5236" aria-hidden="true">#</a> 47-\u8FDB\u9636-\u6587\u6863\u63A7\u5236</h3><h4 id="\u6587\u6863\u51B2\u7A81" tabindex="-1"><a class="header-anchor" href="#\u6587\u6863\u51B2\u7A81" aria-hidden="true">#</a> \u6587\u6863\u51B2\u7A81</h4><p>\u5F53\u6211\u4EEC\u4F7F\u7528index API\u66F4\u65B0\u6587\u6863\uFF0C\u53EF\u4EE5\u4E00\u6B21\u6027\u8BFB\u53D6\u539F\u59CB\u6587\u6863\uFF0C\u505A\u6211\u4EEC\u7684\u4FEE\u6539\uFF0C\u7136\u540E\u91CD\u65B0\u7D22\u5F15\u6574\u4E2A\u6587\u6863\u3002\u6700\u8FD1\u7684\u7D22\u5F15\u8BF7\u6C42\u5C06\u83B7\u80DC\uFF1A\u65E0\u8BBA\u6700\u540E\u54EA\u4E00\u4E2A\u6587\u6863\u88AB\u7D22\u5F15\uFF0C\u90FD\u5C06\u88AB\u552F\u4E00\u5B58\u50A8\u5728 Elasticsearch \u4E2D\u3002\u5982\u679C\u5176\u4ED6\u4EBA\u540C\u65F6\u66F4\u6539\u8FD9\u4E2A\u6587\u6863\uFF0C\u4ED6\u4EEC\u7684\u66F4\u6539\u5C06\u4E22\u5931\u3002</p><p>\u5F88\u591A\u65F6\u5019\u8FD9\u662F\u6CA1\u6709\u95EE\u9898\u7684\u3002\u4E5F\u8BB8\u6211\u4EEC\u7684\u4E3B\u6570\u636E\u5B58\u50A8\u662F\u4E00\u4E2A\u5173\u7CFB\u578B\u6570\u636E\u5E93\uFF0C\u6211\u4EEC\u53EA\u662F\u5C06\u6570\u636E\u590D\u5236\u5230Elasticsearch\u4E2D\u5E76\u4F7F\u5176\u53EF\u88AB\u641C\u7D22\u3002\u4E5F\u8BB8\u4E24\u4E2A\u4EBA\u540C\u65F6\u66F4\u6539\u76F8\u540C\u7684\u6587\u6863\u7684\u51E0\u7387\u5F88\u5C0F\u3002\u6216\u8005\u5BF9\u4E8E\u6211\u4EEC\u7684\u4E1A\u52A1\u6765\u8BF4\u5076\u5C14\u4E22\u5931\u66F4\u6539\u5E76\u4E0D\u662F\u5F88\u4E25\u91CD\u7684\u95EE\u9898\u3002</p><p>\u4F46\u6709\u65F6\u4E22\u5931\u4E86\u4E00\u4E2A\u53D8\u66F4\u5C31\u662F\u975E\u5E38\u4E25\u91CD\u7684\u3002\u8BD5\u60F3\u6211\u4EEC\u4F7F\u7528Elasticsearch \u5B58\u50A8\u6211\u4EEC\u7F51\u4E0A\u5546\u57CE\u5546\u54C1\u5E93\u5B58\u7684\u6570\u91CF\uFF0C\u6BCF\u6B21\u6211\u4EEC\u5356\u4E00\u4E2A\u5546\u54C1\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u5728 Elasticsearch \u4E2D\u5C06\u5E93\u5B58\u6570\u91CF\u51CF\u5C11\u3002\u6709\u4E00\u5929\uFF0C\u7BA1\u7406\u5C42\u51B3\u5B9A\u505A\u4E00\u6B21\u4FC3\u9500\u3002\u7A81\u7136\u5730\uFF0C\u6211\u4EEC\u4E00\u79D2\u8981\u5356\u597D\u51E0\u4E2A\u5546\u54C1\u3002\u5047\u8BBE\u6709\u4E24\u4E2Aweb\u7A0B\u5E8F\u5E76\u884C\u8FD0\u884C\uFF0C\u6BCF\u4E00\u4E2A\u90FD\u540C\u65F6\u5904\u7406\u6240\u6709\u5546\u54C1\u7684\u9500\u552E\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/49ca2ec50db3ddd0fcd1f364ac600b96.png" alt=""></p><p>web_1 \u5BF9stock_count\u6240\u505A\u7684\u66F4\u6539\u5DF2\u7ECF\u4E22\u5931\uFF0C\u56E0\u4E3A web_2\u4E0D\u77E5\u9053\u5B83\u7684 stock_count\u7684\u62F7\u8D1D\u5DF2\u7ECF\u8FC7\u671F\u3002\u7ED3\u679C\u6211\u4EEC\u4F1A\u8BA4\u4E3A\u6709\u8D85\u8FC7\u5546\u54C1\u7684\u5B9E\u9645\u6570\u91CF\u7684\u5E93\u5B58\uFF0C\u56E0\u4E3A\u5356\u7ED9\u987E\u5BA2\u7684\u5E93\u5B58\u5546\u54C1\u5E76\u4E0D\u5B58\u5728\uFF0C\u6211\u4EEC\u5C06\u8BA9\u4ED6\u4EEC\u975E\u5E38\u5931\u671B\u3002</p><p>\u53D8\u66F4\u8D8A\u9891\u7E41\uFF0C\u8BFB\u6570\u636E\u548C\u66F4\u65B0\u6570\u636E\u7684\u95F4\u9699\u8D8A\u957F\uFF0C\u4E5F\u5C31\u8D8A\u53EF\u80FD\u4E22\u5931\u53D8\u66F4\u3002\u5728\u6570\u636E\u5E93\u9886\u57DF\u4E2D\uFF0C\u6709\u4E24\u79CD\u65B9\u6CD5\u901A\u5E38\u88AB\u7528\u6765\u786E\u4FDD\u5E76\u53D1\u66F4\u65B0\u65F6\u53D8\u66F4\u4E0D\u4F1A\u4E22\u5931\uFF1A</p><ul><li>\u60B2\u89C2\u5E76\u53D1\u63A7\u5236\uFF1A\u8FD9\u79CD\u65B9\u6CD5\u88AB\u5173\u7CFB\u578B\u6570\u636E\u5E93\u5E7F\u6CDB\u4F7F\u7528\uFF0C\u5B83\u5047\u5B9A\u6709\u53D8\u66F4\u51B2\u7A81\u53EF\u80FD\u53D1\u751F\uFF0C\u56E0\u6B64\u963B\u585E\u8BBF\u95EE\u8D44\u6E90\u4EE5\u9632\u6B62\u51B2\u7A81\u3002\u4E00\u4E2A\u5178\u578B\u7684\u4F8B\u5B50\u662F\u8BFB\u53D6\u4E00\u884C\u6570\u636E\u4E4B\u524D\u5148\u5C06\u5176\u9501\u4F4F\uFF0C\u786E\u4FDD\u53EA\u6709\u653E\u7F6E\u9501\u7684\u7EBF\u7A0B\u80FD\u591F\u5BF9\u8FD9\u884C\u6570\u636E\u8FDB\u884C\u4FEE\u6539\u3002</li><li>\u4E50\u89C2\u5E76\u53D1\u63A7\u5236\uFF1AElasticsearch \u4E2D\u4F7F\u7528\u7684\u8FD9\u79CD\u65B9\u6CD5\u5047\u5B9A\u51B2\u7A81\u662F\u4E0D\u53EF\u80FD\u53D1\u751F\u7684\uFF0C\u5E76\u4E14\u4E0D\u4F1A\u963B\u585E\u6B63\u5728\u5C1D\u8BD5\u7684\u64CD\u4F5C\u3002\u7136\u800C\uFF0C\u5982\u679C\u6E90\u6570\u636E\u5728\u8BFB\u5199\u5F53\u4E2D\u88AB\u4FEE\u6539\uFF0C\u66F4\u65B0\u5C06\u4F1A\u5931\u8D25\u3002\u5E94\u7528\u7A0B\u5E8F\u63A5\u4E0B\u6765\u5C06\u51B3\u5B9A\u8BE5\u5982\u4F55\u89E3\u51B3\u51B2\u7A81\u3002\u4F8B\u5982\uFF0C\u53EF\u4EE5\u91CD\u8BD5\u66F4\u65B0\u3001\u4F7F\u7528\u65B0\u7684\u6570\u636E\u3001\u6216\u8005\u5C06\u76F8\u5173\u60C5\u51B5\u62A5\u544A\u7ED9\u7528\u6237\u3002</li></ul><h4 id="\u4E50\u89C2\u5E76\u53D1\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u4E50\u89C2\u5E76\u53D1\u63A7\u5236" aria-hidden="true">#</a> \u4E50\u89C2\u5E76\u53D1\u63A7\u5236</h4><p>Elasticsearch\u662F\u5206\u5E03\u5F0F\u7684\u3002\u5F53\u6587\u6863\u521B\u5EFA\u3001\u66F4\u65B0\u6216\u5220\u9664\u65F6\uFF0C\u65B0\u7248\u672C\u7684\u6587\u6863\u5FC5\u987B\u590D\u5236\u5230\u96C6\u7FA4\u4E2D\u7684\u5176\u4ED6\u8282\u70B9\u3002Elasticsearch\u4E5F\u662F\u5F02\u6B65\u548C\u5E76\u53D1\u7684\uFF0C\u8FD9\u610F\u5473\u7740\u8FD9\u4E9B\u590D\u5236\u8BF7\u6C42\u88AB\u5E76\u884C\u53D1\u9001\uFF0C\u5E76\u4E14\u5230\u8FBE\u76EE\u7684\u5730\u65F6\u4E5F\u8BB8\u987A\u5E8F\u662F\u4E71\u7684\u3002Elasticsearch\u9700\u8981\u4E00\u79CD\u65B9\u6CD5\u786E\u4FDD\u6587\u6863\u7684\u65E7\u7248\u672C\u4E0D\u4F1A\u8986\u76D6\u65B0\u7684\u7248\u672C\u3002</p><p>\u5F53\u6211\u4EEC\u4E4B\u524D\u8BA8\u8BBAindex , GET\u548CDELETE\u8BF7\u6C42\u65F6\uFF0C\u6211\u4EEC\u6307\u51FA\u6BCF\u4E2A\u6587\u6863\u90FD\u6709\u4E00\u4E2A_version\uFF08\u7248\u672C\u53F7\uFF09\uFF0C\u5F53\u6587\u6863\u88AB\u4FEE\u6539\u65F6\u7248\u672C\u53F7\u9012\u589E\u3002Elasticsearch\u4F7F\u7528\u8FD9\u4E2Aversion\u53F7\u6765\u786E\u4FDD\u53D8\u66F4\u4EE5\u6B63\u786E\u987A\u5E8F\u5F97\u5230\u6267\u884C\u3002\u5982\u679C\u65E7\u7248\u672C\u7684\u6587\u6863\u5728\u65B0\u7248\u672C\u4E4B\u540E\u5230\u8FBE\uFF0C\u5B83\u53EF\u4EE5\u88AB\u7B80\u5355\u7684\u5FFD\u7565\u3002</p><p>\u6211\u4EEC\u53EF\u4EE5\u5229\u7528version\u53F7\u6765\u786E\u4FDD\u5E94\u7528\u4E2D\u76F8\u4E92\u51B2\u7A81\u7684\u53D8\u66F4\u4E0D\u4F1A\u5BFC\u81F4\u6570\u636E\u4E22\u5931\u3002\u6211\u4EEC\u901A\u8FC7\u6307\u5B9A\u60F3\u8981\u4FEE\u6539\u6587\u6863\u7684 version\u53F7\u6765\u8FBE\u5230\u8FD9\u4E2A\u76EE\u7684\u3002\u5982\u679C\u8BE5\u7248\u672C\u4E0D\u662F\u5F53\u524D\u7248\u672C\u53F7\uFF0C\u6211\u4EEC\u7684\u8BF7\u6C42\u5C06\u4F1A\u5931\u8D25\u3002</p><p>\u8001\u7684\u7248\u672Ces\u4F7F\u7528version\uFF0C\u4F46\u662F\u65B0\u7248\u672C\u4E0D\u652F\u6301\u4E86\uFF0C\u4F1A\u62A5\u4E0B\u9762\u7684\u9519\u8BEF\uFF0C\u63D0\u793A\u6211\u4EEC\u7528if_seq _no\u548Cif _primary_term</p><p>\u521B\u5EFA\u7D22\u5F15</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/shopping/_create/1001</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">15</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u66F4\u65B0\u6570\u636E</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#POST http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/shopping/_update/1001</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;doc&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">15</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u65E7\u7248\u672C\u4F7F\u7528\u7684\u9632\u6B62\u51B2\u7A81\u66F4\u65B0\u65B9\u6CD5\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#POST http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/shopping/_update/1001?version=1</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;doc&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A2&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;root_cause&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;action_request_validation_exception&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Validation Failed: 1: internal versioning can not be used for optimistic concurrency control. Please use \`if_seq_no\` and \`if_primary_term\` instead;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;action_request_validation_exception&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Validation Failed: 1: internal versioning can not be used for optimistic concurrency control. Please use \`if_seq_no\` and \`if_primary_term\` instead;&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">400</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u65B0\u7248\u672C\u4F7F\u7528\u7684\u9632\u6B62\u51B2\u7A81\u66F4\u65B0\u65B9\u6CD5\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#POST http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/shopping/_update/1001?if_seq_no=11&amp;if_primary_term=15</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;doc&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A2&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">16</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5916\u90E8\u7CFB\u7EDF\u7248\u672C\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#\u5916\u90E8\u7CFB\u7EDF\u7248\u672C\u63A7\u5236" aria-hidden="true">#</a> \u5916\u90E8\u7CFB\u7EDF\u7248\u672C\u63A7\u5236</h4><p>\u4E00\u4E2A\u5E38\u89C1\u7684\u8BBE\u7F6E\u662F\u4F7F\u7528\u5176\u5B83\u6570\u636E\u5E93\u4F5C\u4E3A\u4E3B\u8981\u7684\u6570\u636E\u5B58\u50A8\uFF0C\u4F7F\u7528Elasticsearch\u505A\u6570\u636E\u68C0\u7D22\uFF0C\u8FD9\u610F\u5473\u7740\u4E3B\u6570\u636E\u5E93\u7684\u6240\u6709\u66F4\u6539\u53D1\u751F\u65F6\u90FD\u9700\u8981\u88AB\u590D\u5236\u5230Elasticsearch\uFF0C\u5982\u679C\u591A\u4E2A\u8FDB\u7A0B\u8D1F\u8D23\u8FD9\u4E00\u6570\u636E\u540C\u6B65\uFF0C\u4F60\u53EF\u80FD\u9047\u5230\u7C7B\u4F3C\u4E8E\u4E4B\u524D\u63CF\u8FF0\u7684\u5E76\u53D1\u95EE\u9898\u3002</p><p>\u5982\u679C\u4F60\u7684\u4E3B\u6570\u636E\u5E93\u5DF2\u7ECF\u6709\u4E86\u7248\u672C\u53F7\uFF0C\u6216\u4E00\u4E2A\u80FD\u4F5C\u4E3A\u7248\u672C\u53F7\u7684\u5B57\u6BB5\u503C\u6BD4\u5982timestamp\uFF0C\u90A3\u4E48\u4F60\u5C31\u53EF\u4EE5\u5728 Elasticsearch \u4E2D\u901A\u8FC7\u589E\u52A0 version_type=extermal\u5230\u67E5\u8BE2\u5B57\u7B26\u4E32\u7684\u65B9\u5F0F\u91CD\u7528\u8FD9\u4E9B\u76F8\u540C\u7684\u7248\u672C\u53F7\uFF0C\u7248\u672C\u53F7\u5FC5\u987B\u662F\u5927\u4E8E\u96F6\u7684\u6574\u6570\uFF0C\u4E14\u5C0F\u4E8E9.2E+18\uFF0C\u4E00\u4E2AJava\u4E2D long\u7C7B\u578B\u7684\u6B63\u503C\u3002</p><p>\u5916\u90E8\u7248\u672C\u53F7\u7684\u5904\u7406\u65B9\u5F0F\u548C\u6211\u4EEC\u4E4B\u524D\u8BA8\u8BBA\u7684\u5185\u90E8\u7248\u672C\u53F7\u7684\u5904\u7406\u65B9\u5F0F\u6709\u4E9B\u4E0D\u540C\uFF0CElasticsearch\u4E0D\u662F\u68C0\u67E5\u5F53\u524D_version\u548C\u8BF7\u6C42\u4E2D\u6307\u5B9A\u7684\u7248\u672C\u53F7\u662F\u5426\u76F8\u540C\uFF0C\u800C\u662F\u68C0\u67E5\u5F53\u524D_version\u662F\u5426\u5C0F\u4E8E\u6307\u5B9A\u7684\u7248\u672C\u53F7\u3002\u5982\u679C\u8BF7\u6C42\u6210\u529F\uFF0C\u5916\u90E8\u7684\u7248\u672C\u53F7\u4F5C\u4E3A\u6587\u6863\u7684\u65B0_version\u8FDB\u884C\u5B58\u50A8\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#POST http<span class="token operator">:</span><span class="token comment">//127.0.0.1:9200/shopping/_doc/1001?version=300&amp;version_type=external</span>
<span class="token punctuation">{</span>
	<span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A2&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD4\u56DE\u7ED3\u679C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">16</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_48-\u8FDB\u9636-\u6587\u6863\u5C55\u793A-kibana" tabindex="-1"><a class="header-anchor" href="#_48-\u8FDB\u9636-\u6587\u6863\u5C55\u793A-kibana" aria-hidden="true">#</a> 48-\u8FDB\u9636-\u6587\u6863\u5C55\u793A-Kibana</h3><p>Kibana\u662F\u4E00\u4E2A\u514D\u8D39\u4E14\u5F00\u653E\u7684\u7528\u6237\u754C\u9762\uFF0C\u80FD\u591F\u8BA9\u4F60\u5BF9Elasticsearch \u6570\u636E\u8FDB\u884C\u53EF\u89C6\u5316\uFF0C\u5E76\u8BA9\u4F60\u5728Elastic Stack \u4E2D\u8FDB\u884C\u5BFC\u822A\u3002\u4F60\u53EF\u4EE5\u8FDB\u884C\u5404\u79CD\u64CD\u4F5C\uFF0C\u4ECE\u8DDF\u8E2A\u67E5\u8BE2\u8D1F\u8F7D\uFF0C\u5230\u7406\u89E3\u8BF7\u6C42\u5982\u4F55\u6D41\u7ECF\u4F60\u7684\u6574\u4E2A\u5E94\u7528\uFF0C\u90FD\u80FD\u8F7B\u677E\u5B8C\u6210\u3002</p>`,72),C={href:"https://artifacts.elastic.co/downloads/kibana/kibana-7.8.0-windows-x86_64.zip",target:"_blank",rel:"noopener noreferrer"},A=s("Kibana\u4E0B\u8F7D\u7F51\u5740"),D=p(`<p>\u4E00\u3001\u89E3\u538B\u7F29\u4E0B\u8F7D\u7684 zip \u6587\u4EF6\u3002</p><p>\u4E8C\u3001\u4FEE\u6539 config/kibana.yml \u6587\u4EF6\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># \u9ED8\u8BA4\u7AEF\u53E3</span>
<span class="token key atrule">server.port</span><span class="token punctuation">:</span> <span class="token number">5601</span>
<span class="token comment"># ES \u670D\u52A1\u5668\u7684\u5730\u5740</span>
<span class="token key atrule">elasticsearch.hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;http://localhost:9200&quot;</span><span class="token punctuation">]</span>
<span class="token comment"># \u7D22\u5F15\u540D</span>
<span class="token key atrule">kibana.index</span><span class="token punctuation">:</span> <span class="token string">&quot;.kibana&quot;</span>
<span class="token comment"># \u652F\u6301\u4E2D\u6587</span>
<span class="token key atrule">i18n.locale</span><span class="token punctuation">:</span> <span class="token string">&quot;zh-CN&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u3001Windows \u73AF\u5883\u4E0B\u6267\u884C bin/kibana.bat \u6587\u4EF6\u3002\uFF08\u9996\u6B21\u542F\u52A8\u6709\u70B9\u8017\u65F6\uFF09</p><p>\u56DB\u3001\u901A\u8FC7\u6D4F\u89C8\u5668\u8BBF\u95EE\uFF1Ahttp://localhost:5601\u3002</p><p><img src="https://qiniu.xinghe.fit/Elasticsearch/d066ba5e26916624b5d056d04c5580ac.png" alt=""></p><h2 id="\u7B2C5\u7AE0-elasticsearch\u96C6\u6210" tabindex="-1"><a class="header-anchor" href="#\u7B2C5\u7AE0-elasticsearch\u96C6\u6210" aria-hidden="true">#</a> \u7B2C5\u7AE0 Elasticsearch\u96C6\u6210</h2><h3 id="_49-\u6846\u67B6\u96C6\u6210-springdata-\u6574\u4F53\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_49-\u6846\u67B6\u96C6\u6210-springdata-\u6574\u4F53\u4ECB\u7ECD" aria-hidden="true">#</a> 49-\u6846\u67B6\u96C6\u6210-SpringData-\u6574\u4F53\u4ECB\u7ECD</h3><p>Spring Data\u662F\u4E00\u4E2A\u7528\u4E8E\u7B80\u5316\u6570\u636E\u5E93\u3001\u975E\u5173\u7CFB\u578B\u6570\u636E\u5E93\u3001\u7D22\u5F15\u5E93\u8BBF\u95EE\uFF0C\u5E76\u652F\u6301\u4E91\u670D\u52A1\u7684\u5F00\u6E90\u6846\u67B6\u3002\u5176\u4E3B\u8981\u76EE\u6807\u662F\u4F7F\u5F97\u5BF9\u6570\u636E\u7684\u8BBF\u95EE\u53D8\u5F97\u65B9\u4FBF\u5FEB\u6377\uFF0C\u5E76\u652F\u6301 map-reduce\u6846\u67B6\u548C\u4E91\u8BA1\u7B97\u6570\u636E\u670D\u52A1\u3002Spring Data\u53EF\u4EE5\u6781\u5927\u7684\u7B80\u5316JPA(Elasticsearch\u2026)\u7684\u5199\u6CD5\uFF0C\u53EF\u4EE5\u5728\u51E0\u4E4E\u4E0D\u7528\u5199\u5B9E\u73B0\u7684\u60C5\u51B5\u4E0B\uFF0C\u5B9E\u73B0\u5BF9\u6570\u636E\u7684\u8BBF\u95EE\u548C\u64CD\u4F5C\u3002\u9664\u4E86CRUD \u5916\uFF0C\u8FD8\u5305\u62EC\u5982\u5206\u9875\u3001\u6392\u5E8F\u7B49\u4E00\u4E9B\u5E38\u7528\u7684\u529F\u80FD\u3002</p>`,9),N={href:"https://spring.io/projects/spring-data",target:"_blank",rel:"noopener noreferrer"},O=s("Spring Data \u7684\u5B98\u7F51"),M=p('<p>Spring Data \u5E38\u7528\u7684\u529F\u80FD\u6A21\u5757\u5982\u4E0B\uFF1A</p><ul><li>Spring Data JDBC</li><li>Spring Data JPA</li><li>Spring Data LDAP</li><li>Spring Data MongoDB</li><li>Spring Data Redis</li><li>Spring Data R2DBC</li><li>Spring Data REST</li><li>Spring Data for Apache Cassandra</li><li>Spring Data for Apache Geode</li><li>Spring Data for Apache Solr</li><li>Spring Data for Pivotal GemFire</li><li>Spring Data Couchbase</li><li>Spring Data Elasticsearch</li><li>Spring Data Envers</li><li>Spring Data Neo4j</li><li>Spring Data JDBC Extensions</li><li>Spring for Apache Hadoop</li></ul><h4 id="spring-data-elasticsearch-\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#spring-data-elasticsearch-\u4ECB\u7ECD" aria-hidden="true">#</a> Spring Data Elasticsearch \u4ECB\u7ECD</h4><p>Spring Data Elasticsearch\u57FA\u4E8ESpring Data API\u7B80\u5316 Elasticsearch \u64CD\u4F5C\uFF0C\u5C06\u539F\u59CB\u64CD\u4F5CElasticsearch \u7684\u5BA2\u6237\u7AEFAPI\u8FDB\u884C\u5C01\u88C5\u3002Spring Data\u4E3AElasticsearch \u9879\u76EE\u63D0\u4F9B\u96C6\u6210\u641C\u7D22\u5F15\u64CE\u3002Spring Data Elasticsearch POJO\u7684\u5173\u952E\u529F\u80FD\u533A\u57DF\u4E3A\u4E2D\u5FC3\u7684\u6A21\u578B\u4E0EElastichsearch\u4EA4\u4E92\u6587\u6863\u548C\u8F7B\u677E\u5730\u7F16\u5199\u4E00\u4E2A\u5B58\u50A8\u7D22\u5F15\u5E93\u6570\u636E\u8BBF\u95EE\u5C42\u3002</p>',4),L={href:"https://spring.io/projects/spring-data-elasticsearch",target:"_blank",rel:"noopener noreferrer"},Q=s("Spring Data Elasticsearch \u5B98\u7F51"),z=p(`<h3 id="_50-\u6846\u67B6\u96C6\u6210-springdata-\u4EE3\u7801\u529F\u80FD\u96C6\u6210" tabindex="-1"><a class="header-anchor" href="#_50-\u6846\u67B6\u96C6\u6210-springdata-\u4EE3\u7801\u529F\u80FD\u96C6\u6210" aria-hidden="true">#</a> 50-\u6846\u67B6\u96C6\u6210-SpringData-\u4EE3\u7801\u529F\u80FD\u96C6\u6210</h3><p>\u4E00\u3001\u521B\u5EFAMaven\u9879\u76EE\u3002</p><p>\u4E8C\u3001\u4FEE\u6539pom\u6587\u4EF6\uFF0C\u589E\u52A0\u4F9D\u8D56\u5173\u7CFB\u3002</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.lun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>SpringDataWithES<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u3001\u589E\u52A0\u914D\u7F6E\u6587\u4EF6\u3002</p><p>\u5728 resources \u76EE\u5F55\u4E2D\u589E\u52A0application.properties\u6587\u4EF6</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># es \u670D\u52A1\u5730\u5740</span>
<span class="token key attr-name">elasticsearch.host</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token comment"># es \u670D\u52A1\u7AEF\u53E3</span>
<span class="token key attr-name">elasticsearch.port</span><span class="token punctuation">=</span><span class="token value attr-value">9200</span>
<span class="token comment"># \u914D\u7F6E\u65E5\u5FD7\u7EA7\u522B,\u5F00\u542F debug \u65E5\u5FD7</span>
<span class="token key attr-name">logging.level.com.atguigu.es</span><span class="token punctuation">=</span><span class="token value attr-value">debug</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u56DB\u3001Spring Boot \u4E3B\u7A0B\u5E8F\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MainApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E94\u3001\u6570\u636E\u5B9E\u4F53\u7C7B\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">ToString</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">FieldType</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">&quot;shopping&quot;</span><span class="token punctuation">,</span> shards <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> replicas <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u5FC5\u987B\u6709 id,\u8FD9\u91CC\u7684 id \u662F\u5168\u5C40\u552F\u4E00\u7684\u6807\u8BC6\uFF0C\u7B49\u540C\u4E8E es \u4E2D\u7684&quot;_id&quot;</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span><span class="token comment">//\u5546\u54C1\u552F\u4E00\u6807\u8BC6</span>

    <span class="token doc-comment comment">/**
     * type : \u5B57\u6BB5\u6570\u636E\u7C7B\u578B
     * analyzer : \u5206\u8BCD\u5668\u7C7B\u578B
     * index : \u662F\u5426\u7D22\u5F15(\u9ED8\u8BA4:true)
     * Keyword : \u77ED\u8BED,\u4E0D\u8FDB\u884C\u5206\u8BCD
     */</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> analyzer <span class="token operator">=</span> <span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span><span class="token comment">//\u5546\u54C1\u540D\u79F0</span>

    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> category<span class="token punctuation">;</span><span class="token comment">//\u5206\u7C7B\u540D\u79F0</span>

    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Double</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Double</span> price<span class="token punctuation">;</span><span class="token comment">//\u5546\u54C1\u4EF7\u683C</span>

    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> images<span class="token punctuation">;</span><span class="token comment">//\u56FE\u7247\u5730\u5740</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u516D\u3001\u914D\u7F6E\u7C7B</p><ul><li>ElasticsearchRestTemplate\u662Fspring-data-elasticsearch\u9879\u76EE\u4E2D\u7684\u4E00\u4E2A\u7C7B,\u548C\u5176\u4ED6spring\u9879\u76EE\u4E2D\u7684 template\u7C7B\u4F3C\u3002</li><li>\u5728\u65B0\u7248\u7684spring-data-elasticsearch \u4E2D\uFF0CElasticsearchRestTemplate \u4EE3\u66FF\u4E86\u539F\u6765\u7684ElasticsearchTemplate\u3002</li><li>\u539F\u56E0\u662FElasticsearchTemplate\u57FA\u4E8ETransportClient\uFF0CTransportClient\u5373\u5C06\u57288.x \u4EE5\u540E\u7684\u7248\u672C\u4E2D\u79FB\u9664\u3002\u6240\u4EE5\uFF0C\u6211\u4EEC\u63A8\u8350\u4F7F\u7528ElasticsearchRestTemplate\u3002</li><li>ElasticsearchRestTemplate\u57FA\u4E8ERestHighLevelClient\u5BA2\u6237\u7AEF\u7684\u3002\u9700\u8981\u81EA\u5B9A\u4E49\u914D\u7F6E\u7C7B\uFF0C\u7EE7\u627FAbstractElasticsearchConfiguration\uFF0C\u5E76\u5B9E\u73B0elasticsearchClient()\u62BD\u8C61\u65B9\u6CD5\uFF0C\u521B\u5EFARestHighLevelClient\u5BF9\u8C61\u3002</li></ul><p>AbstractElasticsearchConfiguration\u6E90\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchOperations</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchRestTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>core<span class="token punctuation">.</span>convert<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchConverter</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> Christoph Strobl
 * <span class="token keyword">@author</span> Peter-Josef Meisch
 * <span class="token keyword">@since</span> 3.2
 * <span class="token keyword">@see</span> <span class="token reference"><span class="token class-name">ElasticsearchConfigurationSupport</span></span>
 */</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractElasticsearchConfiguration</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchConfigurationSupport</span> <span class="token punctuation">{</span>

	<span class="token comment">//\u9700\u91CD\u5199\u672C\u65B9\u6CD5</span>
	<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">RestHighLevelClient</span> <span class="token function">elasticsearchClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;elasticsearchOperations&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;elasticsearchTemplate&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">ElasticsearchOperations</span> <span class="token function">elasticsearchOperations</span><span class="token punctuation">(</span><span class="token class-name">ElasticsearchConverter</span> elasticsearchConverter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchRestTemplate</span><span class="token punctuation">(</span><span class="token function">elasticsearchClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> elasticsearchConverter<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u81EA\u5B9A\u4E49\u914D\u7F6E\u7C7B\uFF0C\u7EE7\u627FAbstractElasticsearchConfiguration\uFF0C\u5E76\u5B9E\u73B0elasticsearchClient()\u62BD\u8C61\u65B9\u6CD5\uFF0C\u521B\u5EFARestHighLevelClient\u5BF9\u8C61\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClientBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestHighLevelClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">AbstractElasticsearchConfiguration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;elasticsearch&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ElasticsearchConfig</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractElasticsearchConfiguration</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> host <span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> port <span class="token punctuation">;</span>
    <span class="token comment">//\u91CD\u5199\u7236\u7C7B\u65B9\u6CD5</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">RestHighLevelClient</span> <span class="token function">elasticsearchClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RestClientBuilder</span> builder <span class="token operator">=</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RestHighLevelClient</span> restHighLevelClient <span class="token operator">=</span> <span class="token keyword">new</span>
                <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> restHighLevelClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E03\u3001DAO \u6570\u636E\u8BBF\u95EE\u5BF9\u8C61</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchRepository</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProductDao</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_51-\u6846\u67B6\u96C6\u6210-springdata-\u96C6\u6210\u6D4B\u8BD5-\u7D22\u5F15\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_51-\u6846\u67B6\u96C6\u6210-springdata-\u96C6\u6210\u6D4B\u8BD5-\u7D22\u5F15\u64CD\u4F5C" aria-hidden="true">#</a> 51-\u6846\u67B6\u96C6\u6210-SpringData-\u96C6\u6210\u6D4B\u8BD5-\u7D22\u5F15\u64CD\u4F5C</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchRestTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDataESIndexTest</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u6CE8\u5165 ElasticsearchRestTemplate</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ElasticsearchRestTemplate</span> elasticsearchRestTemplate<span class="token punctuation">;</span>
    <span class="token comment">//\u521B\u5EFA\u7D22\u5F15\u5E76\u589E\u52A0\u6620\u5C04\u914D\u7F6E</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u521B\u5EFA\u7D22\u5F15\uFF0C\u7CFB\u7EDF\u521D\u59CB\u5316\u4F1A\u81EA\u52A8\u521B\u5EFA\u7D22\u5F15</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u521B\u5EFA\u7D22\u5F15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u521B\u5EFA\u7D22\u5F15\uFF0C\u7CFB\u7EDF\u521D\u59CB\u5316\u4F1A\u81EA\u52A8\u521B\u5EFA\u7D22\u5F15</span>
        <span class="token keyword">boolean</span> flg <span class="token operator">=</span> elasticsearchRestTemplate<span class="token punctuation">.</span><span class="token function">deleteIndex</span><span class="token punctuation">(</span><span class="token class-name">Product</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5220\u9664\u7D22\u5F15 = &quot;</span> <span class="token operator">+</span> flg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7528Postman \u68C0\u6D4B\u6709\u6CA1\u6709\u521B\u5EFA\u548C\u5220\u9664\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#GET http<span class="token operator">:</span><span class="token comment">//localhost:9200/_cat/indices?v </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_52-\u6846\u67B6\u96C6\u6210-springdata-\u96C6\u6210\u6D4B\u8BD5-\u6587\u6863\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_52-\u6846\u67B6\u96C6\u6210-springdata-\u96C6\u6210\u6D4B\u8BD5-\u6587\u6863\u64CD\u4F5C" aria-hidden="true">#</a> 52-\u6846\u67B6\u96C6\u6210-SpringData-\u96C6\u6210\u6D4B\u8BD5-\u6587\u6863\u64CD\u4F5C</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">ProductDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Page</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">PageRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Sort</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDataESProductDaoTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProductDao</span> productDao<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * \u65B0\u589E
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;\u534E\u4E3A\u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">2999.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setImages</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.atguigu/hw.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        productDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//POSTMAN, GET http://localhost:9200/product/_doc/2</span>

    <span class="token comment">//\u4FEE\u6539</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;\u5C0F\u7C73 2 \u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">9999.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setImages</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.atguigu/xm.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        productDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//POSTMAN, GET http://localhost:9200/product/_doc/2</span>
    <span class="token comment">//\u6839\u636E id \u67E5\u8BE2</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Product</span> product <span class="token operator">=</span> productDao<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
        <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products <span class="token operator">=</span> productDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> product <span class="token operator">:</span> products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//\u5220\u9664</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        productDao<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//POSTMAN, GET http://localhost:9200/product/_doc/2</span>

    <span class="token comment">//\u6279\u91CF\u65B0\u589E</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> productList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            product<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">&quot;]\u5C0F\u7C73\u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            product<span class="token punctuation">.</span><span class="token function">setCategory</span><span class="token punctuation">(</span><span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            product<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">1999.0</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            product<span class="token punctuation">.</span><span class="token function">setImages</span><span class="token punctuation">(</span><span class="token string">&quot;http://www.atguigu/xm.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            productList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        productDao<span class="token punctuation">.</span><span class="token function">saveAll</span><span class="token punctuation">(</span>productList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//\u5206\u9875\u67E5\u8BE2</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findByPageable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//\u8BBE\u7F6E\u6392\u5E8F(\u6392\u5E8F\u65B9\u5F0F\uFF0C\u6B63\u5E8F\u8FD8\u662F\u5012\u5E8F\uFF0C\u6392\u5E8F\u7684 id)</span>
        <span class="token class-name">Sort</span> sort <span class="token operator">=</span> <span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Direction</span><span class="token punctuation">.</span>DESC<span class="token punctuation">,</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> currentPage<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//\u5F53\u524D\u9875\uFF0C\u7B2C\u4E00\u9875\u4ECE 0 \u5F00\u59CB\uFF0C 1 \u8868\u793A\u7B2C\u4E8C\u9875</span>
        <span class="token keyword">int</span> pageSize <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//\u6BCF\u9875\u663E\u793A\u591A\u5C11\u6761</span>
        <span class="token comment">//\u8BBE\u7F6E\u67E5\u8BE2\u5206\u9875</span>
        <span class="token class-name">PageRequest</span> pageRequest <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>currentPage<span class="token punctuation">,</span> pageSize<span class="token punctuation">,</span>sort<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5206\u9875\u67E5\u8BE2</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> productPage <span class="token operator">=</span> productDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>pageRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> <span class="token class-name">Product</span> <span class="token operator">:</span> productPage<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Product</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_53-\u6846\u67B6\u96C6\u6210-springdata-\u96C6\u6210\u6D4B\u8BD5-\u6587\u6863\u641C\u7D22" tabindex="-1"><a class="header-anchor" href="#_53-\u6846\u67B6\u96C6\u6210-springdata-\u96C6\u6210\u6D4B\u8BD5-\u6587\u6863\u641C\u7D22" aria-hidden="true">#</a> 53-\u6846\u67B6\u96C6\u6210-SpringData-\u96C6\u6210\u6D4B\u8BD5-\u6587\u6863\u641C\u7D22</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">ProductDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>lun<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryBuilders</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>index<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">TermQueryBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">PageRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDataESSearchTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProductDao</span> productDao<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * term \u67E5\u8BE2
     * search(termQueryBuilder) \u8C03\u7528\u641C\u7D22\u65B9\u6CD5\uFF0C\u53C2\u6570\u67E5\u8BE2\u6784\u5EFA\u5668\u5BF9\u8C61
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">TermQueryBuilder</span> termQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products <span class="token operator">=</span> productDao<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>termQueryBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> product <span class="token operator">:</span> products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**
     * term \u67E5\u8BE2\u52A0\u5206\u9875
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">termQueryByPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> currentPage<span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>
        <span class="token keyword">int</span> pageSize <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token comment">//\u8BBE\u7F6E\u67E5\u8BE2\u5206\u9875</span>
        <span class="token class-name">PageRequest</span> pageRequest <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>currentPage<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TermQueryBuilder</span> termQueryBuilder <span class="token operator">=</span> <span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">termQuery</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5C0F\u7C73&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">&gt;</span></span> products <span class="token operator">=</span>
                        productDao<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>termQueryBuilder<span class="token punctuation">,</span>pageRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Product</span> product <span class="token operator">:</span> products<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_54-\u6846\u67B6\u96C6\u6210-sparkstreaming-\u96C6\u6210" tabindex="-1"><a class="header-anchor" href="#_54-\u6846\u67B6\u96C6\u6210-sparkstreaming-\u96C6\u6210" aria-hidden="true">#</a> 54-\u6846\u67B6\u96C6\u6210-SparkStreaming-\u96C6\u6210</h3><p>Spark Streaming \u662FSpark core API\u7684\u6269\u5C55\uFF0C\u652F\u6301\u5B9E\u65F6\u6570\u636E\u6D41\u7684\u5904\u7406\uFF0C\u5E76\u4E14\u5177\u6709\u53EF\u6269\u5C55\uFF0C\u9AD8\u541E\u5410\u91CF\uFF0C\u5BB9\u9519\u7684\u7279\u70B9\u3002\u6570\u636E\u53EF\u4EE5\u4ECE\u8BB8\u591A\u6765\u6E90\u83B7\u53D6,\u5982Kafka\uFF0C Flume\uFF0CKinesis\u6216TCP sockets\uFF0C\u5E76\u4E14\u53EF\u4EE5\u4F7F\u7528\u590D\u6742\u7684\u7B97\u6CD5\u8FDB\u884C\u5904\u7406\uFF0C\u8FD9\u4E9B\u7B97\u6CD5\u4F7F\u7528\u8BF8\u5982 map\uFF0Creduce\uFF0Cjoin\u548C window\u7B49\u9AD8\u7EA7\u51FD\u6570\u8868\u793A\u3002\u6700\u540E\uFF0C\u5904\u7406\u540E\u7684\u6570\u636E\u53EF\u4EE5\u63A8\u9001\u5230\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u6570\u636E\u5E93\u7B49\u3002\u5B9E\u9645\u4E0A\uFF0C\u60A8\u53EF\u4EE5\u5C06Spark\u7684\u673A\u5668\u5B66\u4E60\u548C\u56FE\u5F62\u5904\u7406\u7B97\u6CD5\u5E94\u7528\u4E8E\u6570\u636E\u6D41\u3002</p><p>\u4E00\u3001\u521B\u5EFAMaven\u9879\u76EE\u3002</p><p>\u4E8C\u3001\u4FEE\u6539 pom \u6587\u4EF6\uFF0C\u589E\u52A0\u4F9D\u8D56\u5173\u7CFB\u3002</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span>
    <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.lun.es<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sparkstreaming-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-core_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-streaming_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- elasticsearch \u7684\u5BA2\u6237\u7AEF --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- elasticsearch \u4F9D\u8D56 2.x \u7684 log4j --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- &lt;dependency&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;version&gt;2.11.1&lt;/version&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;/dependency&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &amp;lt;!&amp;ndash; junit \u5355\u5143\u6D4B\u8BD5 &amp;ndash;&amp;gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;dependency&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;groupId&gt;junit&lt;/groupId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;artifactId&gt;junit&lt;/artifactId&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;version&gt;4.12&lt;/version&gt;--&gt;</span>
        <span class="token comment">&lt;!-- &lt;/dependency&gt;--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u3001\u529F\u80FD\u5B9E\u73B0</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span></span><span class="token class-name">SparkConf</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>dstream<span class="token punctuation">.</span></span><span class="token class-name">ReceiverInputDStream</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span></span><span class="token punctuation">{</span><span class="token class-name">Seconds</span><span class="token punctuation">,</span> <span class="token class-name">StreamingContext</span><span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">IndexRequest</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">CreateIndexRequest</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token punctuation">{</span><span class="token class-name">RequestOptions</span><span class="token punctuation">,</span> <span class="token class-name">RestClient</span><span class="token punctuation">,</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>common<span class="token punctuation">.</span>xcontent<span class="token punctuation">.</span></span><span class="token class-name">XContentType</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span>

object <span class="token class-name">SparkStreamingESTest</span> <span class="token punctuation">{</span>

    def <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        val sparkConf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SparkConf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMaster</span><span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAppName</span><span class="token punctuation">(</span><span class="token string">&quot;ESTest&quot;</span><span class="token punctuation">)</span>
        val ssc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StreamingContext</span><span class="token punctuation">(</span>sparkConf<span class="token punctuation">,</span> <span class="token class-name">Seconds</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        val ds<span class="token operator">:</span> <span class="token class-name">ReceiverInputDStream</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> ssc<span class="token punctuation">.</span><span class="token function">socketTextStream</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span>
        ds<span class="token punctuation">.</span><span class="token function">foreachRDD</span><span class="token punctuation">(</span>
            rdd <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;*************** &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                rdd<span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span>
                    data <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
                        val client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span><span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">// \u65B0\u589E\u6587\u6863 - \u8BF7\u6C42\u5BF9\u8C61</span>
                        val request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        
                        <span class="token comment">// \u8BBE\u7F6E\u7D22\u5F15\u53CA\u552F\u4E00\u6027\u6807\u8BC6</span>
                        val ss <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
                        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ss = &quot;</span> <span class="token operator">+</span> ss<span class="token punctuation">.</span><span class="token function">mkString</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        request<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;sparkstreaming&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token function">ss</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        
                        val productJson <span class="token operator">=</span>
                            s<span class="token triple-quoted-string string">&quot;&quot;&quot;
                            | { &quot;data&quot;:&quot;\${ss(1)}&quot; }
                            |&quot;&quot;&quot;</span><span class="token punctuation">.</span>stripMargin<span class="token punctuation">;</span>
                        
                        <span class="token comment">// \u6DFB\u52A0\u6587\u6863\u6570\u636E\uFF0C\u6570\u636E\u683C\u5F0F\u4E3A JSON \u683C\u5F0F</span>
                        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>productJson<span class="token punctuation">,</span><span class="token class-name">XContentType</span><span class="token punctuation">.</span>JSON<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        
                        <span class="token comment">// \u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\uFF0C\u83B7\u53D6\u54CD\u5E94\u5BF9\u8C61</span>
                        val response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>
                        <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_index:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_id:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;_result:&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
        ssc<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ssc<span class="token punctuation">.</span><span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_55-\u6846\u67B6\u96C6\u6210-flink-\u96C6\u6210" tabindex="-1"><a class="header-anchor" href="#_55-\u6846\u67B6\u96C6\u6210-flink-\u96C6\u6210" aria-hidden="true">#</a> 55-\u6846\u67B6\u96C6\u6210-Flink-\u96C6\u6210</h3><p>Apache Spark\u662F\u4E00-\u79CD\u57FA\u4E8E\u5185\u5B58\u7684\u5FEB\u901F\u3001\u901A\u7528\u3001\u53EF\u6269\u5C55\u7684\u5927\u6570\u636E\u5206\u6790\u8BA1\u7B97\u5F15\u64CE\u3002Apache Spark\u6380\u5F00\u4E86\u5185\u5B58\u8BA1\u7B97\u7684\u5148\u6CB3\uFF0C\u4EE5\u5185\u5B58\u4F5C\u4E3A\u8D4C\u6CE8\uFF0C\u8D0F\u5F97\u4E86\u5185\u5B58\u8BA1\u7B97\u7684\u98DE\u901F\u53D1\u5C55\u3002\u4F46\u662F\u5728\u5176\u706B\u70ED\u7684\u540C\u65F6\uFF0C\u5F00\u53D1\u4EBA\u5458\u53D1\u73B0\uFF0C\u5728Spark\u4E2D\uFF0C\u8BA1\u7B97\u6846\u67B6\u666E\u904D\u5B58\u5728\u7684\u7F3A\u70B9\u548C\u4E0D\u8DB3\u4F9D\u7136\u6CA1\u6709\u5B8C\u5168\u89E3\u51B3\uFF0C\u800C\u8FD9\u4E9B\u95EE\u9898\u968F\u77405G\u65F6\u4EE3\u7684\u6765\u4E34\u4EE5\u53CA\u51B3\u7B56\u8005\u5BF9\u5B9E\u65F6\u6570\u636E\u5206\u6790\u7ED3\u679C\u7684\u8FEB\u5207\u9700\u8981\u800C\u51F8\u663E\u7684\u66F4\u52A0\u660E\u663E\uFF1A</p><ul><li>\u4E71\u5E8F\u6570\u636E\uFF0C\u8FDF\u5230\u6570\u636E</li><li>\u4F4E\u5EF6\u8FDF\uFF0C\u9AD8\u541E\u5410\uFF0C\u51C6\u786E\u6027</li><li>\u5BB9\u9519\u6027</li><li>\u6570\u636E\u7CBE\u51C6\u4E00\u6B21\u6027\u5904\u7406\uFF08Exactly-Once\uFF09</li></ul><p>Apache Flink\u662F\u4E00\u4E2A\u6846\u67B6\u548C\u5206\u5E03\u5F0F\u5904\u7406\u5F15\u64CE\uFF0C\u7528\u4E8E\u5BF9\u65E0\u754C\u548C\u6709\u754C\u6570\u636E\u6D41\u8FDB\u884C\u6709\u72B6\u6001\u8BA1\u7B97\u3002\u5728Spark\u706B\u70ED\u7684\u540C\u65F6\uFF0C\u4E5F\u9ED8\u9ED8\u5730\u53D1\u5C55\u81EA\u5DF1\uFF0C\u5E76\u5C1D\u8BD5\u7740\u89E3\u51B3\u5176\u4ED6\u8BA1\u7B97\u6846\u67B6\u7684\u95EE\u9898\u3002\u6162\u6162\u5730\uFF0C\u968F\u7740\u8FD9\u4E9B\u95EE\u9898\u7684\u89E3\u51B3\uFF0CFlink \u6162\u6162\u88AB\u7EDD\u5927\u6570\u7A0B\u5E8F\u5458\u6240\u719F\u77E5\u5E76\u8FDB\u884C\u5927\u529B\u63A8\u5E7F\uFF0C\u963F\u91CC\u516C\u53F8\u57282015\u5E74\u6539\u8FDBFlink\uFF0C\u5E76\u521B\u5EFA\u4E86\u5185\u90E8\u5206\u652FBlink\uFF0C\u76EE\u524D\u670D\u52A1\u4E8E\u963F\u91CC\u96C6\u56E2\u5185\u90E8\u641C\u7D22\u3001\u63A8\u8350\u3001\u5E7F\u544A\u548C\u8682\u8681\u7B49\u5927\u91CF\u6838\u5FC3\u5B9E\u65F6\u4E1A\u52A1\u3002</p><p>\u4E00\u3001\u521B\u5EFAMaven\u9879\u76EE\u3002</p><p>\u4E8C\u3001\u4FEE\u6539 pom \u6587\u4EF6\uFF0C\u589E\u52A0\u76F8\u5173\u4F9D\u8D56\u7C7B\u5E93\u3002</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span>
    <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0
http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.lun.es<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-elasticsearch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-scala_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-streaming-scala_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-clients_2.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.flink<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flink-connector-elasticsearch7_2.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- jackson --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.11.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u3001\u529F\u80FD\u5B9E\u73B0</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>api<span class="token punctuation">.</span>common<span class="token punctuation">.</span>functions<span class="token punctuation">.</span></span><span class="token class-name">RuntimeContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>datastream<span class="token punctuation">.</span></span><span class="token class-name">DataStreamSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>environment<span class="token punctuation">.</span></span><span class="token class-name">StreamExecutionEnvironment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>connectors<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchSinkFunction</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>connectors<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span></span><span class="token class-name">RequestIndexer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>connectors<span class="token punctuation">.</span>elasticsearch7<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchSink</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>action<span class="token punctuation">.</span>index<span class="token punctuation">.</span></span><span class="token class-name">IndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">Requests</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlinkElasticsearchSinkTest</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

		<span class="token class-name">StreamExecutionEnvironment</span> env <span class="token operator">=</span> <span class="token class-name">StreamExecutionEnvironment</span><span class="token punctuation">.</span><span class="token function">getExecutionEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">DataStreamSource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> source <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">socketTextStream</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpHost</span><span class="token punctuation">&gt;</span></span> httpHosts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		httpHosts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//httpHosts.add(new HttpHost(&quot;10.2.3.1&quot;, 9200, &quot;http&quot;));</span>

		<span class="token comment">// use a ElasticsearchSink.Builder to create an ElasticsearchSink</span>
		<span class="token class-name">ElasticsearchSink<span class="token punctuation">.</span>Builder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> esSinkBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchSink<span class="token punctuation">.</span>Builder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>httpHosts<span class="token punctuation">,</span> 
			<span class="token keyword">new</span> <span class="token class-name">ElasticsearchSinkFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">public</span> <span class="token class-name">IndexRequest</span> <span class="token function">createIndexRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span> <span class="token class-name">Requests</span><span class="token punctuation">.</span><span class="token function">indexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;my-index&quot;</span><span class="token punctuation">)</span>
						<span class="token comment">//.type(&quot;my-type&quot;)</span>
						<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token annotation punctuation">@Override</span>
				<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">String</span> element<span class="token punctuation">,</span> <span class="token class-name">RuntimeContext</span> ctx<span class="token punctuation">,</span> <span class="token class-name">RequestIndexer</span> indexer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					indexer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">createIndexRequest</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">// configuration for the bulk requests; this instructs the sink to emit after every element, otherwise they would be buffered</span>
		esSinkBuilder<span class="token punctuation">.</span><span class="token function">setBulkFlushMaxActions</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// provide a RestClientFactory for custom configuration on the internally createdREST client</span>
		<span class="token comment">// esSinkBuilder.setRestClientFactory(</span>
		<span class="token comment">// restClientBuilder -&gt; {</span>
			<span class="token comment">// restClientBuilder.setDefaultHeaders(...)</span>
			<span class="token comment">// restClientBuilder.setMaxRetryTimeoutMillis(...)</span>
			<span class="token comment">// restClientBuilder.setPathPrefix(...)</span>
			<span class="token comment">// restClientBuilder.setHttpClientConfigCallback(...)</span>
		<span class="token comment">// }</span>
		<span class="token comment">// );</span>
		source<span class="token punctuation">.</span><span class="token function">addSink</span><span class="token punctuation">(</span>esSinkBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;flink-es&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u7B2C6\u7AE0-elasticsearch\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#\u7B2C6\u7AE0-elasticsearch\u4F18\u5316" aria-hidden="true">#</a> \u7B2C6\u7AE0 Elasticsearch\u4F18\u5316</h2><h3 id="_56-\u4F18\u5316-\u786C\u4EF6\u9009\u62E9" tabindex="-1"><a class="header-anchor" href="#_56-\u4F18\u5316-\u786C\u4EF6\u9009\u62E9" aria-hidden="true">#</a> 56-\u4F18\u5316-\u786C\u4EF6\u9009\u62E9</h3><p>Elasticsearch \u7684\u57FA\u7840\u662F Lucene\uFF0C\u6240\u6709\u7684\u7D22\u5F15\u548C\u6587\u6863\u6570\u636E\u662F\u5B58\u50A8\u5728\u672C\u5730\u7684\u78C1\u76D8\u4E2D\uFF0C\u5177\u4F53\u7684\u8DEF\u5F84\u53EF\u5728 ES \u7684\u914D\u7F6E\u6587\u4EF6\u2026/config/elasticsearch.yml\u4E2D\u914D\u7F6E\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#</span>
<span class="token comment"># Path to directory where to store the data (separate multiple locations by comma):</span>
<span class="token comment">#</span>
<span class="token key atrule">path.data</span><span class="token punctuation">:</span> /path/to/data
<span class="token comment">#</span>
<span class="token comment"># Path to log files:</span>
<span class="token comment">#</span>
<span class="token key atrule">path.logs</span><span class="token punctuation">:</span> /path/to/logs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u78C1\u76D8\u5728\u73B0\u4EE3\u670D\u52A1\u5668\u4E0A\u901A\u5E38\u90FD\u662F\u74F6\u9888\u3002Elasticsearch\u91CD\u5EA6\u4F7F\u7528\u78C1\u76D8\uFF0C\u4F60\u7684\u78C1\u76D8\u80FD\u5904\u7406\u7684\u541E\u5410\u91CF\u8D8A\u5927\uFF0C\u4F60\u7684\u8282\u70B9\u5C31\u8D8A\u7A33\u5B9A\u3002\u8FD9\u91CC\u6709\u4E00\u4E9B\u4F18\u5316\u78C1\u76D8I/O\u7684\u6280\u5DE7\uFF1A</p><ul><li>\u4F7F\u7528SSD\u5C31\u50CF\u5176\u4ED6\u5730\u65B9\u63D0\u8FC7\u7684\uFF0C\u4ED6\u4EEC\u6BD4\u673A\u68B0\u78C1\u76D8\u4F18\u79C0\u591A\u4E86\u3002</li><li>\u4F7F\u7528RAID0\u3002\u6761\u5E26\u5316RAID\u4F1A\u63D0\u9AD8\u78C1\u76D8IO\uFF0C\u4EE3\u4EF7\u663E\u7136\u5C31\u662F\u5F53\u4E00\u5757\u786C\u76D8\u6545\u969C\u65F6\u6574\u4E2A\u5C31\u6545\u969C\u4E86\u3002\u4E0D\u8981\u4F7F\u7528\u955C\u50CF\u6216\u8005\u5947\u5076\u6821\u9A8CRAID\uFF0C\u56E0\u4E3A\u526F\u672C\u5DF2\u7ECF\u63D0\u4F9B\u4E86\u8FD9\u4E2A\u529F\u80FD\u3002</li><li>\u53E6\u5916\uFF0C\u4F7F\u7528\u591A\u5757\u786C\u76D8\uFF0C\u5E76\u5141\u8BB8Elasticsearch \u901A\u8FC7\u591A\u4E2Apath data\u76EE\u5F55\u914D\u7F6E\u628A\u6570\u636E\u6761\u5E26\u5316\u5206\u914D\u5230\u5B83\u4EEC\u4E0A\u9762\u3002</li><li>\u4E0D\u8981\u4F7F\u7528\u8FDC\u7A0B\u6302\u8F7D\u7684\u5B58\u50A8\uFF0C\u6BD4\u5982NFS\u6216\u8005SMB/CIFS\u3002\u8FD9\u4E2A\u5F15\u5165\u7684\u5EF6\u8FDF\u5BF9\u6027\u80FD\u6765\u8BF4\u5B8C\u5168\u662F\u80CC\u9053\u800C\u9A70\u7684\u3002</li></ul><h3 id="_57-\u4F18\u5316-\u5206\u7247\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#_57-\u4F18\u5316-\u5206\u7247\u7B56\u7565" aria-hidden="true">#</a> 57-\u4F18\u5316-\u5206\u7247\u7B56\u7565</h3><h4 id="\u5408\u7406\u8BBE\u7F6E\u5206\u7247\u6570" tabindex="-1"><a class="header-anchor" href="#\u5408\u7406\u8BBE\u7F6E\u5206\u7247\u6570" aria-hidden="true">#</a> \u5408\u7406\u8BBE\u7F6E\u5206\u7247\u6570</h4><p>\u5206\u7247\u548C\u526F\u672C\u7684\u8BBE\u8BA1\u4E3A ES \u63D0\u4F9B\u4E86\u652F\u6301\u5206\u5E03\u5F0F\u548C\u6545\u969C\u8F6C\u79FB\u7684\u7279\u6027\uFF0C\u4F46\u5E76\u4E0D\u610F\u5473\u7740\u5206\u7247\u548C\u526F\u672C\u662F\u53EF\u4EE5\u65E0\u9650\u5206\u914D\u7684\u3002\u800C\u4E14\u7D22\u5F15\u7684\u5206\u7247\u5B8C\u6210\u5206\u914D\u540E\u7531\u4E8E\u7D22\u5F15\u7684\u8DEF\u7531\u673A\u5236\uFF0C\u6211\u4EEC\u662F\u4E0D\u80FD\u91CD\u65B0\u4FEE\u6539\u5206\u7247\u6570\u7684\u3002</p><p>\u53EF\u80FD\u6709\u4EBA\u4F1A\u8BF4\uFF0C\u6211\u4E0D\u77E5\u9053\u8FD9\u4E2A\u7D22\u5F15\u5C06\u6765\u4F1A\u53D8\u5F97\u591A\u5927\uFF0C\u5E76\u4E14\u8FC7\u540E\u6211\u4E5F\u4E0D\u80FD\u66F4\u6539\u7D22\u5F15\u7684\u5927\u5C0F\uFF0C\u6240\u4EE5\u4E3A\u4E86\u4FDD\u9669\u8D77\u89C1\uFF0C\u8FD8\u662F\u7ED9\u5B83\u8BBE\u4E3A 1000 \u4E2A\u5206\u7247\u5427\u3002\u4F46\u662F\u9700\u8981\u77E5\u9053\u7684\u662F\uFF0C\u4E00\u4E2A\u5206\u7247\u5E76\u4E0D\u662F\u6CA1\u6709\u4EE3\u4EF7\u7684\u3002\u9700\u8981\u4E86\u89E3\uFF1A</p><ul><li><p>\u4E00\u4E2A\u5206\u7247\u7684\u5E95\u5C42\u5373\u4E3A\u4E00\u4E2A Lucene \u7D22\u5F15\uFF0C\u4F1A\u6D88\u8017\u4E00\u5B9A\u6587\u4EF6\u53E5\u67C4\u3001\u5185\u5B58\u3001\u4EE5\u53CA CPU\u8FD0\u8F6C\u3002</p></li><li><p>\u6BCF\u4E00\u4E2A\u641C\u7D22\u8BF7\u6C42\u90FD\u9700\u8981\u547D\u4E2D\u7D22\u5F15\u4E2D\u7684\u6BCF\u4E00\u4E2A\u5206\u7247\uFF0C\u5982\u679C\u6BCF\u4E00\u4E2A\u5206\u7247\u90FD\u5904\u4E8E\u4E0D\u540C\u7684\u8282\u70B9\u8FD8\u597D\uFF0C \u4F46\u5982\u679C\u591A\u4E2A\u5206\u7247\u90FD\u9700\u8981\u5728\u540C\u4E00\u4E2A\u8282\u70B9\u4E0A\u7ADE\u4E89\u4F7F\u7528\u76F8\u540C\u7684\u8D44\u6E90\u5C31\u6709\u4E9B\u7CDF\u7CD5\u4E86\u3002</p></li><li><p>\u7528\u4E8E\u8BA1\u7B97\u76F8\u5173\u5EA6\u7684\u8BCD\u9879\u7EDF\u8BA1\u4FE1\u606F\u662F\u57FA\u4E8E\u5206\u7247\u7684\u3002\u5982\u679C\u6709\u8BB8\u591A\u5206\u7247\uFF0C\u6BCF\u4E00\u4E2A\u90FD\u53EA\u6709\u5F88\u5C11\u7684\u6570\u636E\u4F1A\u5BFC\u81F4\u5F88\u4F4E\u7684\u76F8\u5173\u5EA6\u3002</p></li></ul><p>\u4E00\u4E2A\u4E1A\u52A1\u7D22\u5F15\u5177\u4F53\u9700\u8981\u5206\u914D\u591A\u5C11\u5206\u7247\u53EF\u80FD\u9700\u8981\u67B6\u6784\u5E08\u548C\u6280\u672F\u4EBA\u5458\u5BF9\u4E1A\u52A1\u7684\u589E\u957F\u6709\u4E2A\u9884\u5148\u7684\u5224\u65AD\uFF0C\u6A2A\u5411\u6269\u5C55\u5E94\u5F53\u5206\u9636\u6BB5\u8FDB\u884C\u3002\u4E3A\u4E0B\u4E00\u9636\u6BB5\u51C6\u5907\u597D\u8DB3\u591F\u7684\u8D44\u6E90\u3002 \u53EA\u6709\u5F53\u4F60\u8FDB\u5165\u5230\u4E0B\u4E00\u4E2A\u9636\u6BB5\uFF0C\u4F60\u624D\u6709\u65F6\u95F4\u601D\u8003\u9700\u8981\u4F5C\u51FA\u54EA\u4E9B\u6539\u53D8\u6765\u8FBE\u5230\u8FD9\u4E2A\u9636\u6BB5\u3002\u4E00\u822C\u6765\u8BF4\uFF0C\u6211\u4EEC\u9075\u5FAA\u4E00\u4E9B\u539F\u5219\uFF1A</p><ul><li>\u63A7\u5236\u6BCF\u4E2A\u5206\u7247\u5360\u7528\u7684\u786C\u76D8\u5BB9\u91CF\u4E0D\u8D85\u8FC7 ES \u7684\u6700\u5927 JVM \u7684\u5806\u7A7A\u95F4\u8BBE\u7F6E\uFF08\u4E00\u822C\u8BBE\u7F6E\u4E0D\u8D85\u8FC7 32G\uFF0C\u53C2\u8003\u4E0B\u6587\u7684 JVM \u8BBE\u7F6E\u539F\u5219\uFF09\uFF0C\u56E0\u6B64\uFF0C\u5982\u679C\u7D22\u5F15\u7684\u603B\u5BB9\u91CF\u5728 500G \u5DE6\u53F3\uFF0C\u90A3\u5206\u7247\u5927\u5C0F\u5728 16 \u4E2A\u5DE6\u53F3\u5373\u53EF\uFF1B\u5F53\u7136\uFF0C\u6700\u597D\u540C\u65F6\u8003\u8651\u539F\u5219 2\u3002</li><li>\u8003\u8651\u4E00\u4E0B node \u6570\u91CF\uFF0C\u4E00\u822C\u4E00\u4E2A\u8282\u70B9\u6709\u65F6\u5019\u5C31\u662F\u4E00\u53F0\u7269\u7406\u673A\uFF0C\u5982\u679C\u5206\u7247\u6570\u8FC7\u591A\uFF0C\u5927\u5927\u8D85\u8FC7\u4E86\u8282\u70B9\u6570\uFF0C\u5F88\u53EF\u80FD\u4F1A\u5BFC\u81F4\u4E00\u4E2A\u8282\u70B9\u4E0A\u5B58\u5728\u591A\u4E2A\u5206\u7247\uFF0C\u4E00\u65E6\u8BE5\u8282\u70B9\u6545\u969C\uFF0C\u5373\u4F7F\u4FDD\u6301\u4E86 1 \u4E2A\u4EE5\u4E0A\u7684\u526F\u672C\uFF0C\u540C\u6837\u6709\u53EF\u80FD\u4F1A\u5BFC\u81F4\u6570\u636E\u4E22\u5931\uFF0C\u96C6\u7FA4\u65E0\u6CD5\u6062\u590D\u3002\u6240\u4EE5\uFF0C \u4E00\u822C\u90FD\u8BBE\u7F6E\u5206\u7247\u6570\u4E0D\u8D85\u8FC7\u8282\u70B9\u6570\u7684 3 \u500D\u3002</li><li>\u4E3B\u5206\u7247\uFF0C\u526F\u672C\u548C\u8282\u70B9\u6700\u5927\u6570\u4E4B\u95F4\u6570\u91CF\uFF0C\u6211\u4EEC\u5206\u914D\u7684\u65F6\u5019\u53EF\u4EE5\u53C2\u8003\u4EE5\u4E0B\u5173\u7CFB\uFF1A<br> \u8282\u70B9\u6570&lt;=\u4E3B\u5206\u7247\u6570 *\uFF08\u526F\u672C\u6570+1\uFF09</li></ul><h4 id="\u63A8\u8FDF\u5206\u7247\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#\u63A8\u8FDF\u5206\u7247\u5206\u914D" aria-hidden="true">#</a> \u63A8\u8FDF\u5206\u7247\u5206\u914D</h4><p>\u5BF9\u4E8E\u8282\u70B9\u77AC\u65F6\u4E2D\u65AD\u7684\u95EE\u9898\uFF0C\u9ED8\u8BA4\u60C5\u51B5\uFF0C\u96C6\u7FA4\u4F1A\u7B49\u5F85\u4E00\u5206\u949F\u6765\u67E5\u770B\u8282\u70B9\u662F\u5426\u4F1A\u91CD\u65B0\u52A0\u5165\uFF0C\u5982\u679C\u8FD9\u4E2A\u8282\u70B9\u5728\u6B64\u671F\u95F4\u91CD\u65B0\u52A0\u5165\uFF0C\u91CD\u65B0\u52A0\u5165\u7684\u8282\u70B9\u4F1A\u4FDD\u6301\u5176\u73B0\u6709\u7684\u5206\u7247\u6570\u636E\uFF0C\u4E0D\u4F1A\u89E6\u53D1\u65B0\u7684\u5206\u7247\u5206\u914D\u3002\u8FD9\u6837\u5C31\u53EF\u4EE5\u51CF\u5C11 ES \u5728\u81EA\u52A8\u518D\u5E73\u8861\u53EF\u7528\u5206\u7247\u65F6\u6240\u5E26\u6765\u7684\u6781\u5927\u5F00\u9500\u3002</p><p>\u901A\u8FC7\u4FEE\u6539\u53C2\u6570 delayed_timeout \uFF0C\u53EF\u4EE5\u5EF6\u957F\u518D\u5747\u8861\u7684\u65F6\u95F4\uFF0C\u53EF\u4EE5\u5168\u5C40\u8BBE\u7F6E\u4E5F\u53EF\u4EE5\u5728\u7D22\u5F15\u7EA7\u522B\u8FDB\u884C\u4FEE\u6539\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#PUT /_all/_settings
<span class="token punctuation">{</span>
	<span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;index.unassigned.node_left.delayed_timeout&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5m&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_58-\u4F18\u5316-\u8DEF\u7531\u9009\u62E9" tabindex="-1"><a class="header-anchor" href="#_58-\u4F18\u5316-\u8DEF\u7531\u9009\u62E9" aria-hidden="true">#</a> 58-\u4F18\u5316-\u8DEF\u7531\u9009\u62E9</h3><p>\u5F53\u6211\u4EEC\u67E5\u8BE2\u6587\u6863\u7684\u65F6\u5019\uFF0C Elasticsearch \u5982\u4F55\u77E5\u9053\u4E00\u4E2A\u6587\u6863\u5E94\u8BE5\u5B58\u653E\u5230\u54EA\u4E2A\u5206\u7247\u4E2D\u5462\uFF1F\u5B83\u5176\u5B9E\u662F\u901A\u8FC7\u4E0B\u9762\u8FD9\u4E2A\u516C\u5F0F\u6765\u8BA1\u7B97\u51FA\u6765\uFF1A</p><pre><code>shard = hash(routing) % number_of_primary_shards
</code></pre><p>routing \u9ED8\u8BA4\u503C\u662F\u6587\u6863\u7684 id\uFF0C\u4E5F\u53EF\u4EE5\u91C7\u7528\u81EA\u5B9A\u4E49\u503C\uFF0C\u6BD4\u5982\u7528\u6237 id\u3002</p><h4 id="\u4E0D\u5E26routing\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u4E0D\u5E26routing\u67E5\u8BE2" aria-hidden="true">#</a> \u4E0D\u5E26routing\u67E5\u8BE2</h4><p>\u5728\u67E5\u8BE2\u7684\u65F6\u5019\u56E0\u4E3A\u4E0D\u77E5\u9053\u8981\u67E5\u8BE2\u7684\u6570\u636E\u5177\u4F53\u5728\u54EA\u4E2A\u5206\u7247\u4E0A\uFF0C\u6240\u4EE5\u6574\u4E2A\u8FC7\u7A0B\u5206\u4E3A2\u4E2A\u6B65\u9AA4</p><ul><li>\u5206\u53D1\uFF1A\u8BF7\u6C42\u5230\u8FBE\u534F\u8C03\u8282\u70B9\u540E\uFF0C\u534F\u8C03\u8282\u70B9\u5C06\u67E5\u8BE2\u8BF7\u6C42\u5206\u53D1\u5230\u6BCF\u4E2A\u5206\u7247\u4E0A\u3002</li><li>\u805A\u5408\uFF1A\u534F\u8C03\u8282\u70B9\u641C\u96C6\u5230\u6BCF\u4E2A\u5206\u7247\u4E0A\u67E5\u8BE2\u7ED3\u679C\uFF0C\u5728\u5C06\u67E5\u8BE2\u7684\u7ED3\u679C\u8FDB\u884C\u6392\u5E8F\uFF0C\u4E4B\u540E\u7ED9\u7528\u6237\u8FD4\u56DE\u7ED3\u679C\u3002</li></ul><h4 id="\u5E26routing\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#\u5E26routing\u67E5\u8BE2" aria-hidden="true">#</a> \u5E26routing\u67E5\u8BE2</h4><p>\u67E5\u8BE2\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u76F4\u63A5\u6839\u636Erouting \u4FE1\u606F\u5B9A\u4F4D\u5230\u67D0\u4E2A\u5206\u914D\u67E5\u8BE2\uFF0C\u4E0D\u9700\u8981\u67E5\u8BE2\u6240\u6709\u7684\u5206\u914D\uFF0C\u7ECF\u8FC7\u534F\u8C03\u8282\u70B9\u6392\u5E8F\u3002\u5411\u4E0A\u9762\u81EA\u5B9A\u4E49\u7684\u7528\u6237\u67E5\u8BE2\uFF0C\u5982\u679Crouting \u8BBE\u7F6E\u4E3Auserid \u7684\u8BDD\uFF0C\u5C31\u53EF\u4EE5\u76F4\u63A5\u67E5\u8BE2\u51FA\u6570\u636E\u6765\uFF0C\u6548\u7387\u63D0\u5347\u5F88\u591A\u3002</p><h3 id="_59-\u4F18\u5316-\u5199\u5165\u901F\u5EA6\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#_59-\u4F18\u5316-\u5199\u5165\u901F\u5EA6\u4F18\u5316" aria-hidden="true">#</a> 59-\u4F18\u5316-\u5199\u5165\u901F\u5EA6\u4F18\u5316</h3><p>ES \u7684\u9ED8\u8BA4\u914D\u7F6E\uFF0C\u662F\u7EFC\u5408\u4E86\u6570\u636E\u53EF\u9760\u6027\u3001\u5199\u5165\u901F\u5EA6\u3001\u641C\u7D22\u5B9E\u65F6\u6027\u7B49\u56E0\u7D20\u3002\u5B9E\u9645\u4F7F\u7528\u65F6\uFF0C\u6211\u4EEC\u9700\u8981\u6839\u636E\u516C\u53F8\u8981\u6C42\uFF0C\u8FDB\u884C\u504F\u5411\u6027\u7684\u4F18\u5316\u3002</p><p>\u9488\u5BF9\u4E8E\u641C\u7D22\u6027\u80FD\u8981\u6C42\u4E0D\u9AD8\uFF0C\u4F46\u662F\u5BF9\u5199\u5165\u8981\u6C42\u8F83\u9AD8\u7684\u573A\u666F\uFF0C\u6211\u4EEC\u9700\u8981\u5C3D\u53EF\u80FD\u7684\u9009\u62E9\u6070\u5F53\u5199\u4F18\u5316\u7B56\u7565\u3002\u7EFC\u5408\u6765\u8BF4\uFF0C\u53EF\u4EE5\u8003\u8651\u4EE5\u4E0B\u51E0\u4E2A\u65B9\u9762\u6765\u63D0\u5347\u5199\u7D22\u5F15\u7684\u6027\u80FD\uFF1A</p><ul><li>\u52A0\u5927Translog Flush\uFF0C\u76EE\u7684\u662F\u964D\u4F4EIops\u3001Writeblock\u3002</li><li>\u589E\u52A0Index Refesh\u95F4\u9694\uFF0C\u76EE\u7684\u662F\u51CF\u5C11Segment Merge\u7684\u6B21\u6570\u3002</li><li>\u8C03\u6574Bulk \u7EBF\u7A0B\u6C60\u548C\u961F\u5217\u3002</li><li>\u4F18\u5316\u8282\u70B9\u95F4\u7684\u4EFB\u52A1\u5206\u5E03\u3002</li><li>\u4F18\u5316Lucene\u5C42\u7684\u7D22\u5F15\u5EFA\u7ACB\uFF0C\u76EE\u7684\u662F\u964D\u4F4ECPU\u53CAIO\u3002</li></ul><h4 id="\u4F18\u5316\u5B58\u50A8\u8BBE\u5907" tabindex="-1"><a class="header-anchor" href="#\u4F18\u5316\u5B58\u50A8\u8BBE\u5907" aria-hidden="true">#</a> \u4F18\u5316\u5B58\u50A8\u8BBE\u5907</h4><p>ES \u662F\u4E00\u79CD\u5BC6\u96C6\u4F7F\u7528\u78C1\u76D8\u7684\u5E94\u7528\uFF0C\u5728\u6BB5\u5408\u5E76\u7684\u65F6\u5019\u4F1A\u9891\u7E41\u64CD\u4F5C\u78C1\u76D8\uFF0C\u6240\u4EE5\u5BF9\u78C1\u76D8\u8981\u6C42\u8F83\u9AD8\uFF0C\u5F53\u78C1\u76D8\u901F\u5EA6\u63D0\u5347\u4E4B\u540E\uFF0C\u96C6\u7FA4\u7684\u6574\u4F53\u6027\u80FD\u4F1A\u5927\u5E45\u5EA6\u63D0\u9AD8\u3002</p><h4 id="\u5408\u7406\u4F7F\u7528\u5408\u5E76" tabindex="-1"><a class="header-anchor" href="#\u5408\u7406\u4F7F\u7528\u5408\u5E76" aria-hidden="true">#</a> \u5408\u7406\u4F7F\u7528\u5408\u5E76</h4><p>Lucene \u4EE5\u6BB5\u7684\u5F62\u5F0F\u5B58\u50A8\u6570\u636E\u3002\u5F53\u6709\u65B0\u7684\u6570\u636E\u5199\u5165\u7D22\u5F15\u65F6\uFF0C Lucene \u5C31\u4F1A\u81EA\u52A8\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6BB5\u3002</p><p>\u968F\u7740\u6570\u636E\u91CF\u7684\u53D8\u5316\uFF0C\u6BB5\u7684\u6570\u91CF\u4F1A\u8D8A\u6765\u8D8A\u591A\uFF0C\u6D88\u8017\u7684\u591A\u6587\u4EF6\u53E5\u67C4\u6570\u53CA CPU \u5C31\u8D8A\u591A\uFF0C\u67E5\u8BE2\u6548\u7387\u5C31\u4F1A\u4E0B\u964D\u3002</p><p>\u7531\u4E8E Lucene \u6BB5\u5408\u5E76\u7684\u8BA1\u7B97\u91CF\u5E9E\u5927\uFF0C\u4F1A\u6D88\u8017\u5927\u91CF\u7684 I/O\uFF0C\u6240\u4EE5 ES \u9ED8\u8BA4\u91C7\u7528\u8F83\u4FDD\u5B88\u7684\u7B56\u7565\uFF0C\u8BA9\u540E\u53F0\u5B9A\u671F\u8FDB\u884C\u6BB5\u5408\u5E76\u3002</p><h4 id="\u51CF\u5C11-refresh-\u7684\u6B21\u6570" tabindex="-1"><a class="header-anchor" href="#\u51CF\u5C11-refresh-\u7684\u6B21\u6570" aria-hidden="true">#</a> \u51CF\u5C11 Refresh \u7684\u6B21\u6570</h4><p>Lucene \u5728\u65B0\u589E\u6570\u636E\u65F6\uFF0C\u91C7\u7528\u4E86\u5EF6\u8FDF\u5199\u5165\u7684\u7B56\u7565\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u7D22\u5F15\u7684refresh_interval \u4E3A1 \u79D2\u3002</p><p>Lucene \u5C06\u5F85\u5199\u5165\u7684\u6570\u636E\u5148\u5199\u5230\u5185\u5B58\u4E2D\uFF0C\u8D85\u8FC7 1 \u79D2\uFF08\u9ED8\u8BA4\uFF09\u65F6\u5C31\u4F1A\u89E6\u53D1\u4E00\u6B21 Refresh\uFF0C\u7136\u540E Refresh \u4F1A\u628A\u5185\u5B58\u4E2D\u7684\u7684\u6570\u636E\u5237\u65B0\u5230\u64CD\u4F5C\u7CFB\u7EDF\u7684\u6587\u4EF6\u7F13\u5B58\u7CFB\u7EDF\u4E2D\u3002</p><p>\u5982\u679C\u6211\u4EEC\u5BF9\u641C\u7D22\u7684\u5B9E\u6548\u6027\u8981\u6C42\u4E0D\u9AD8\uFF0C\u53EF\u4EE5\u5C06 Refresh \u5468\u671F\u5EF6\u957F\uFF0C\u4F8B\u5982 30 \u79D2\u3002</p><p>\u8FD9\u6837\u8FD8\u53EF\u4EE5\u6709\u6548\u5730\u51CF\u5C11\u6BB5\u5237\u65B0\u6B21\u6570\uFF0C\u4F46\u8FD9\u540C\u65F6\u610F\u5473\u7740\u9700\u8981\u6D88\u8017\u66F4\u591A\u7684 Heap \u5185\u5B58\u3002</p><h4 id="\u52A0\u5927-flush-\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u52A0\u5927-flush-\u8BBE\u7F6E" aria-hidden="true">#</a> \u52A0\u5927 Flush \u8BBE\u7F6E</h4><p>Flush \u7684\u4E3B\u8981\u76EE\u7684\u662F\u628A\u6587\u4EF6\u7F13\u5B58\u7CFB\u7EDF\u4E2D\u7684\u6BB5\u6301\u4E45\u5316\u5230\u786C\u76D8\uFF0C\u5F53 Translog \u7684\u6570\u636E\u91CF\u8FBE\u5230 512MB \u6216\u8005 30 \u5206\u949F\u65F6\uFF0C\u4F1A\u89E6\u53D1\u4E00\u6B21 Flush\u3002</p><p>index.translog.flush_threshold_size \u53C2\u6570\u7684\u9ED8\u8BA4\u503C\u662F 512MB\uFF0C\u6211\u4EEC\u8FDB\u884C\u4FEE\u6539\u3002</p><p>\u589E\u52A0\u53C2\u6570\u503C\u610F\u5473\u7740\u6587\u4EF6\u7F13\u5B58\u7CFB\u7EDF\u4E2D\u53EF\u80FD\u9700\u8981\u5B58\u50A8\u66F4\u591A\u7684\u6570\u636E\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u4E3A\u64CD\u4F5C\u7CFB\u7EDF\u7684\u6587\u4EF6\u7F13\u5B58\u7CFB\u7EDF\u7559\u4E0B\u8DB3\u591F\u7684\u7A7A\u95F4\u3002</p><h4 id="\u51CF\u5C11\u526F\u672C\u7684\u6570\u91CF" tabindex="-1"><a class="header-anchor" href="#\u51CF\u5C11\u526F\u672C\u7684\u6570\u91CF" aria-hidden="true">#</a> \u51CF\u5C11\u526F\u672C\u7684\u6570\u91CF</h4><p>ES \u4E3A\u4E86\u4FDD\u8BC1\u96C6\u7FA4\u7684\u53EF\u7528\u6027\uFF0C\u63D0\u4F9B\u4E86 Replicas\uFF08\u526F\u672C\uFF09\u652F\u6301\uFF0C\u7136\u800C\u6BCF\u4E2A\u526F\u672C\u4E5F\u4F1A\u6267\u884C\u5206\u6790\u3001\u7D22\u5F15\u53CA\u53EF\u80FD\u7684\u5408\u5E76\u8FC7\u7A0B\uFF0C\u6240\u4EE5 Replicas \u7684\u6570\u91CF\u4F1A\u4E25\u91CD\u5F71\u54CD\u5199\u7D22\u5F15\u7684\u6548\u7387\u3002</p><p>\u5F53\u5199\u7D22\u5F15\u65F6\uFF0C\u9700\u8981\u628A\u5199\u5165\u7684\u6570\u636E\u90FD\u540C\u6B65\u5230\u526F\u672C\u8282\u70B9\uFF0C\u526F\u672C\u8282\u70B9\u8D8A\u591A\uFF0C\u5199\u7D22\u5F15\u7684\u6548\u7387\u5C31\u8D8A\u6162\u3002</p><p>\u5982\u679C\u6211\u4EEC\u9700\u8981\u5927\u6279\u91CF\u8FDB\u884C\u5199\u5165\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u5148\u7981\u6B62Replica\u590D\u5236\uFF0C\u8BBE\u7F6E<br> index.number_of_replicas: 0 \u5173\u95ED\u526F\u672C\u3002\u5728\u5199\u5165\u5B8C\u6210\u540E\uFF0C Replica \u4FEE\u6539\u56DE\u6B63\u5E38\u7684\u72B6\u6001\u3002</p><h3 id="_60-\u4F18\u5316-\u5185\u5B58\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#_60-\u4F18\u5316-\u5185\u5B58\u8BBE\u7F6E" aria-hidden="true">#</a> 60-\u4F18\u5316-\u5185\u5B58\u8BBE\u7F6E</h3><p>ES \u9ED8\u8BA4\u5B89\u88C5\u540E\u8BBE\u7F6E\u7684\u5185\u5B58\u662F 1GB\uFF0C\u5BF9\u4E8E\u4EFB\u4F55\u4E00\u4E2A\u73B0\u5B9E\u4E1A\u52A1\u6765\u8BF4\uFF0C\u8FD9\u4E2A\u8BBE\u7F6E\u90FD\u592A\u5C0F\u4E86\u3002\u5982\u679C\u662F\u901A\u8FC7\u89E3\u538B\u5B89\u88C5\u7684 ES\uFF0C\u5219\u5728 ES \u5B89\u88C5\u6587\u4EF6\u4E2D\u5305\u542B\u4E00\u4E2A jvm.option \u6587\u4EF6\uFF0C\u6DFB\u52A0\u5982\u4E0B\u547D\u4EE4\u6765\u8BBE\u7F6E ES \u7684\u5806\u5927\u5C0F\uFF0C Xms \u8868\u793A\u5806\u7684\u521D\u59CB\u5927\u5C0F\uFF0C Xmx \u8868\u793A\u53EF\u5206\u914D\u7684\u6700\u5927\u5185\u5B58\uFF0C\u90FD\u662F 1GB\u3002</p><p>\u786E\u4FDD Xmx \u548C Xms \u7684\u5927\u5C0F\u662F\u76F8\u540C\u7684\uFF0C\u5176\u76EE\u7684\u662F\u4E3A\u4E86\u80FD\u591F\u5728 Java \u5783\u573E\u56DE\u6536\u673A\u5236\u6E05\u7406\u5B8C\u5806\u533A\u540E\u4E0D\u9700\u8981\u91CD\u65B0\u5206\u9694\u8BA1\u7B97\u5806\u533A\u7684\u5927\u5C0F\u800C\u6D6A\u8D39\u8D44\u6E90\uFF0C\u53EF\u4EE5\u51CF\u8F7B\u4F38\u7F29\u5806\u5927\u5C0F\u5E26\u6765\u7684\u538B\u529B\u3002</p><p>\u5047\u8BBE\u4F60\u6709\u4E00\u4E2A 64G \u5185\u5B58\u7684\u673A\u5668\uFF0C\u6309\u7167\u6B63\u5E38\u601D\u7EF4\u601D\u8003\uFF0C\u4F60\u53EF\u80FD\u4F1A\u8BA4\u4E3A\u628A 64G \u5185\u5B58\u90FD\u7ED9ES \u6BD4\u8F83\u597D\uFF0C\u4F46\u73B0\u5B9E\u662F\u8FD9\u6837\u5417\uFF0C \u8D8A\u5927\u8D8A\u597D\uFF1F\u867D\u7136\u5185\u5B58\u5BF9 ES \u6765\u8BF4\u662F\u975E\u5E38\u91CD\u8981\u7684\uFF0C\u4F46\u662F\u7B54\u6848\u662F\u5426\u5B9A\u7684\uFF01</p><p>\u56E0\u4E3A ES \u5806\u5185\u5B58\u7684\u5206\u914D\u9700\u8981\u6EE1\u8DB3\u4EE5\u4E0B\u4E24\u4E2A\u539F\u5219\uFF1A</p><ul><li><p>\u4E0D\u8981\u8D85\u8FC7\u7269\u7406\u5185\u5B58\u7684 50%\uFF1A Lucene \u7684\u8BBE\u8BA1\u76EE\u7684\u662F\u628A\u5E95\u5C42 OS \u91CC\u7684\u6570\u636E\u7F13\u5B58\u5230\u5185\u5B58\u4E2D\u3002Lucene \u7684\u6BB5\u662F\u5206\u522B\u5B58\u50A8\u5230\u5355\u4E2A\u6587\u4EF6\u4E2D\u7684\uFF0C\u8FD9\u4E9B\u6587\u4EF6\u90FD\u662F\u4E0D\u4F1A\u53D8\u5316\u7684\uFF0C\u6240\u4EE5\u5F88\u5229\u4E8E\u7F13\u5B58\uFF0C\u540C\u65F6\u64CD\u4F5C\u7CFB\u7EDF\u4E5F\u4F1A\u628A\u8FD9\u4E9B\u6BB5\u6587\u4EF6\u7F13\u5B58\u8D77\u6765\uFF0C\u4EE5\u4FBF\u66F4\u5FEB\u7684\u8BBF\u95EE\u3002\u5982\u679C\u6211\u4EEC\u8BBE\u7F6E\u7684\u5806\u5185\u5B58\u8FC7\u5927\uFF0C Lucene \u53EF\u7528\u7684\u5185\u5B58\u5C06\u4F1A\u51CF\u5C11\uFF0C\u5C31\u4F1A\u4E25\u91CD\u5F71\u54CD\u964D\u4F4E Lucene \u7684\u5168\u6587\u672C\u67E5\u8BE2\u6027\u80FD\u3002</p></li><li><p>\u5806\u5185\u5B58\u7684\u5927\u5C0F\u6700\u597D\u4E0D\u8981\u8D85\u8FC7 32GB\uFF1A\u5728 Java \u4E2D\uFF0C\u6240\u6709\u5BF9\u8C61\u90FD\u5206\u914D\u5728\u5806\u4E0A\uFF0C\u7136\u540E\u6709\u4E00\u4E2A Klass Pointer \u6307\u9488\u6307\u5411\u5B83\u7684\u7C7B\u5143\u6570\u636E\u3002\u8FD9\u4E2A\u6307\u9488\u5728 64 \u4F4D\u7684\u64CD\u4F5C\u7CFB\u7EDF\u4E0A\u4E3A 64 \u4F4D\uFF0C 64 \u4F4D\u7684\u64CD\u4F5C\u7CFB\u7EDF\u53EF\u4EE5\u4F7F\u7528\u66F4\u591A\u7684\u5185\u5B58\uFF082^64\uFF09\u3002\u5728 32 \u4F4D<br> \u7684\u7CFB\u7EDF\u4E0A\u4E3A 32 \u4F4D\uFF0C 32 \u4F4D\u7684\u64CD\u4F5C\u7CFB\u7EDF\u7684\u6700\u5927\u5BFB\u5740\u7A7A\u95F4\u4E3A 4GB\uFF082^32\uFF09\u3002<br> \u4F46\u662F 64 \u4F4D\u7684\u6307\u9488\u610F\u5473\u7740\u66F4\u5927\u7684\u6D6A\u8D39\uFF0C\u56E0\u4E3A\u4F60\u7684\u6307\u9488\u672C\u8EAB\u5927\u4E86\u3002\u6D6A\u8D39\u5185\u5B58\u4E0D\u7B97\uFF0C\u66F4\u7CDF\u7CD5\u7684\u662F\uFF0C\u66F4\u5927\u7684\u6307\u9488\u5728\u4E3B\u5185\u5B58\u548C\u7F13\u5B58\u5668\uFF08\u4F8B\u5982 LLC, L1 \u7B49\uFF09\u4E4B\u95F4\u79FB\u52A8\u6570\u636E\u7684\u65F6\u5019\uFF0C\u4F1A\u5360\u7528\u66F4\u591A\u7684\u5E26\u5BBD\u3002</p></li></ul><p>\u6700\u7EC8\u6211\u4EEC\u90FD\u4F1A\u91C7\u7528 31 G \u8BBE\u7F6E</p><ul><li>-Xms 31g</li><li>-Xmx 31g</li></ul><p>\u5047\u8BBE\u4F60\u6709\u4E2A\u673A\u5668\u6709 128 GB \u7684\u5185\u5B58\uFF0C\u4F60\u53EF\u4EE5\u521B\u5EFA\u4E24\u4E2A\u8282\u70B9\uFF0C\u6BCF\u4E2A\u8282\u70B9\u5185\u5B58\u5206\u914D\u4E0D\u8D85\u8FC7 32 GB\u3002\u4E5F\u5C31\u662F\u8BF4\u4E0D\u8D85\u8FC7 64 GB \u5185\u5B58\u7ED9 ES \u7684\u5806\u5185\u5B58\uFF0C\u5269\u4E0B\u7684\u8D85\u8FC7 64 GB \u7684\u5185\u5B58\u7ED9 Lucene\u3002</p><h3 id="_61-\u4F18\u5316-\u91CD\u8981\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_61-\u4F18\u5316-\u91CD\u8981\u914D\u7F6E" aria-hidden="true">#</a> 61-\u4F18\u5316-\u91CD\u8981\u914D\u7F6E</h3><table><thead><tr><th style="text-align:center;">\u53C2\u6570\u540D</th><th style="text-align:center;">\u53C2\u6570\u503C</th><th style="text-align:center;">\u8BF4\u660E</th></tr></thead><tbody><tr><td style="text-align:center;">cluster.name</td><td style="text-align:center;">elasticsearch</td><td style="text-align:center;">\u914D\u7F6E ES \u7684\u96C6\u7FA4\u540D\u79F0\uFF0C\u9ED8\u8BA4\u503C\u662F ES\uFF0C\u5EFA\u8BAE\u6539\u6210\u4E0E\u6240\u5B58\u6570\u636E\u76F8\u5173\u7684\u540D\u79F0\uFF0C ES \u4F1A\u81EA\u52A8\u53D1\u73B0\u5728\u540C\u4E00\u7F51\u6BB5\u4E0B\u7684\u96C6\u7FA4\u540D\u79F0\u76F8\u540C\u7684\u8282\u70B9\u3002</td></tr><tr><td style="text-align:center;">node.name</td><td style="text-align:center;">node-1</td><td style="text-align:center;">\u96C6\u7FA4\u4E2D\u7684\u8282\u70B9\u540D\uFF0C\u5728\u540C\u4E00\u4E2A\u96C6\u7FA4\u4E2D\u4E0D\u80FD\u91CD\u590D\u3002\u8282\u70B9\u7684\u540D\u79F0\u4E00\u65E6\u8BBE\u7F6E\uFF0C\u5C31\u4E0D\u80FD\u518D\u6539\u53D8\u4E86\u3002\u5F53\u7136\uFF0C\u4E5F\u53EF\u4EE5\u8BBE\u7F6E\u6210\u670D\u52A1\u5668\u7684\u4E3B\u673A\u540D\u79F0\uFF0C\u4F8B\u5982 node.name:\${HOSTNAME}\u3002</td></tr><tr><td style="text-align:center;">node.master</td><td style="text-align:center;">true</td><td style="text-align:center;">\u6307\u5B9A\u8BE5\u8282\u70B9\u662F\u5426\u6709\u8D44\u683C\u88AB\u9009\u4E3E\u6210\u4E3A Master \u8282\u70B9\uFF0C\u9ED8\u8BA4\u662F True\uFF0C\u5982\u679C\u88AB\u8BBE\u7F6E\u4E3A True\uFF0C\u5219\u53EA\u662F\u6709\u8D44\u683C\u6210\u4E3A Master \u8282\u70B9\uFF0C\u5177\u4F53\u80FD\u5426\u6210\u4E3A Master \u8282\u70B9\uFF0C\u9700\u8981\u901A\u8FC7\u9009\u4E3E\u4EA7\u751F\u3002</td></tr><tr><td style="text-align:center;">node.data</td><td style="text-align:center;">true</td><td style="text-align:center;">\u6307\u5B9A\u8BE5\u8282\u70B9\u662F\u5426\u5B58\u50A8\u7D22\u5F15\u6570\u636E\uFF0C\u9ED8\u8BA4\u4E3A True\u3002\u6570\u636E\u7684\u589E\u3001\u5220\u3001\u6539\u3001\u67E5\u90FD\u662F\u5728 Data \u8282\u70B9\u5B8C\u6210\u7684\u3002</td></tr><tr><td style="text-align:center;">index.number_of_shards</td><td style="text-align:center;">1</td><td style="text-align:center;">\u8BBE\u7F6E\u90FD\u7D22\u5F15\u5206\u7247\u4E2A\u6570\uFF0C\u9ED8\u8BA4\u662F 1 \u7247\u3002\u4E5F\u53EF\u4EE5\u5728\u521B\u5EFA\u7D22\u5F15\u65F6\u8BBE\u7F6E\u8BE5\u503C\uFF0C\u5177\u4F53\u8BBE\u7F6E\u4E3A\u591A\u5927\u90FD\u503C\u8981\u6839\u636E\u6570\u636E\u91CF\u7684\u5927\u5C0F\u6765\u5B9A\u3002\u5982\u679C\u6570\u636E\u91CF\u4E0D\u5927\uFF0C\u5219\u8BBE\u7F6E\u6210 1 \u65F6\u6548\u7387\u6700\u9AD8</td></tr><tr><td style="text-align:center;">index.number_of_replicas</td><td style="text-align:center;">1</td><td style="text-align:center;">\u8BBE\u7F6E\u9ED8\u8BA4\u7684\u7D22\u5F15\u526F\u672C\u4E2A\u6570\uFF0C\u9ED8\u8BA4\u4E3A 1 \u4E2A\u3002\u526F\u672C\u6570\u8D8A\u591A\uFF0C\u96C6\u7FA4\u7684\u53EF\u7528\u6027\u8D8A\u597D\uFF0C\u4F46\u662F\u5199\u7D22\u5F15\u65F6\u9700\u8981\u540C\u6B65\u7684\u6570\u636E\u8D8A\u591A\u3002</td></tr><tr><td style="text-align:center;">transport.tcp.compress</td><td style="text-align:center;">true</td><td style="text-align:center;">\u8BBE\u7F6E\u5728\u8282\u70B9\u95F4\u4F20\u8F93\u6570\u636E\u65F6\u662F\u5426\u538B\u7F29\uFF0C\u9ED8\u8BA4\u4E3A False\uFF0C \u4E0D\u538B\u7F29</td></tr><tr><td style="text-align:center;">discovery.zen.minimum_master_nodes</td><td style="text-align:center;">1</td><td style="text-align:center;">\u8BBE\u7F6E\u5728\u9009\u4E3E Master \u8282\u70B9\u65F6\u9700\u8981\u53C2\u4E0E\u7684\u6700\u5C11\u7684\u5019\u9009\u4E3B\u8282\u70B9\u6570\uFF0C\u9ED8\u8BA4\u4E3A 1\u3002\u5982\u679C\u4F7F\u7528\u9ED8\u8BA4\u503C\uFF0C\u5219\u5F53\u7F51\u7EDC\u4E0D\u7A33\u5B9A\u65F6\u6709\u53EF\u80FD\u4F1A\u51FA\u73B0\u8111\u88C2\u3002\u5408\u7406\u7684\u6570\u503C\u4E3A(master_eligible_nodes/2)+1 \uFF0C \u5176 \u4E2D master_eligible_nodes \u8868\u793A\u96C6\u7FA4\u4E2D\u7684\u5019\u9009\u4E3B\u8282\u70B9\u6570</td></tr><tr><td style="text-align:center;">discovery.zen.ping.timeout</td><td style="text-align:center;">3s</td><td style="text-align:center;">\u8BBE\u7F6E\u5728\u96C6\u7FA4\u4E2D\u81EA\u52A8\u53D1\u73B0\u5176\u4ED6\u8282\u70B9\u65F6 Ping \u8FDE\u63A5\u7684\u8D85 \u65F6\u65F6\u95F4\uFF0C\u9ED8\u8BA4\u4E3A 3 \u79D2\u3002\u5728\u8F83\u5DEE\u7684\u7F51\u7EDC\u73AF\u5883\u4E0B\u9700\u8981\u8BBE\u7F6E\u5F97\u5927\u4E00\u70B9\uFF0C\u9632\u6B62\u56E0\u8BEF\u5224\u8BE5\u8282\u70B9\u7684\u5B58\u6D3B\u72B6\u6001\u800C\u5BFC\u81F4\u5206\u7247\u7684\u8F6C\u79FB</td></tr></tbody></table><h2 id="\u7B2C7\u7AE0-elasticsearch\u9762\u8BD5\u9898" tabindex="-1"><a class="header-anchor" href="#\u7B2C7\u7AE0-elasticsearch\u9762\u8BD5\u9898" aria-hidden="true">#</a> \u7B2C7\u7AE0 Elasticsearch\u9762\u8BD5\u9898</h2><h3 id="_62-\u9762\u8BD5\u9898" tabindex="-1"><a class="header-anchor" href="#_62-\u9762\u8BD5\u9898" aria-hidden="true">#</a> 62-\u9762\u8BD5\u9898</h3><h4 id="\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528-elasticsearch" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528-elasticsearch" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528 Elasticsearch\uFF1F</h4><p>\u7CFB\u7EDF\u4E2D\u7684\u6570\u636E\uFF0C \u968F\u7740\u4E1A\u52A1\u7684\u53D1\u5C55\uFF0C\u65F6\u95F4\u7684\u63A8\u79FB\uFF0C \u5C06\u4F1A\u975E\u5E38\u591A\uFF0C \u800C\u4E1A\u52A1\u4E2D\u5F80\u5F80\u91C7\u7528\u6A21\u7CCA\u67E5\u8BE2\u8FDB\u884C\u6570\u636E\u7684\u641C\u7D22\uFF0C \u800C\u6A21\u7CCA\u67E5\u8BE2\u4F1A\u5BFC\u81F4\u67E5\u8BE2\u5F15\u64CE\u653E\u5F03\u7D22\u5F15\uFF0C\u5BFC\u81F4\u7CFB\u7EDF\u67E5\u8BE2\u6570\u636E\u65F6\u90FD\u662F\u5168\u8868\u626B\u63CF\uFF0C\u5728\u767E\u4E07\u7EA7\u522B\u7684\u6570\u636E\u5E93\u4E2D\uFF0C\u67E5\u8BE2\u6548\u7387\u662F\u975E\u5E38\u4F4E\u4E0B\u7684\uFF0C\u800C\u6211\u4EEC\u4F7F\u7528 ES \u505A\u4E00\u4E2A\u5168\u6587\u7D22\u5F15\uFF0C\u5C06\u7ECF\u5E38\u67E5\u8BE2\u7684\u7CFB\u7EDF\u529F\u80FD\u7684\u67D0\u4E9B\u5B57\u6BB5\uFF0C\u6BD4\u5982\u8BF4\u7535\u5546\u7CFB\u7EDF\u7684\u5546\u54C1\u8868\u4E2D\u5546\u54C1\u540D\uFF0C\u63CF\u8FF0\u3001\u4EF7\u683C\u8FD8\u6709 id \u8FD9\u4E9B\u5B57\u6BB5\u6211\u4EEC\u653E\u5165 ES \u7D22\u5F15\u5E93\u91CC\uFF0C\u53EF\u4EE5\u63D0\u9AD8\u67E5\u8BE2\u901F\u5EA6\u3002</p><h4 id="elasticsearch-\u7684-master-\u9009\u4E3E\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u7684-master-\u9009\u4E3E\u6D41\u7A0B" aria-hidden="true">#</a> Elasticsearch \u7684 master \u9009\u4E3E\u6D41\u7A0B\uFF1F</h4><ul><li>Elasticsearch\u7684\u9009\u4E3B\u662FZenDiscovery\u6A21\u5757\u8D1F\u8D23\u7684\uFF0C\u4E3B\u8981\u5305\u542BPing\uFF08\u8282\u70B9\u4E4B\u95F4\u901A\u8FC7\u8FD9\u4E2ARPC\u6765\u53D1\u73B0\u5F7C\u6B64\uFF09\u548CUnicast\uFF08\u5355\u64AD\u6A21\u5757\u5305\u542B-\u4E00\u4E2A\u4E3B\u673A\u5217\u8868\u4EE5\u63A7\u5236\u54EA\u4E9B\u8282\u70B9\u9700\u8981ping\u901A\uFF09\u8FD9\u4E24\u90E8\u5206\u3002</li><li>\u5BF9\u6240\u6709\u53EF\u4EE5\u6210\u4E3Amaster\u7684\u8282\u70B9\uFF08node master: true\uFF09\u6839\u636EnodeId\u5B57\u5178\u6392\u5E8F\uFF0C\u6BCF\u6B21\u9009\u4E3E\u6BCF\u4E2A\u8282\u70B9\u90FD\u628A\u81EA\u5DF1\u6240\u77E5\u9053\u8282\u70B9\u6392\u4E00\u6B21\u5E8F\uFF0C\u7136\u540E\u9009\u51FA\u7B2C\u4E00\u4E2A\uFF08\u7B2C0\u4F4D\uFF09\u8282\u70B9\uFF0C\u6682\u4E14\u8BA4\u4E3A\u5B83\u662Fmaster\u8282\u70B9\u3002</li><li>\u5982\u679C\u5BF9\u67D0\u4E2A\u8282\u70B9\u7684\u6295\u7968\u6570\u8FBE\u5230\u4E00\u5B9A\u7684\u503C\uFF08\u53EF\u4EE5\u6210\u4E3Amaster\u8282\u70B9\u6570n/2+1\uFF09\u5E76\u4E14\u8BE5\u8282\u70B9\u81EA\u5DF1\u4E5F\u9009\u4E3E\u81EA\u5DF1\uFF0C\u90A3\u8FD9\u4E2A\u8282\u70B9\u5C31\u662F master\u3002\u5426\u5219\u91CD\u65B0\u9009\u4E3E\u4E00\u76F4\u5230\u6EE1\u8DB3\u4E0A\u8FF0\u6761\u4EF6\u3002</li><li>master\u8282\u70B9\u7684\u804C\u8D23\u4E3B\u8981\u5305\u62EC\u96C6\u7FA4\u3001\u8282\u70B9\u548C\u7D22\u5F15\u7684\u7BA1\u7406\uFF0C\u4E0D\u8D1F\u8D23\u6587\u6863\u7EA7\u522B\u7684\u7BA1\u7406\uFF1Bdata\u8282\u70B9\u53EF\u4EE5\u5173\u95ED http \u529F\u80FD\u3002</li></ul><h4 id="elasticsearch-\u96C6\u7FA4\u8111\u88C2\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u96C6\u7FA4\u8111\u88C2\u95EE\u9898" aria-hidden="true">#</a> Elasticsearch \u96C6\u7FA4\u8111\u88C2\u95EE\u9898\uFF1F</h4><p>\u201C\u8111\u88C2\u201D\u95EE\u9898\u53EF\u80FD\u7684\u6210\u56E0\uFF1A</p><ul><li>\u7F51\u7EDC\u95EE\u9898\uFF1A\u96C6\u7FA4\u95F4\u7684\u7F51\u7EDC\u5EF6\u8FDF\u5BFC\u81F4\u4E00\u4E9B\u8282\u70B9\u8BBF\u95EE\u4E0D\u5230master, \u8BA4\u4E3Amaster \u6302\u6389\u4E86\u4ECE\u800C\u9009\u4E3E\u51FA\u65B0\u7684master,\u5E76\u5BF9master\u4E0A\u7684\u5206\u7247\u548C\u526F\u672C\u6807\u7EA2\uFF0C\u5206\u914D\u65B0\u7684\u4E3B\u5206\u7247\u3002</li><li>\u8282\u70B9\u8D1F\u8F7D\uFF1A\u4E3B\u8282\u70B9\u7684\u89D2\u8272\u65E2\u4E3Amaster\u53C8\u4E3Adata,\u8BBF\u95EE\u91CF\u8F83\u5927\u65F6\u53EF\u80FD\u4F1A\u5BFC\u81F4ES\u505C\u6B62\u54CD\u5E94\u9020\u6210\u5927\u9762\u79EF\u5EF6\u8FDF\uFF0C\u6B64\u65F6\u5176\u4ED6\u8282\u70B9\u5F97\u4E0D\u5230\u4E3B\u8282\u70B9\u7684\u54CD\u5E94\u8BA4\u4E3A\u4E3B\u8282\u70B9\u6302\u6389\u4E86\uFF0C\u4F1A\u91CD\u65B0\u9009\u53D6\u4E3B\u8282\u70B9\u3002</li><li>\u5185\u5B58\u56DE\u6536\uFF1Adata \u8282\u70B9\u4E0A\u7684ES\u8FDB\u7A0B\u5360\u7528\u7684\u5185\u5B58\u8F83\u5927\uFF0C\u5F15\u53D1JVM\u7684\u5927\u89C4\u6A21\u5185\u5B58\u56DE\u6536\uFF0C\u9020\u6210ES\u8FDB\u7A0B\u5931\u53BB\u54CD\u5E94\u3002</li></ul><p>\u8111\u88C2\u95EE\u9898\u89E3\u51B3\u65B9\u6848\uFF1A</p><ul><li><p>\u51CF\u5C11\u8BEF\u5224\uFF1Adiscovery.zen ping_ timeout \u8282\u70B9\u72B6\u6001\u7684\u54CD\u5E94\u65F6\u95F4\uFF0C\u9ED8\u8BA4\u4E3A3s\uFF0C\u53EF\u4EE5\u9002\u5F53\u8C03\u5927\uFF0C\u5982\u679Cmaster\u5728\u8BE5\u54CD\u5E94\u65F6\u95F4\u7684\u8303\u56F4\u5185\u6CA1\u6709\u505A\u51FA\u54CD\u5E94\u5E94\u7B54\uFF0C\u5224\u65AD\u8BE5\u8282\u70B9\u5DF2\u7ECF\u6302\u6389\u4E86\u3002\u8C03\u5927\u53C2\u6570\uFF08\u59826s\uFF0Cdiscovery.zen.ping_timeout:6\uFF09\uFF0C\u53EF\u9002\u5F53\u51CF\u5C11\u8BEF\u5224\u3002</p></li><li><p>\u9009\u4E3E\u89E6\u53D1\uFF1Adiscovery.zen.minimum. _master_ nodes:1\uFF0C\u8BE5\u53C2\u6578\u662F\u7528\u4E8E\u63A7\u5236\u9009\u4E3E\u884C\u4E3A\u53D1\u751F\u7684\u6700\u5C0F\u96C6\u7FA4\u4E3B\u8282\u70B9\u6570\u91CF\u3002\u5F53\u5907\u9009\u4E3B\u8282\u70B9\u7684\u4E2A\u6578\u5927\u4E8E\u7B49\u4E8E\u8BE5\u53C2\u6570\u7684\u503C\uFF0C\u4E14\u5907\u9009\u4E3B\u8282\u70B9\u4E2D\u6709\u8BE5\u53C2\u6570\u4E2A\u8282\u70B9\u8BA4\u4E3A\u4E3B\u8282\u70B9\u6302\u4E86\uFF0C\u8FDB\u884C\u9009\u4E3E\u3002\u5B98\u65B9\u5EFA\u8BAE\u4E3A(n / 2) +1, n\u4E3A\u4E3B\u8282\u70B9\u4E2A\u6570\uFF08\u5373\u6709\u8D44\u683C\u6210\u4E3A\u4E3B\u8282\u70B9\u7684\u8282\u70B9\u4E2A\u6570\uFF09\u3002</p></li><li><p>\u89D2\u8272\u5206\u79BB\uFF1A\u5373master\u8282\u70B9\u4E0Edata\u8282\u70B9\u5206\u79BB\uFF0C\u9650\u5236\u89D2\u8272</p><ul><li>\u4E3B\u8282\u70B9\u914D\u7F6E\u4E3A\uFF1Anode master: true\uFF0Cnode data: false</li><li>\u4ECE\u8282\u70B9\u914D\u7F6E\u4E3A\uFF1Anode master: false\uFF0Cnode data: true</li></ul></li></ul><h4 id="elasticsearch-\u7D22\u5F15\u6587\u6863\u7684\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u7D22\u5F15\u6587\u6863\u7684\u6D41\u7A0B" aria-hidden="true">#</a> Elasticsearch \u7D22\u5F15\u6587\u6863\u7684\u6D41\u7A0B\uFF1F</h4><p><img src="https://qiniu.xinghe.fit/Elasticsearch/1bdc6c30d1be9b1bff83a683c64d2ac7.png" alt=""></p><ul><li>\u534F\u8C03\u8282\u70B9\u9ED8\u8BA4\u4F7F\u7528\u6587\u6863 ID \u53C2\u4E0E\u8BA1\u7B97\uFF08\u4E5F\u652F\u6301\u901A\u8FC7 routing\uFF09\uFF0C\u4EE5\u4FBF\u4E3A\u8DEF\u7531\u63D0\u4F9B\u5408\u9002\u7684\u5206\u7247\uFF1Ashard = hash(document_id) % (num_of_primary_shards)</li><li>\u5F53\u5206\u7247\u6240\u5728\u7684\u8282\u70B9\u63A5\u6536\u5230\u6765\u81EA\u534F\u8C03\u8282\u70B9\u7684\u8BF7\u6C42\u540E\uFF0C\u4F1A\u5C06\u8BF7\u6C42\u5199\u5165\u5230 Memory Buffer\uFF0C\u7136\u540E\u5B9A\u65F6\uFF08\u9ED8\u8BA4\u662F\u6BCF\u9694 1 \u79D2\uFF09\u5199\u5165\u5230 Filesystem Cache\uFF0C\u8FD9\u4E2A\u4ECE Memory Buffer \u5230 Filesystem Cache \u7684\u8FC7\u7A0B\u5C31\u53EB\u505A refresh\uFF1B</li><li>\u5F53\u7136\u5728\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u5B58\u5728 Momery Buffer \u548C Filesystem Cache \u7684\u6570\u636E\u53EF\u80FD\u4F1A\u4E22\u5931\uFF0C ES \u662F\u901A\u8FC7 translog\u7684\u673A\u5236\u6765\u4FDD\u8BC1\u6570\u636E\u7684\u53EF\u9760\u6027\u7684\u3002\u5176\u5B9E\u73B0\u673A\u5236\u662F\u63A5\u6536\u5230\u8BF7\u6C42\u540E\uFF0C\u540C\u65F6\u4E5F\u4F1A\u5199\u5165\u5230 translog \u4E2D\uFF0C\u5F53 Filesystemcache \u4E2D\u7684\u6570\u636E\u5199\u5165\u5230\u78C1\u76D8\u4E2D\u65F6\uFF0C\u624D\u4F1A\u6E05\u9664\u6389\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u53EB\u505A flush\uFF1B</li><li>\u5728 flush \u8FC7\u7A0B\u4E2D\uFF0C\u5185\u5B58\u4E2D\u7684\u7F13\u51B2\u5C06\u88AB\u6E05\u9664\uFF0C\u5185\u5BB9\u88AB\u5199\u5165\u4E00\u4E2A\u65B0\u6BB5\uFF0C\u6BB5\u7684 fsync \u5C06\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u63D0\u4EA4\u70B9\uFF0C\u5E76\u5C06\u5185\u5BB9\u5237\u65B0\u5230\u78C1\u76D8\uFF0C\u65E7\u7684 translog \u5C06\u88AB\u5220\u9664\u5E76\u5F00\u59CB\u4E00\u4E2A\u65B0\u7684 translog\u3002</li><li>flush \u89E6\u53D1\u7684\u65F6\u673A\u662F\u5B9A\u65F6\u89E6\u53D1\uFF08\u9ED8\u8BA4 30 \u5206\u949F\uFF09\u6216\u8005 translog \u53D8\u5F97\u592A\u5927\uFF08\u9ED8\u8BA4\u4E3A 512M\uFF09\u65F6\uFF1B</li></ul><h4 id="elasticsearch-\u66F4\u65B0\u548C\u5220\u9664\u6587\u6863\u7684\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u66F4\u65B0\u548C\u5220\u9664\u6587\u6863\u7684\u6D41\u7A0B" aria-hidden="true">#</a> Elasticsearch \u66F4\u65B0\u548C\u5220\u9664\u6587\u6863\u7684\u6D41\u7A0B\uFF1F</h4><ul><li>\u5220\u9664\u548C\u66F4\u65B0\u4E5F\u90FD\u662F\u5199\u64CD\u4F5C\uFF0C\u4F46\u662F Elasticsearch \u4E2D\u7684\u6587\u6863\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C\u56E0\u6B64\u4E0D\u80FD\u88AB\u5220\u9664\u6216\u8005\u6539\u52A8\u4EE5\u5C55\u793A\u5176\u53D8\u66F4\uFF1B</li><li>\u78C1\u76D8\u4E0A\u7684\u6BCF\u4E2A\u6BB5\u90FD\u6709\u4E00\u4E2A\u76F8\u5E94\u7684.del \u6587\u4EF6\u3002\u5F53\u5220\u9664\u8BF7\u6C42\u53D1\u9001\u540E\uFF0C\u6587\u6863\u5E76\u6CA1\u6709\u771F\u7684\u88AB\u5220\u9664\uFF0C\u800C\u662F\u5728.del\u6587\u4EF6\u4E2D\u88AB\u6807\u8BB0\u4E3A\u5220\u9664\u3002\u8BE5\u6587\u6863\u4F9D\u7136\u80FD\u5339\u914D\u67E5\u8BE2\uFF0C\u4F46\u662F\u4F1A\u5728\u7ED3\u679C\u4E2D\u88AB\u8FC7\u6EE4\u6389\u3002\u5F53\u6BB5\u5408\u5E76\u65F6\uFF0C\u5728.del \u6587\u4EF6\u4E2D\u88AB\u6807\u8BB0\u4E3A\u5220\u9664\u7684\u6587\u6863\u5C06\u4E0D\u4F1A\u88AB\u5199\u5165\u65B0\u6BB5\u3002</li><li>\u5728\u65B0\u7684\u6587\u6863\u88AB\u521B\u5EFA\u65F6\uFF0C Elasticsearch \u4F1A\u4E3A\u8BE5\u6587\u6863\u6307\u5B9A\u4E00\u4E2A\u7248\u672C\u53F7\uFF0C\u5F53\u6267\u884C\u66F4\u65B0\u65F6\uFF0C\u65E7\u7248\u672C\u7684\u6587\u6863\u5728.del\u6587\u4EF6\u4E2D\u88AB\u6807\u8BB0\u4E3A\u5220\u9664\uFF0C\u65B0\u7248\u672C\u7684\u6587\u6863\u88AB\u7D22\u5F15\u5230\u4E00\u4E2A\u65B0\u6BB5\u3002\u65E7\u7248\u672C\u7684\u6587\u6863\u4F9D\u7136\u80FD\u5339\u914D\u67E5\u8BE2\uFF0C\u4F46\u662F\u4F1A\u5728\u7ED3\u679C\u4E2D\u88AB\u8FC7\u6EE4\u6389\u3002</li></ul><h4 id="elasticsearch-\u641C\u7D22\u7684\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u641C\u7D22\u7684\u6D41\u7A0B" aria-hidden="true">#</a> Elasticsearch \u641C\u7D22\u7684\u6D41\u7A0B\uFF1F</h4><p><img src="https://qiniu.xinghe.fit/Elasticsearch/053a14eee04ace7b4e5aec0ce53a5284.png" alt=""></p><ul><li>\u641C\u7D22\u88AB\u6267\u884C\u6210\u4E00\u4E2A\u4E24\u9636\u6BB5\u8FC7\u7A0B\uFF0C\u6211\u4EEC\u79F0\u4E4B\u4E3A Query Then Fetch\uFF1B</li><li>\u5728\u521D\u59CB\u67E5\u8BE2\u9636\u6BB5\u65F6\uFF0C\u67E5\u8BE2\u4F1A\u5E7F\u64AD\u5230\u7D22\u5F15\u4E2D\u6BCF\u4E00\u4E2A\u5206\u7247\u62F7\u8D1D\uFF08\u4E3B\u5206\u7247\u6216\u8005\u526F\u672C\u5206\u7247\uFF09\u3002 \u6BCF\u4E2A\u5206\u7247\u5728\u672C\u5730\u6267\u884C\u641C\u7D22\u5E76\u6784\u5EFA\u4E00\u4E2A\u5339\u914D\u6587\u6863\u7684\u5927\u5C0F\u4E3A from + size \u7684\u4F18\u5148\u961F\u5217\u3002 PS\uFF1A\u5728\u641C\u7D22\u7684\u65F6\u5019\u662F\u4F1A\u67E5\u8BE2Filesystem Cache \u7684\uFF0C\u4F46\u662F\u6709\u90E8\u5206\u6570\u636E\u8FD8\u5728 Memory Buffer\uFF0C\u6240\u4EE5\u641C\u7D22\u662F\u8FD1\u5B9E\u65F6\u7684\u3002</li><li>\u6BCF\u4E2A\u5206\u7247\u8FD4\u56DE\u5404\u81EA\u4F18\u5148\u961F\u5217\u4E2D \u6240\u6709\u6587\u6863\u7684 ID \u548C\u6392\u5E8F\u503C \u7ED9\u534F\u8C03\u8282\u70B9\uFF0C\u5B83\u5408\u5E76\u8FD9\u4E9B\u503C\u5230\u81EA\u5DF1\u7684\u4F18\u5148\u961F\u5217\u4E2D\u6765\u4EA7\u751F\u4E00\u4E2A\u5168\u5C40\u6392\u5E8F\u540E\u7684\u7ED3\u679C\u5217\u8868\u3002</li><li>\u63A5\u4E0B\u6765\u5C31\u662F\u53D6\u56DE\u9636\u6BB5\uFF0C \u534F\u8C03\u8282\u70B9\u8FA8\u522B\u51FA\u54EA\u4E9B\u6587\u6863\u9700\u8981\u88AB\u53D6\u56DE\u5E76\u5411\u76F8\u5173\u7684\u5206\u7247\u63D0\u4EA4\u591A\u4E2A GET \u8BF7\u6C42\u3002\u6BCF\u4E2A\u5206\u7247\u52A0\u8F7D\u5E76\u4E30\u5BCC\u6587\u6863\uFF0C\u5982\u679C\u6709\u9700\u8981\u7684\u8BDD\uFF0C\u63A5\u7740\u8FD4\u56DE\u6587\u6863\u7ED9\u534F\u8C03\u8282\u70B9\u3002\u4E00\u65E6\u6240\u6709\u7684\u6587\u6863\u90FD\u88AB\u53D6\u56DE\u4E86\uFF0C\u534F\u8C03\u8282\u70B9\u8FD4\u56DE\u7ED3\u679C\u7ED9\u5BA2\u6237\u7AEF\u3002</li><li>Query Then Fetch \u7684\u641C\u7D22\u7C7B\u578B\u5728\u6587\u6863\u76F8\u5173\u6027\u6253\u5206\u7684\u65F6\u5019\u53C2\u8003\u7684\u662F\u672C\u5206\u7247\u7684\u6570\u636E\uFF0C\u8FD9\u6837\u5728\u6587\u6863\u6570\u91CF\u8F83\u5C11\u7684\u65F6\u5019\u53EF\u80FD\u4E0D\u591F\u51C6\u786E\uFF0C DFS Query Then Fetch \u589E\u52A0\u4E86\u4E00\u4E2A\u9884\u67E5\u8BE2\u7684\u5904\u7406\uFF0C\u8BE2\u95EE Term \u548C Document frequency\uFF0C\u8FD9\u4E2A\u8BC4\u5206\u66F4\u51C6\u786E\uFF0C\u4F46\u662F\u6027\u80FD\u4F1A\u53D8\u5DEE\u3002</li></ul><h4 id="elasticsearch-\u5728\u90E8\u7F72\u65F6-\u5BF9-linux-\u7684\u8BBE\u7F6E\u6709\u54EA\u4E9B\u4F18\u5316\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u5728\u90E8\u7F72\u65F6-\u5BF9-linux-\u7684\u8BBE\u7F6E\u6709\u54EA\u4E9B\u4F18\u5316\u65B9\u6CD5" aria-hidden="true">#</a> Elasticsearch \u5728\u90E8\u7F72\u65F6\uFF0C\u5BF9 Linux \u7684\u8BBE\u7F6E\u6709\u54EA\u4E9B\u4F18\u5316\u65B9\u6CD5\uFF1F</h4><ul><li><p>64 GB \u5185\u5B58\u7684\u673A\u5668\u662F\u975E\u5E38\u7406\u60F3\u7684\uFF0C \u4F46\u662F 32 GB \u548C 16 GB \u673A\u5668\u4E5F\u662F\u5F88\u5E38\u89C1\u7684\u3002\u5C11\u4E8E 8 GB \u4F1A\u9002\u5F97\u5176\u53CD\u3002</p></li><li><p>\u5982\u679C\u4F60\u8981\u5728\u66F4\u5FEB\u7684 CPUs \u548C\u66F4\u591A\u7684\u6838\u5FC3\u4E4B\u95F4\u9009\u62E9\uFF0C\u9009\u62E9\u66F4\u591A\u7684\u6838\u5FC3\u66F4\u597D\u3002\u591A\u4E2A\u5185\u6838\u63D0\u4F9B\u7684\u989D\u5916\u5E76\u53D1\u8FDC\u80DC\u8FC7\u7A0D\u5FAE\u5FEB\u4E00\u70B9\u70B9\u7684\u65F6\u949F\u9891\u7387\u3002</p></li><li><p>\u5982\u679C\u4F60\u8D1F\u62C5\u5F97\u8D77 SSD\uFF0C\u5B83\u5C06\u8FDC\u8FDC\u8D85\u51FA\u4EFB\u4F55\u65CB\u8F6C\u4ECB\u8D28\u3002 \u57FA\u4E8E SSD \u7684\u8282\u70B9\uFF0C\u67E5\u8BE2\u548C\u7D22\u5F15\u6027\u80FD\u90FD\u6709\u63D0\u5347\u3002\u5982\u679C\u4F60\u8D1F\u62C5\u5F97\u8D77\uFF0C SSD \u662F\u4E00\u4E2A\u597D\u7684\u9009\u62E9\u3002</p></li><li><p>\u5373\u4F7F\u6570\u636E\u4E2D\u5FC3\u4EEC\u8FD1\u5728\u54AB\u5C3A\uFF0C\u4E5F\u8981\u907F\u514D\u96C6\u7FA4\u8DE8\u8D8A\u591A\u4E2A\u6570\u636E\u4E2D\u5FC3\u3002\u7EDD\u5BF9\u8981\u907F\u514D\u96C6\u7FA4\u8DE8\u8D8A\u5927\u7684\u5730\u7406\u8DDD\u79BB\u3002</p></li><li><p>\u8BF7\u786E\u4FDD\u8FD0\u884C\u4F60\u5E94\u7528\u7A0B\u5E8F\u7684 JVM \u548C\u670D\u52A1\u5668\u7684 JVM \u662F\u5B8C\u5168\u4E00\u6837\u7684\u3002 \u5728 Elasticsearch \u7684\u51E0\u4E2A\u5730\u65B9\uFF0C\u4F7F\u7528 Java \u7684\u672C\u5730\u5E8F\u5217\u5316\u3002</p></li><li><p>\u901A\u8FC7\u8BBE\u7F6E gateway.recover_after_nodes\u3001 gateway.expected_nodes\u3001 gateway.recover_after_time \u53EF\u4EE5\u5728\u96C6\u7FA4\u91CD\u542F\u7684\u65F6\u5019\u907F\u514D\u8FC7\u591A\u7684\u5206\u7247\u4EA4\u6362\uFF0C\u8FD9\u53EF\u80FD\u4F1A\u8BA9\u6570\u636E\u6062\u590D\u4ECE\u6570\u4E2A\u5C0F\u65F6\u7F29\u77ED\u4E3A\u51E0\u79D2\u949F\u3002</p></li><li><p>Elasticsearch \u9ED8\u8BA4\u88AB\u914D\u7F6E\u4E3A\u4F7F\u7528\u5355\u64AD\u53D1\u73B0\uFF0C\u4EE5\u9632\u6B62\u8282\u70B9\u65E0\u610F\u4E2D\u52A0\u5165\u96C6\u7FA4\u3002\u53EA\u6709\u5728\u540C\u4E00\u53F0\u673A\u5668\u4E0A\u8FD0\u884C\u7684\u8282\u70B9\u624D\u4F1A\u81EA\u52A8\u7EC4\u6210\u96C6\u7FA4\u3002\u6700\u597D\u4F7F\u7528\u5355\u64AD\u4EE3\u66FF\u7EC4\u64AD\u3002</p></li><li><p>\u4E0D\u8981\u968F\u610F\u4FEE\u6539\u5783\u573E\u56DE\u6536\u5668\uFF08CMS\uFF09\u548C\u5404\u4E2A\u7EBF\u7A0B\u6C60\u7684\u5927\u5C0F\u3002</p></li><li><p>\u628A\u4F60\u7684\u5185\u5B58\u7684\uFF08\u5C11\u4E8E\uFF09\u4E00\u534A\u7ED9 Lucene\uFF08\u4F46\u4E0D\u8981\u8D85\u8FC7 32 GB\uFF01\uFF09\uFF0C\u901A\u8FC7 ES_HEAP_SIZE \u73AF\u5883\u53D8\u91CF\u8BBE\u7F6E\u3002</p></li><li><p>\u5185\u5B58\u4EA4\u6362\u5230\u78C1\u76D8\u5BF9\u670D\u52A1\u5668\u6027\u80FD\u6765\u8BF4\u662F\u81F4\u547D\u7684\u3002\u5982\u679C\u5185\u5B58\u4EA4\u6362\u5230\u78C1\u76D8\u4E0A\uFF0C\u4E00\u4E2A 100 \u5FAE\u79D2\u7684\u64CD\u4F5C\u53EF\u80FD\u53D8\u6210 10 \u6BEB\u79D2\u3002 \u518D\u60F3\u60F3\u90A3\u4E48\u591A 10 \u5FAE\u79D2\u7684\u64CD\u4F5C\u65F6\u5EF6\u7D2F\u52A0\u8D77\u6765\u3002 \u4E0D\u96BE\u770B\u51FA swapping \u5BF9\u4E8E\u6027\u80FD\u662F\u591A\u4E48\u53EF\u6015\u3002</p></li><li><p>Lucene \u4F7F\u7528\u4E86\u5927\u91CF\u7684\u6587\u4EF6\u3002\u540C\u65F6\uFF0C Elasticsearch \u5728\u8282\u70B9\u548C HTTP \u5BA2\u6237\u7AEF\u4E4B\u95F4\u8FDB\u884C\u901A\u4FE1\u4E5F\u4F7F\u7528\u4E86\u5927\u91CF\u7684\u5957\u63A5\u5B57\u3002 \u6240\u6709\u8FD9\u4E00\u5207\u90FD\u9700\u8981\u8DB3\u591F\u7684\u6587\u4EF6\u63CF\u8FF0\u7B26\u3002\u4F60\u5E94\u8BE5\u589E\u52A0\u4F60\u7684\u6587\u4EF6\u63CF\u8FF0\u7B26\uFF0C\u8BBE\u7F6E\u4E00\u4E2A\u5F88\u5927\u7684\u503C\uFF0C\u5982 64,000\u3002</p></li></ul><h4 id="gc-\u65B9\u9762-\u5728\u4F7F\u7528-elasticsearch-\u65F6\u8981\u6CE8\u610F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#gc-\u65B9\u9762-\u5728\u4F7F\u7528-elasticsearch-\u65F6\u8981\u6CE8\u610F\u4EC0\u4E48" aria-hidden="true">#</a> GC \u65B9\u9762\uFF0C\u5728\u4F7F\u7528 Elasticsearch \u65F6\u8981\u6CE8\u610F\u4EC0\u4E48\uFF1F</h4><p>\u5012\u6392\u8BCD\u5178\u7684\u7D22\u5F15\u9700\u8981\u5E38\u9A7B\u5185\u5B58\uFF0C\u65E0\u6CD5 GC\uFF0C\u9700\u8981\u76D1\u63A7 data node \u4E0A segment memory \u589E\u957F\u8D8B\u52BF\u3002</p><p>\u5404\u7C7B\u7F13\u5B58\uFF0C field cache, filter cache, indexing cache, bulk queue \u7B49\u7B49\uFF0C\u8981\u8BBE\u7F6E\u5408\u7406\u7684\u5927\u5C0F\uFF0C\u5E76\u4E14\u8981\u5E94\u8BE5\u6839\u636E\u6700\u574F\u7684\u60C5\u51B5\u6765\u770B heap \u662F\u5426\u591F\u7528\uFF0C\u4E5F\u5C31\u662F\u5404\u7C7B\u7F13\u5B58\u5168\u90E8\u5360\u6EE1\u7684\u65F6\u5019\uFF0C\u8FD8\u6709 heap \u7A7A\u95F4\u53EF\u4EE5\u5206\u914D\u7ED9\u5176\u4ED6\u4EFB\u52A1\u5417\uFF1F\u907F\u514D\u91C7\u7528 clear cache \u7B49\u201C\u81EA\u6B3A\u6B3A\u4EBA\u201D\u7684\u65B9\u5F0F\u6765\u91CA\u653E\u5185\u5B58\u3002</p><p>\u907F\u514D\u8FD4\u56DE\u5927\u91CF\u7ED3\u679C\u96C6\u7684\u641C\u7D22\u4E0E\u805A\u5408\u3002\u786E\u5B9E\u9700\u8981\u5927\u91CF\u62C9\u53D6\u6570\u636E\u7684\u573A\u666F\uFF0C\u53EF\u4EE5\u91C7\u7528 scan &amp; scroll api \u6765\u5B9E\u73B0\u3002</p><p>cluster stats \u9A7B\u7559\u5185\u5B58\u5E76\u65E0\u6CD5\u6C34\u5E73\u6269\u5C55\uFF0C\u8D85\u5927\u89C4\u6A21\u96C6\u7FA4\u53EF\u4EE5\u8003\u8651\u5206\u62C6\u6210\u591A\u4E2A\u96C6\u7FA4\u901A\u8FC7 tribe node \u8FDE\u63A5\u3002</p><p>\u60F3\u77E5\u9053 heap \u591F\u4E0D\u591F\uFF0C\u5FC5\u987B\u7ED3\u5408\u5B9E\u9645\u5E94\u7528\u573A\u666F\uFF0C\u5E76\u5BF9\u96C6\u7FA4\u7684 heap \u4F7F\u7528\u60C5\u51B5\u505A\u6301\u7EED\u7684\u76D1\u63A7\u3002</p><h4 id="elasticsearch-\u5BF9\u4E8E\u5927\u6570\u636E\u91CF-\u4E0A\u4EBF\u91CF\u7EA7-\u7684\u805A\u5408\u5982\u4F55\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u5BF9\u4E8E\u5927\u6570\u636E\u91CF-\u4E0A\u4EBF\u91CF\u7EA7-\u7684\u805A\u5408\u5982\u4F55\u5B9E\u73B0" aria-hidden="true">#</a> Elasticsearch \u5BF9\u4E8E\u5927\u6570\u636E\u91CF\uFF08\u4E0A\u4EBF\u91CF\u7EA7\uFF09\u7684\u805A\u5408\u5982\u4F55\u5B9E\u73B0\uFF1F</h4><p>Elasticsearch \u63D0\u4F9B\u7684\u9996\u4E2A\u8FD1\u4F3C\u805A\u5408\u662F cardinality \u5EA6\u91CF\u3002\u5B83\u63D0\u4F9B\u4E00\u4E2A\u5B57\u6BB5\u7684\u57FA\u6570\uFF0C\u5373\u8BE5\u5B57\u6BB5\u7684 distinct\u6216\u8005 unique \u503C\u7684\u6570\u76EE\u3002\u5B83\u662F\u57FA\u4E8E HLL \u7B97\u6CD5\u7684\u3002 HLL \u4F1A\u5148\u5BF9\u6211\u4EEC\u7684\u8F93\u5165\u4F5C\u54C8\u5E0C\u8FD0\u7B97\uFF0C\u7136\u540E\u6839\u636E\u54C8\u5E0C\u8FD0\u7B97\u7684\u7ED3\u679C\u4E2D\u7684 bits \u505A\u6982\u7387\u4F30\u7B97\u4ECE\u800C\u5F97\u5230\u57FA\u6570\u3002\u5176\u7279\u70B9\u662F\uFF1A\u53EF\u914D\u7F6E\u7684\u7CBE\u5EA6\uFF0C\u7528\u6765\u63A7\u5236\u5185\u5B58\u7684\u4F7F\u7528\uFF08\u66F4\u7CBE\u786E \uFF1D \u66F4\u591A\u5185\u5B58\uFF09\uFF1B\u5C0F\u7684\u6570\u636E\u96C6\u7CBE\u5EA6\u662F\u975E\u5E38\u9AD8\u7684\uFF1B\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6E\u53C2\u6570\uFF0C\u6765\u8BBE\u7F6E\u53BB\u91CD\u9700\u8981\u7684\u56FA\u5B9A\u5185\u5B58\u4F7F\u7528\u91CF\u3002\u65E0\u8BBA\u6570\u5343\u8FD8\u662F\u6570\u5341\u4EBF\u7684\u552F\u4E00\u503C\uFF0C\u5185\u5B58\u4F7F\u7528\u91CF\u53EA\u4E0E\u4F60\u914D\u7F6E\u7684\u7CBE\u786E\u5EA6\u76F8\u5173\u3002</p><h4 id="\u5728\u5E76\u53D1\u60C5\u51B5\u4E0B-elasticsearch-\u5982\u679C\u4FDD\u8BC1\u8BFB\u5199\u4E00\u81F4" tabindex="-1"><a class="header-anchor" href="#\u5728\u5E76\u53D1\u60C5\u51B5\u4E0B-elasticsearch-\u5982\u679C\u4FDD\u8BC1\u8BFB\u5199\u4E00\u81F4" aria-hidden="true">#</a> \u5728\u5E76\u53D1\u60C5\u51B5\u4E0B\uFF0C Elasticsearch \u5982\u679C\u4FDD\u8BC1\u8BFB\u5199\u4E00\u81F4\uFF1F</h4><ul><li><p>\u53EF\u4EE5\u901A\u8FC7\u7248\u672C\u53F7\u4F7F\u7528\u4E50\u89C2\u5E76\u53D1\u63A7\u5236\uFF0C\u4EE5\u786E\u4FDD\u65B0\u7248\u672C\u4E0D\u4F1A\u88AB\u65E7\u7248\u672C\u8986\u76D6\uFF0C\u7531\u5E94\u7528\u5C42\u6765\u5904\u7406\u5177\u4F53\u7684\u51B2\u7A81\uFF1B</p></li><li><p>\u53E6\u5916\u5BF9\u4E8E\u5199\u64CD\u4F5C\uFF0C\u4E00\u81F4\u6027\u7EA7\u522B\u652F\u6301 quorum/one/all\uFF0C\u9ED8\u8BA4\u4E3A quorum\uFF0C\u5373\u53EA\u6709\u5F53\u5927\u591A\u6570\u5206\u7247\u53EF\u7528\u65F6\u624D\u5141\u8BB8\u5199\u64CD\u4F5C\u3002\u4F46\u5373\u4F7F\u5927\u591A\u6570\u53EF\u7528\uFF0C\u4E5F\u53EF\u80FD\u5B58\u5728\u56E0\u4E3A\u7F51\u7EDC\u7B49\u539F\u56E0\u5BFC\u81F4\u5199\u5165\u526F\u672C\u5931\u8D25\uFF0C\u8FD9\u6837\u8BE5\u526F\u672C\u88AB\u8BA4\u4E3A\u6545\u969C\uFF0C\u5206\u7247\u5C06\u4F1A\u5728\u4E00\u4E2A\u4E0D\u540C\u7684\u8282\u70B9\u4E0A\u91CD\u5EFA\u3002</p></li><li><p>\u5BF9\u4E8E\u8BFB\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u8BBE\u7F6E replication \u4E3A sync(\u9ED8\u8BA4)\uFF0C\u8FD9\u4F7F\u5F97\u64CD\u4F5C\u5728\u4E3B\u5206\u7247\u548C\u526F\u672C\u5206\u7247\u90FD\u5B8C\u6210\u540E\u624D\u4F1A\u8FD4\u56DE\uFF1B\u5982\u679C\u8BBE\u7F6E replication \u4E3A async \u65F6\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E\u641C\u7D22\u8BF7\u6C42\u53C2\u6570_preference \u4E3A primary \u6765\u67E5\u8BE2\u4E3B\u5206\u7247\uFF0C\u786E\u4FDD\u6587\u6863\u662F\u6700\u65B0\u7248\u672C\u3002</p></li></ul><h4 id="\u5982\u4F55\u76D1\u63A7-elasticsearch-\u96C6\u7FA4\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u76D1\u63A7-elasticsearch-\u96C6\u7FA4\u72B6\u6001" aria-hidden="true">#</a> \u5982\u4F55\u76D1\u63A7 Elasticsearch \u96C6\u7FA4\u72B6\u6001\uFF1F</h4><ol><li>elasticsearch-head \u63D2\u4EF6\u3002</li><li>\u901A\u8FC7 Kibana \u76D1\u63A7 Elasticsearch\u3002\u4F60\u53EF\u4EE5\u5B9E\u65F6\u67E5\u770B\u4F60\u7684\u96C6\u7FA4\u5065\u5EB7\u72B6\u6001\u548C\u6027\u80FD\uFF0C\u4E5F\u53EF\u4EE5\u5206\u6790\u8FC7\u53BB\u7684\u96C6\u7FA4\u3001\u7D22\u5F15\u548C\u8282\u70B9\u6307\u6807</li></ol><h4 id="\u662F\u5426\u4E86\u89E3\u5B57\u5178\u6811" tabindex="-1"><a class="header-anchor" href="#\u662F\u5426\u4E86\u89E3\u5B57\u5178\u6811" aria-hidden="true">#</a> \u662F\u5426\u4E86\u89E3\u5B57\u5178\u6811\uFF1F</h4><p>\u5B57\u5178\u6811\u53C8\u79F0\u5355\u8BCD\u67E5\u627E\u6811\uFF0C Trie \u6811\uFF0C\u662F\u4E00\u79CD\u6811\u5F62\u7ED3\u6784\uFF0C\u662F\u4E00\u79CD\u54C8\u5E0C\u6811\u7684\u53D8\u79CD\u3002\u5178\u578B\u5E94\u7528\u662F\u7528\u4E8E\u7EDF\u8BA1\uFF0C\u6392\u5E8F\u548C\u4FDD\u5B58\u5927\u91CF\u7684\u5B57\u7B26\u4E32\uFF08\u4F46\u4E0D\u4EC5\u9650\u4E8E\u5B57\u7B26\u4E32\uFF09\uFF0C\u6240\u4EE5\u7ECF\u5E38\u88AB\u641C\u7D22\u5F15\u64CE\u7CFB\u7EDF\u7528\u4E8E\u6587\u672C\u8BCD\u9891\u7EDF\u8BA1\u3002\u5B83\u7684\u4F18\u70B9\u662F\uFF1A\u5229\u7528\u5B57\u7B26\u4E32\u7684\u516C\u5171\u524D\u7F00\u6765\u51CF\u5C11\u67E5\u8BE2\u65F6\u95F4\uFF0C\u6700\u5927\u9650\u5EA6\u5730\u51CF\u5C11\u65E0\u8C13\u7684\u5B57\u7B26\u4E32\u6BD4\u8F83\uFF0C\u67E5\u8BE2\u6548\u7387\u6BD4\u54C8\u5E0C\u6811\u9AD8\u3002</p><p>Trie \u7684\u6838\u5FC3\u601D\u60F3\u662F\u7A7A\u95F4\u6362\u65F6\u95F4\uFF0C\u5229\u7528\u5B57\u7B26\u4E32\u7684\u516C\u5171\u524D\u7F00\u6765\u964D\u4F4E\u67E5\u8BE2\u65F6\u95F4\u7684\u5F00\u9500\u4EE5\u8FBE\u5230\u63D0\u9AD8\u6548\u7387\u7684\u76EE\u7684\u3002\u5B83\u6709 3 \u4E2A\u57FA\u672C\u6027\u8D28\uFF1A</p><ul><li>\u6839\u8282\u70B9\u4E0D\u5305\u542B\u5B57\u7B26\uFF0C\u9664\u6839\u8282\u70B9\u5916\u6BCF\u4E00\u4E2A\u8282\u70B9\u90FD\u53EA\u5305\u542B\u4E00\u4E2A\u5B57\u7B26\u3002</li><li>\u4ECE\u6839\u8282\u70B9\u5230\u67D0\u4E00\u8282\u70B9\uFF0C\u8DEF\u5F84\u4E0A\u7ECF\u8FC7\u7684\u5B57\u7B26\u8FDE\u63A5\u8D77\u6765\uFF0C\u4E3A\u8BE5\u8282\u70B9\u5BF9\u5E94\u7684\u5B57\u7B26\u4E32\u3002</li><li>\u6BCF\u4E2A\u8282\u70B9\u7684\u6240\u6709\u5B50\u8282\u70B9\u5305\u542B\u7684\u5B57\u7B26\u90FD\u4E0D\u76F8\u540C\u3002</li></ul><p>\u5BF9\u4E8E\u4E2D\u6587\u7684\u5B57\u5178\u6811\uFF0C\u6BCF\u4E2A\u8282\u70B9\u7684\u5B50\u8282\u70B9\u7528\u4E00\u4E2A\u54C8\u5E0C\u8868\u5B58\u50A8\uFF0C\u8FD9\u6837\u5C31\u4E0D\u7528\u6D6A\u8D39\u592A\u5927\u7684\u7A7A\u95F4\uFF0C\u800C\u4E14\u67E5\u8BE2\u901F\u5EA6\u4E0A\u53EF\u4EE5\u4FDD\u7559\u54C8\u5E0C\u7684\u590D\u6742\u5EA6 O(1)\u3002</p><h4 id="elasticsearch-\u4E2D\u7684\u96C6\u7FA4\u3001\u8282\u70B9\u3001\u7D22\u5F15\u3001\u6587\u6863\u3001\u7C7B\u578B\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u4E2D\u7684\u96C6\u7FA4\u3001\u8282\u70B9\u3001\u7D22\u5F15\u3001\u6587\u6863\u3001\u7C7B\u578B\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Elasticsearch \u4E2D\u7684\u96C6\u7FA4\u3001\u8282\u70B9\u3001\u7D22\u5F15\u3001\u6587\u6863\u3001\u7C7B\u578B\u662F\u4EC0\u4E48\uFF1F</h4><ul><li>\u96C6\u7FA4\u662F\u4E00\u4E2A\u6216\u591A\u4E2A\u8282\u70B9\uFF08\u670D\u52A1\u5668\uFF09\u7684\u96C6\u5408\uFF0C\u5B83\u4EEC\u5171\u540C\u4FDD\u5B58\u60A8\u7684\u6574\u4E2A\u6570\u636E\uFF0C\u5E76\u63D0\u4F9B\u8DE8\u6240\u6709\u8282\u70B9\u7684\u8054\u5408\u7D22\u5F15\u548C\u641C\u7D22\u529F\u80FD\u3002\u7FA4\u96C6\u7531\u552F\u4E00\u540D \u79F0\u6807\u8BC6\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u4E3A&quot;elasticsearch&quot;\u3002\u6B64\u540D\u79F0\u5F88\u91CD\u8981\uFF0C\u56E0\u4E3A\u5982\u679C\u8282\u70B9\u8BBE\u7F6E\u4E3A\u6309\u540D\u79F0\u52A0\u5165\u7FA4\u96C6\uFF0C\u5219\u8BE5\u8282\u70B9\u53EA\u80FD\u662F\u7FA4\u96C6\u7684\u4E00\u90E8\u5206\u3002</li><li>\u8282\u70B9\u662F\u5C5E\u4E8E\u96C6\u7FA4\u4E00\u90E8\u5206\u7684\u5355\u4E2A\u670D\u52A1\u5668\u3002\u5B83\u5B58\u50A8\u6570\u636E\u5E76\u53C2\u4E0E\u7FA4\u96C6\u7D22\u5F15\u548C\u641C\u7D22\u529F\u80FD\u3002</li><li>\u7D22\u5F15\u5C31\u50CF\u5173\u7CFB\u6570\u636E\u5E93\u4E2D\u7684\u201C\u6570\u636E\u5E93\u201D\u3002\u5B83\u6709\u4E00\u4E2A\u5B9A\u4E49\u591A\u79CD\u7C7B\u578B\u7684\u6620\u5C04\u3002\u7D22\u5F15\u662F\u903B\u8F91\u540D\u79F0\u7A7A\u95F4\uFF0C\u6620\u5C04\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u4E3B\u5206\u7247\uFF0C\u5E76\u4E14\u53EF\u4EE5\u6709\u96F6\u4E2A\u6216\u591A\u4E2A\u526F\u672C\u5206\u7247\u3002MySQL =&gt;\u6570\u636E\u5E93\uFF0CElasticsearch=&gt;\u7D22\u5F15\u3002</li><li>\u6587\u6863\u7C7B\u4F3C\u4E8E\u5173\u7CFB\u6570\u636E\u5E93\u4E2D\u7684\u4E00\u884C\u3002\u4E0D\u540C\u4E4B\u5904\u5728\u4E8E\u7D22\u5F15\u4E2D\u7684\u6BCF\u4E2A\u6587\u6863\u53EF\u4EE5\u5177\u6709\u4E0D\u540C\u7684\u7ED3\u6784(\u5B57\u6BB5)\uFF0C\u4F46\u662F\u5BF9\u4E8E\u901A\u7528\u5B57\u6BB5\u5E94\u8BE5\u5177\u6709\u76F8\u540C\u7684\u6570\u636E\u7C7B\u578B\u3002MySQL =&gt; Databases =&gt; Tables =&gt; Columns / Rows\uFF0CElasticsearch=&gt; Indices =&gt; Types =&gt;\u5177\u6709\u5C5E\u6027\u7684\u6587\u6863Doc\u3002</li><li>\u7C7B\u578B\u662F\u7D22\u5F15\u7684\u903B\u8F91\u7C7B\u522B/\u5206\u533A\uFF0C\u5176\u8BED\u4E49\u5B8C\u5168\u53D6\u51B3\u4E8E\u7528\u6237\u3002</li></ul><h4 id="elasticsearch-\u4E2D\u7684\u5012\u6392\u7D22\u5F15\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#elasticsearch-\u4E2D\u7684\u5012\u6392\u7D22\u5F15\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Elasticsearch \u4E2D\u7684\u5012\u6392\u7D22\u5F15\u662F\u4EC0\u4E48\uFF1F</h4><p>\u5012\u6392\u7D22\u5F15\u662F\u641C\u7D22\u5F15\u64CE\u7684\u6838\u5FC3\u3002\u641C\u7D22\u5F15\u64CE\u7684\u4E3B\u8981\u76EE\u6807\u662F\u5728\u67E5\u627E\u53D1\u751F\u641C\u7D22\u6761\u4EF6\u7684\u6587\u6863\u65F6\u63D0\u4F9B\u5FEB\u901F\u641C\u7D22\u3002ES\u4E2D\u7684\u5012\u6392\u7D22\u5F15\u5176\u5B9E\u5C31\u662F lucene \u7684\u5012\u6392\u7D22\u5F15\uFF0C\u533A\u522B\u4E8E\u4F20\u7EDF\u7684\u6B63\u5411\u7D22\u5F15\uFF0C \u5012\u6392\u7D22\u5F15\u4F1A\u518D\u5B58\u50A8\u6570\u636E\u65F6\u5C06\u5173\u952E\u8BCD\u548C\u6570\u636E\u8FDB\u884C\u5173\u8054\uFF0C\u4FDD\u5B58\u5230\u5012\u6392\u8868\u4E2D\uFF0C\u7136\u540E\u67E5\u8BE2\u65F6\uFF0C\u5C06\u67E5\u8BE2\u5185\u5BB9\u8FDB\u884C\u5206\u8BCD\u540E\u5728\u5012\u6392\u8868\u4E2D\u8FDB\u884C\u67E5\u8BE2\uFF0C\u6700\u540E\u5339\u914D\u6570\u636E\u5373\u53EF\u3002</p>`,145);function G(U,F){const a=l("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[n("a",r,[k,t(a)])]),n("p",null,[n("a",d,[v,t(a)])]),n("p",null,[n("a",m,[b,t(a)])]),q,n("p",null,[n("a",g,[h,t(a)])]),y,n("p",null,[n("a",f,[_,t(a)])]),x,n("p",null,[n("a",w,[S,t(a)])]),j,n("p",null,[n("a",E,[R,t(a)]),B]),T,n("p",null,[n("a",I,[H,t(a)])]),P,n("p",null,[n("a",C,[A,t(a)])]),D,n("p",null,[n("a",N,[O,t(a)])]),M,n("p",null,[n("a",L,[Q,t(a)])]),z])}var V=e(i,[["render",G],["__file","Elasticsearch\u5B66\u4E60.html.vue"]]);export{V as default};
